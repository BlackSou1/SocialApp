(this["webpackJsonpreact-project"]=this["webpackJsonpreact-project"]||[]).push([[0],[,,,,,,,,,,function(e,t,n){e.exports={toggle:"s9gxa",sidebar_title:"bJOUh",posts_header:"MgfW8",description_title:"y7RHG",sidebar_content:"Eutlg",description:"Gb+RP",header:"rcVUA",container:"b6Nl6",info_subscribers:"Km81x",banner_overlay:"k0Khq",info_title_text:"mV7+V",banner_placeholder:"IXu0v",info_content:"_4YFnX",contacts:"-6pHz",header_buttons:"_7oshF",header_button:"tRIF+",banner:"FCh+x",banner_button:"_1dohC",banner_img:"r9UeB",banner_overlay_icon:"_0KSWI",info:"F4jsx",info_text:"R1ugc",info_title:"rOJ73",info_title_form:"srO4h",info_subscribe:"nb8IJ",info_footerButtons:"Na-O1",info_footerButton:"aoTwM",description_wrapper:"RLqPn",description_wrapper_text:"_7qMIP",description_short:"oUXaH",description_short_title:"MtnNk",posts:"yaMvg",posts_title:"n8Ush",sidebar:"RxdxI",sidebar_buttons:"k+Y7-",sidebar_button:"_6E1xI",info_buttons:"kc-9I"}},,,,,,function(e,t,n){e.exports={notifications_menu_wrapper:"eloVl",user_menu_wrapper:"_85gPx",header:"NXzL8",header_visible:"D19C5",wrapper:"_7R1Vb",logo:"_7bOtT",right:"ZNT+4",searchBar:"_6lY9N",notifications:"NG2xi",user:"c7q2f",notifications_menu:"KOli8",user_menu:"T99Jq",user_button:"-3m-x",user_button_name:"T-lmu",user_menu_button:"a+0lr",changeTheme:"_8YZBL",notifications_button:"Rg669",notifications_button_number:"iVQjb",notifications_button_wrapper:"ud9gz",notifications_menu_clear:"QK2Ir",notifications_menu_empty:"yDOoA"}},function(e,t,n){e.exports={container:"BEXqQ",origin_deleted:"UCTte",footer_button:"hR+sU",footer_item:"SxBF6",main:"zxXV2",origin:"QKUrs",origin_content:"lh4Mu",footer:"+HBcE",footer_buttons:"ZWXlg",footer_item_icon:"ifqGH",footer_item_text:"j37qB"}},,function(e,t,n){e.exports={preview_header_name:"vDjhQ",preview_wrapper:"wJp8r",img_small:"_6dZ2E",img_medium:"mRdYU",link:"_7vlfO",container:"z7TNN",container_previewLoaded:"c1tlT",preview:"_41DIX",preview_header:"gHV8M",preview_middle:"WdYAR",preview_middle_onlineStatus:"RZcAk",preview_middle_subscribers:"uPgs7",preview_middle_description:"_8y03l",preview_middle_location:"_0dEXY",preview_footer:"TCTC0",preview_footer_item:"Wx83m",preview_footer_item_title:"PEQxP",preview_footer_item_number:"-NM9K",preview_footer_button:"wlS9U"}},,function(e,t,n){e.exports={replyTo_name:"KPqgy",footer_deleteButton:"fXyt1",footer_button:"Fxqm3",container:"_2sShU",wrapper:"mp7v1",wrapper_selected:"cxyCh",replyTo:"e92zk",footer:"REH6Q",footer_button_icon:"nNdKZ",footer_button_text:"O51hG",replies:"HFC3t"}},function(e,t,n){e.exports={container:"uCHlz",form:"O212y","error-text":"_5FuhD",header:"rhLRL",input:"oo9+g",input_disabled:"Iz05B",mobileSubmit:"ARDcB",mobileSubmit_loading:"TpmXI",mobileSubmit_loading_animation:"dkFjB",footer:"CMW+h",footer_inputs:"EoDgB",photo_button:"MRCdD","photo_button--disabled":"Eoyry",photo_button_disabled:"mH4yR",button:"i1C1b",uploadPreviews:"VvNoV",uploadPreviews_wrapper:"ugoJ0"}},function(e,t,n){e.exports={container:"sWim0",link:"MYsjU",link_icon:"jcnmp",link_text:"G4H01"}},function(e,t,n){e.exports={header_imgContainer:"EQBrk",container:"PjBTb",header:"R150P",header_remove:"ANnNR",header_img:"AZf+g",header_overlay:"Czumg",header_overlay_loading:"LQM-h",header_overlay_text:"QXEQl",footer:"_63swE",footer_wrapper:"A3K8M",footer_item:"a3rRN",title:"KiM8e",checkbox:"vLjh9",checkbox_input:"_9hq0R",checkbox_text:"Eh2H4"}},function(e,t,n){e.exports={posts_header:"zRvLk",photos:"O6n8B",info:"sbTO1",photos_imgContainer:"wLJ6Y",wrapper:"hrb01",content:"RrEWG",info_header:"UlI2D",info_header_wrapper:"uyOXC",actionsMenu:"TKW6O",info_header_name:"sx83x",photos_title:"mjC7M",photos_wrapper:"SCuBi",photos_imgInnerContainer:"le3NJ",photos_img:"_9l0ru",posts_title:"NRNx3",posts:"_86zHj"}},,function(e,t,n){e.exports={text_showMore:"YZ3YB",text:"ZVDcO",imgContainer:"_2y-D1",container:"_4X+Cr",item:"_5w1wS",textContainer:"xBzLo",text_link:"Hw8fQ",img:"zm5e0",lazy:"hAz50",deletedPhoto:"-TnkJ"}},function(e,t,n){e.exports={wrapper:"zIuRM",header:"Bva8M",title:"Njjdf",container:"Pt9r1",formTitle:"_3tQJA",buttons:"t+yHq",submit:"YCUGC",delete:"Zh497"}},function(e,t,n){e.exports={footer:"QMvjN",header:"kKOH3",footer_wrapper:"nZ+ft",header_overlay:"CSNBd",header_wrapper:"UQqwD",wrapper:"iJuIY",header_interlocutor:"eW0uD",container:"Yavw+",header_overlay_qty:"_89Unv",header_overlay_qty_icon:"OPAvI",header_overlay_buttons:"C5QNb",header_overlay_button:"z4Ebl",content:"BJIdP"}},,,,,,function(e,t,n){e.exports={title:"pzUmb",item:"++eB6",header:"t7k97",item_header:"axgjN",item_title:"xEVtS",button:"HNrLM"}},function(e,t,n){e.exports={content:"mLGVb",container:"t4iig",contentWidth:"oAvyf",wrapper:"XjH0U",info:"P2wJE",info_title:"-cWno",info_text:"_8cSh7",content_forgot:"pcODT",content_hr:"ga2Xt",content_signup:"gdNWK"}},,,function(e,t,n){e.exports={friends:"WlWwN",container:"pp1x9",onlineStatus:"eGihB",buttons:"TsJHR",friends_header:"VKKU6",friends_title:"ht7ar",friends_items:"M7pW1"}},,function(e,t,n){e.exports={button:"_6Ky74",text:"_9dwZx",form_button_primary:"DDnzc",form_button:"hWyI3",icon:"mPaU2",form_buttons:"PDooh"}},function(e,t,n){e.exports={input:"sqNFt",container:"MtmJg",label:"_28gJW",input_password:"NU7-G",password:"tHavk",password_show:"VVqKx"}},,,function(e,t,n){e.exports={container:"fphCP",title:"ikcUq",items:"esQKW",item:"sITBk",input:"JOmFa",text:"qDihD"}},function(e,t,n){e.exports={container:"Dfs75",container_open:"jelgF",wrapper:"_4+LHt",wrapper_open:"bYDRd",link:"He94R",link_icon:"nZXNA"}},function(e,t,n){e.exports={innerWrapper:"_3FqdH",pageWidth:"oLzQT",wrapper:"SiTpB",wrapper_open:"F7MRC",icon:"v6BQ9",text:"_2D0S0"}},function(e,t,n){e.exports={item:"T7F2f",noMessages:"kiEdj",lastMessage_content:"GzL0I",lastMessage_avatar:"_8Vdn1",lastMessage:"zeife",lastMessage_unread:"v-MHy"}},,,function(e,t,n){e.exports={container:"PjtF4",container_checked:"D3Hw8",wrapper:"T3yF9",iconContainer:"Hx9c0",input:"CbWmQ"}},function(e,t,n){e.exports={container:"_8+9-y",container_open:"MUaVu",content:"hUDjC",wrapper:"UPFvQ",close:"i+36H"}},function(e,t,n){e.exports={button_hidden:"+HKve",button:"x8+CY",pageWidth:"_3nHVV",container:"MYCOf"}},function(e,t,n){e.exports={header:"JzPlV",container:"_4R-L7",header_unavailable:"Meg+K",header_title:"R9Gjw",header_unavailable_remove:"tbvCX"}},function(e,t,n){e.exports={container:"qRYt3",item:"wkr+u",item_title:"cUCyj",item_number:"_7BFOO",button:"wF9Iz"}},function(e,t,n){e.exports={wrapper:"SVXBO",noResults:"qRAgh",header:"DRZJ9",title:"kHviP",searchBar:"_9K1tT"}},,function(e,t,n){e.exports={button_remove:"yn5Xi",button_secondary:"FLpc+",button_primary:"t3eTK",button:"sRE36",button_loading:"YsMh7",loading:"MWdn7"}},function(e,t,n){e.exports={container:"e703N",text:"I21ib",link:"z4HnV",remove:"fwSz+"}},function(e,t,n){e.exports={wrapper:"_0GKre",link:"b7eCA",link_icon:"vNGKn",container:"MAjnn"}},function(e,t,n){e.exports={innerContainer:"O8-k0",container:"G3BBa",title:"_3wvNQ",wrapper:"HnKRa"}},function(e,t,n){e.exports={container:"uzJLC",wrapper:"jOVaD",header:"CtSGq",bottom:"TlsjE"}},function(e,t,n){e.exports={wrapper:"fHtFX",number:"EJ1yj",title:"rDxLb",text:"JYSd2"}},function(e,t,n){e.exports={container:"V3l+s",container_selected:"_3xuCH",wrapper:"F5o0h",status:"W6f91"}},function(e,t,n){e.exports={container:"_3r669",item:"Na1Xn",item_title:"_9aGCr"}},function(e,t,n){e.exports={main:"_2WXj-",pageWidth:"KKVsj",loading:"lAhJy"}},function(e,t,n){e.exports={container:"Givm4",wrapper:"jtipD",icon:"kBazJ"}},function(e,t,n){e.exports={name:"luLW1",container:"ES1Ja",text:"_6c+mO"}},function(e,t,n){e.exports={button:"oQ-n5",img:"_7cS62"}},function(e,t,n){e.exports={item_description:"g5k8p",item:"S5UKu",container:"Qgp1+"}},function(e,t,n){e.exports={input:"ruc5G",form:"_6zzhg",button:"gaWHp"}},function(e,t,n){e.exports={wrapper:"tXikJ",button:"_4aema",button_active:"poKyI"}},function(e,t,n){e.exports={item:"HcyhW",button:"DUGJ-"}},function(e,t,n){e.exports={header:"Sb2Ng",container:"RDrTt",title:"_6DROY"}},,,,,,function(e,t,n){e.exports={container:"Q5q+g",container_open:"Mxx-Y"}},function(e,t,n){e.exports={name:"nfnhs",container:"JkCes"}},,,,,,,,function(e,t,n){e.exports={container:"mM9nZ"}},function(e,t,n){e.exports={form:"Wpd+3"}},function(e,t,n){e.exports={container:"tn98w"}},function(e,t,n){e.exports={container:"V4UwF"}},function(e,t,n){e.exports={container:"EmVN+"}},,function(e,t,n){e.exports={container:"+0+21"}},function(e,t,n){e.exports={noContent:"RQKOt"}},function(e,t,n){e.exports={container:"rTEoE"}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){},function(e,t,n){"use strict";n.r(t);var s=n(2),a=n(37),o=n(0),r=n(6),i=n(8),c=n(18),l=(n(113),n(66)),d=n.n(l),u=n(5),m=n(4),b=n(32);const j=Object(b.b)({initialState:null,name:"toast",reducers:{closeToast:()=>null,openToast:(e,t)=>{let{payload:n}=t;return{icon:n.icon,msg:n.msg}}}}),{closeToast:h,openToast:f}=j.actions,v=(e,t)=>f({icon:t,msg:e});var p=j.reducer,O=n(38),x=n(13);function g(e,t){let n=0;[...e].forEach((e=>n+=e.charCodeAt(0)));const s=s=>(n+e.length+parseInt(t.toString(),36)%(s+1)**2)%26+(2===s?0:10),a=e=>e.toString(36),o=s(1),r=s(2),i=s(3),c=s(4);let l="";return[...e].forEach(((e,t)=>{l+=String.fromCharCode(e.charCodeAt(0)+o+r+i+c-Math.min(t%60,t%65,t%70))})),l=btoa(l),l[0]+a(o)+a(r)+a(i)+l.slice(1,-2)+a(c)+l.slice(-2)}function _(e){const t=parseInt(e[1],36),n=parseInt(e[2],36),s=parseInt(e[3],36),a=parseInt(e[e.length-3],36),o=e[0]+e.slice(4,-3)+e.slice(-2);let r="";return[...atob(o)].forEach(((e,o)=>{r+=String.fromCharCode(e.charCodeAt(0)-t-n-s-a+Math.min(o%60,o%65,o%70))})),r}var y=n(87),N=n(49);Object(y.a)({apiKey:_("mpipaDQtqfMlLqnhbeCgLaZk5aos7aSibO5j3WYf3Nzr4x/gJiHpXkh/"),authDomain:"social-app-bs.firebaseapp.com",databaseURL:_("slelLu6tbd9cXCzrqGmnadnmqinY5enYJaWlpCjmaBYnJ2MiVSKmZWRkYVMlYKPj0tHfoCIenZ0hXZ0cIJuqqi5qnKpt7gY="),projectId:"social-app-bs",storageBucket:"social-app-bs.appspot.com",messagingSenderId:"129896299882",appId:"1:129896299882:web:7bf515fc32dcf9a735f913"});const w=Object(x.b)(),k=Object(N.c)(),I=Object(x.n)(),C={delete:e=>Object(N.a)(Object(N.d)(k,e)),getDownloadURL:e=>Object(N.b)(e),upload:(e,t,n)=>Object(N.e)(Object(N.d)(k,e),t,n)};var S=n(88);let $;function E(){const e=window.innerWidth-document.body.offsetWidth+"px";$=document.querySelectorAll(".fixed-item"),document.body.style.overflow="hidden",document.body.style.marginRight=e,$.forEach((t=>t.style.paddingRight=e))}function T(){var e;document.body.style.overflow="",document.body.style.marginRight="",null===(e=$)||void 0===e||e.forEach((e=>e.style.paddingRight=""))}const P=Object(b.b)({initialState:{activeModals:[],currentModal:null,gallery:null},name:"modal",reducers:{closeAllModals(e){T(),e.activeModals=[],e.currentModal=null},closeModal(e,t){let{payload:n}=t;e.activeModals.includes(n)&&(e.activeModals.splice(e.activeModals.indexOf(n)),e.currentModal=e.activeModals[e.activeModals.length-1])},openModal(e,t){var n;let{payload:s}=t;E(),e.activeModals.push(s.name),e.currentModal=s.name,e.actionConfirm=s.opts.actionConfirm,e.actionError=s.opts.actionError,e.changeAvatarCommunityId=s.opts.changeAvatarCommunityId,s.opts.gallery&&(e.gallery=s.opts.gallery),(null===(n=s.opts.zoom)||void 0===n?void 0:n.img)&&(e.zoom={alt:s.opts.zoom.alt||"",img:s.opts.zoom.img})}}}),{closeAllModals:L,closeModal:R,openModal:M}=P.actions,D=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return M({name:e,opts:t})};var q=P.reducer;function A(e,t){const n=new Date(e),s=Date.now()+xe.getState().timeOffset,a=new Date(s),o=(s-e)/1e3,r=o/60,i=r/60,c=n;return o<1?"just now":r<1?`${W("second",Math.floor(o))} ago`:i<1?`${W("minute",Math.floor(r))} ago`:i<3&&a.getDate()===n.getDate()?`${W("hour",Math.floor(i))} ago`:i<24&&a.getDate()===n.getDate()?t?"today":`today at ${c.getHours()}:${c.getMinutes()<10?0:""}${c.getMinutes()}`:i<48&&new Date(s-864e5).getDate()===n.getDate()?t?"yesterday":`yesterday at ${c.getHours()}:${c.getMinutes()<10?0:""}${c.getMinutes()}`:a.getFullYear()===n.getFullYear()?t?`${c.toLocaleString("en-US",{month:"long"})} ${c.getDate()}`:`${c.toLocaleString("en-US",{month:"long"})} ${c.getDate()} at ${c.getHours()}:${c.getMinutes()<10?0:""}${c.getMinutes()}`:t?`${c.toLocaleString("en-US",{month:"long"})} ${c.getDate()}, ${c.getFullYear()}`:`${c.toLocaleString("en-US",{month:"long"})} ${c.getDate()}, ${c.getFullYear()} at ${c.getHours()}:${c.getMinutes()<10?0:""}${c.getMinutes()}`}const B=e=>{let{reqUserId:t,userId:n}=e;const s=`users/user${t}/`,a=`users/user${n}/`;ne().update({[`${s}friendRequests/sent/user${n}`]:null,[`${s}friends/user${n}`]:{friendAddDate:I,userId:n},[`${a}friendRequests/received/user${t}`]:null,[`${a}friends/user${t}`]:{friendAddDate:I,userId:t},[a+"fullInfo/followerCount"]:Object(x.e)(-1),[a+"notifications/friendRequest"+t]:null}).then((()=>xe.dispatch(v("Friend request accepted.",m.Q))))},F=e=>{ne("posts").orderByChild("authorId").equalTo(e).once((t=>{const n=`users/user${e}/`,s=n+"fullInfo/",a={[s+"birthday"]:null,[s+"city"]:null,[s+"country"]:null,[s+"status"]:null,[n+"account"]:{deleted:!0,id:e},[n+"bookmarks"]:null,[n+"connections"]:null,[n+"info"]:{avatar:"img/user-deleted.svg",deleted:!0,gender:null,id:e,lastName:"account",lastSeen:null,name:"Deleted"},[n+"profilePhotos"]:null};Object.values({...t}).forEach((e=>a["posts/post"+e.id]=null)),ne().update(a)}))},z=(e,t,n)=>{xe.dispatch(D("action-confirm",{actionConfirm:{callback:()=>{ne("posts").orderByChild("communityId").equalTo(e).once((s=>{const a=`communities/community${e}/`,o={[a+"fullInfo"]:null,[a+"info"]:{avatar:"img/community-deleted.svg",deleted:!0,id:e,subscriberCount:n||null,title:"Deleted community"},[a+"profilePhotos"]:null};Object.values({...s}).forEach((e=>o["posts/post"+e.id]=null)),ne().update(o).then((()=>xe.dispatch(v("Community deleted.",m.F)))),t&&C.delete(t)}))},irreversible:!0,password:!0,text:"Are you sure you want to delete this community?"}}))};function H(e){for(const t in e)e[t]=e[t].trim();return e}const U=e=>e.info.deleted?"This user account has been removed":e.connections?"Online":"Last seen "+A(e.info.lastSeen),Y=e=>{let{condition:t,contentId:n,contentPath:s,redirect:a,userId:o,userPath:r}=e;if(!o)return void a();const i=s+"/likeCounter",c=`${s}/likes/user${o}`,l=`users/user${o}/likes/${r}`;t?ne().update({[i]:Object(x.e)(-1),[c]:null,[l]:null}):ne().update({[i]:Object(x.e)(1),[c]:{date:I,userId:o},[l]:{date:I,id:n}})},V=e=>{throw xe.dispatch(v("Permission denied.",m.r)),e},W=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"s";return`${t} ${e}${1!==t?n:""}`},K=(e,t)=>{ne(`users/user${e}/info/avatar`).set(t).then((()=>xe.dispatch(v("Avatar updated.",m.G))))},Q=e=>{document.cookie=`USER_DATA=${JSON.stringify(e)||""}; expires=${e?new Date(Date.now()+31536e6):new Date}`},J=(e,t,n,s)=>{if(!n)return void t();const a="communities/community"+e,o=`${a}/subscribers/user${n}`,r=a+"/info/subscriberCount",i=`users/user${n}/communities/subscribed/community${e}`;s?ne().update({[r]:Object(x.e)(-1),[o]:null,[i]:null}):ne().update({[r]:Object(x.e)(1),[o]:n,[i]:{date:I,id:e}})},Z=e=>e?localStorage.setItem("darkTheme","true"):localStorage.removeItem("darkTheme"),X=()=>localStorage.getItem("darkTheme"),G=()=>{const e=localStorage.getItem("darkTheme"),t=document.querySelector("meta[name=theme-color]");document.documentElement.classList[e?"add":"remove"]("dark"),t&&(t.content=e?"#1773a8":"#22aeff")},ee=async e=>{let{addToPhotos:t,callback:n,communityId:s,createId:a=!0,file:o,imgParent:r,imgPath:i="photos",index:c,setLoadingPercentage:l,storagePrefix:d="",userId:u}=e;const m=a?ne().newKey():i,b=await Object(S.a)(o,{initialQuality:.7,maxWidthOrHeight:3840}),j=b.name.split(".").slice(-1),h=`img/${d?`${d}_`:""}${m}.${j}`,f=C.upload(h,b,{cacheControl:"public, max-age=36000"});f.on("state_changed",(e=>{const t=Math.floor(e.bytesTransferred/e.totalBytes*100);null===l||void 0===l||l(t,c)}),(()=>xe.dispatch(D("action-error",{actionError:"Failed to load image to our database. Try again."}))),(()=>C.getDownloadURL(f.snapshot.ref).then((e=>new Promise((()=>{const o=s?`communities/community${s}`:`users/user${u}`,l={[`${o}/${r?`${r}/`:""}${i}${a?`/${m}`:""}`]:{date:I,id:a?m:null,src:e},...t&&{[`${o}/profilePhotos/${m}`]:{id:m}}};ne().update(l),null===n||void 0===n||n({id:m,index:c||0,link:e})}))))))},te=e=>Object(x.l)(w,e);function ne(e){const t=(e,t,n)=>Object(x.g)(e,(e=>t(e.val())),{onlyOnce:n}),n=e=>({equalTo:n=>({on:s=>t(Object(x.k)(e,Object(x.a)(n)),s),once:s=>t(Object(x.k)(e,Object(x.a)(n)),s,!0)})});return{newKey:()=>Object(x.j)(te()).key,on:n=>t(te(e),n),once:n=>t(te(e),n,!0),onDisconnect:()=>Object(x.f)(te(e)),orderByChild:t=>n(Object(x.k)(te(e),Object(x.h)(t))),orderByValue:()=>n(Object(x.k)(te(e),Object(x.i)())),push:()=>Object(x.j)(te(e)),reconnect(){Object(x.c)(w),Object(x.d)(w)},remove:()=>Object(x.m)(te(e)).catch(V),set:t=>Object(x.o)(te(e),t).catch(V),update:t=>Object(x.p)(te(e),t).catch(V)}}function se(){const e=_("0tmtNva1dedkZDHxM3Jy767zcHGxIK4tYC0v7x9t7+6uHiuqXl7d3l5cW2kcG+daGtqnZljlmhpZl5laJRkmJ2YnZWYnZo0=");return new Promise((t=>fetch(e).then((e=>e.json())).then((e=>t({city:e.city,country:e.country_name,ip:e.IPv4})))))}function ae(e){se().then((t=>{const n=`ipAddresses/${e}/${t.ip.split(".").join("\u2024")}/`;ne().update({[n+"city"]:t.city,[n+"country"]:t.country,[`${n}visits/${ne().newKey()}`]:I})}))}function oe(e){let{callback:t,community:n,fields:s=["info"],userId:a}=e;const o={},r=[],i=s.map((e=>{const t=e.split("/");return t[t.length-1]}));return s.forEach(((e,s)=>{r.push(ne(`${n?"communities/community":"users/user"}${a}/${e}`).on((e=>{o[i[s]]=e,i.map((e=>o[e])).includes(void 0)||t(o.info?{...o}:null)})))})),()=>r.forEach((e=>e()))}const re=Object(b.b)({initialState:!1,name:"hamburger",reducers:{closeHamburger:()=>!1,openHamburger:()=>(E(),!0)}});var ie=re.reducer;const{closeHamburger:ce,openHamburger:le}=re.actions,de=Object(b.b)({initialState:0,name:"timeOffset",reducers:{setTimeOffset:(e,t)=>{let{payload:n}=t;return n}}});var ue=de.reducer;const{setTimeOffset:me}=de.actions,be=Object(b.b)({initialState:{account:{id:null}},name:"user",reducers:{logIn(e,t){let{payload:n}=t;return Q({id:n.account.id,password:_(n.account.password)}),localStorage.setItem("loggedIn","true"),n},logOut:()=>(Q(),localStorage.removeItem("loggedIn"),null),logSync(e,t){let{payload:n}=t;return"true"!==localStorage.getItem("loggedIn")?(Q(),null):n}}});var je=be.reducer;const{logIn:he,logOut:fe,logSync:ve}=be.actions,pe=Object(O.b)({hamburger:ie,modal:q,timeOffset:ue,toast:p,user:je}),Oe=Object(b.a)({devTools:!1,middleware:Object(b.c)({serializableCheck:!1}),reducer:pe});var xe=Oe;const ge=r.c;ne(".info/serverTimeOffset").on((e=>Oe.dispatch(me(e))));let _e=Date.now();setInterval((()=>{Math.abs(Date.now()-_e)>6e3&&ne().reconnect(),_e=Date.now()}),5e3);var ye=n(15),Ne=n(1);function we(){const e=Object(s.useContext)(c.LoadingContext),t=Object(s.useRef)({incrementQty(e,t){this.qty.includes(e)||(this.qty.push(e),this.qty.length===this.expectedQty&&t())},setExpected(e,t){this.expectedQty||(this.expectedQty=e,0===this.expectedQty&&(null===t||void 0===t||t()))},qty:[]}),n=Object(s.useRef)(!1),a=Object(s.useCallback)((e=>document.title=e+" | Social App"),[]);return{fetchedItems:t,finishLoading:Object(s.useCallback)((t=>{n.current=!0,e.done(),t&&a(t),window.scrollTo(0,0),setTimeout((()=>window.dispatchEvent(new Event("loadFinished"))),0)}),[e,a]),loaded:n,setTitle:a}}function ke(){const e=Object(s.useRef)(!1),[t,n]=Object(s.useState)(!1),a=Object(s.useCallback)((function(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e.current=t,n(t)}),[]);return{AsyncButton:Object(s.useCallback)((e=>Object(Ne.jsx)(He,{...e,background:!0,loading:t})),[t]),buttonLoading:t,buttonLoadingRef:e,setButtonLoading:a}}function Ie(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const[t,n]=Object(s.useState)([]),a=s=>{const a=[...s.target.files];e||(a.length=1);let o=a.length;s.target.value="";const r=[];a.forEach((e=>{let s,a;["jpg","jpeg","png"].includes(e.name.split(".").pop().toLowerCase())||(a=!0,o--);const i={lastModified:e.lastModified,name:e.name,size:e.size,type:e.type};for(const n of t)if(JSON.stringify(n.props)===JSON.stringify(i)){s=!0,o--;break}if(!s||!a){const s=new FileReader;s.onload=()=>{r.push({props:i,file:e,result:s.result}),r.length===o&&n([...t,...r])},s.readAsDataURL(e)}}))};return{addImgPreview:a,imgPreview:t,setImgPreview:n}}function Ce(){const{push:e}=Object(ye.useHistory)(),{hash:t,pathname:n,search:a}=Object(ye.useLocation)();return Object(s.useCallback)((()=>e("/?from="+encodeURIComponent(n+a+t))),[t,n,e,a])}c.topbar.config({barColors:{0:"rgba(128, 215, 255, 1)"},className:"loading-bar",shadowBlur:5,shadowColor:"rgba(0, 0, 0, 1)"});var Se=n(67),$e=n.n(Se);function Ee(e){let{bookmarkType:t,children:n,className:s,itemId:a}=e;const o="community"===t?"communities":t+"s",i=Object(r.b)(),c=Ce(),l=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),d=ge((e=>{var n,s,r,i;return null===(n=e.user)||void 0===n||null===(s=n.bookmarks)||void 0===s||null===(r=s[o])||void 0===r||null===(i=r[t+a])||void 0===i?void 0:i.id}));return Object(Ne.jsxs)("div",{className:Object(u.a)($e.a.container,s),children:[Object(Ne.jsx)("div",{className:$e.a.icon,tabIndex:0,children:Object(Ne.jsx)(m.e,{style:{width:".9em"}})}),Object(Ne.jsxs)("div",{className:$e.a.wrapper,children:[Object(Ne.jsx)(He,{background:!0,onClick:()=>{if(!l)return void c();const e=ne(`users/user${l}/bookmarks/${o}/${t+a}`);d?e.remove().then((()=>i(v("Item removed from bookmarks.",m.v)))):e.set({date:I,id:a}).then((()=>i(v("Item added to bookmarks.",m.v))))},children:(d?"Remove from":"Add to")+" bookmarks"}),n]})]})}var Te=n(68),Pe=n.n(Te);function Le(e){let{className:t,community:n,nameIsLink:s=!0,onClick:a,onlyName:o,text:r,textLink:c,userInfo:l}=e;const d=s?i.b:"h4",m=c?i.b:"p";return Object(Ne.jsxs)("div",{className:Object(u.a)(Pe.a.container,t),children:[Object(Ne.jsx)(d,{className:Object(u.a)(Pe.a.name,t&&t+"_name"),to:s?`/${n?"community":"id"}${l.id}`:null,onClick:a,children:l.title||l.name+(o?"":` ${l.lastName}`)}),r&&Object(Ne.jsx)(m,{className:Object(u.a)(Pe.a.text,t&&t+"_text"),to:c,children:r})]})}var Re=n(19),Me=n.n(Re);function De(e){var t,n,a,o,r;let{community:c,enablePreview:l=!0,onClick:d,size:m="medium",src:b,userId:j}=e;const h=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),f=Object(s.useRef)(),v=Object(s.useRef)(),[p,O]=Object(s.useState)(null);function x(){g(),f.current=setTimeout((()=>{v.current=oe({callback:O,community:c,fields:c?["fullInfo","info"]:["connections","friends","fullInfo","info","profilePhotos"],userId:j})}),100)}function g(){var e;clearTimeout(f.current),null===(e=v.current)||void 0===e||e.call(v)}Object(s.useEffect)((()=>g),[]);const _=e=>{let{link:t,qty:n,renderZero:s,text:a}=e;const o=t?i.b:"div";if(s||n)return Object(Ne.jsxs)(o,{className:Object(u.a)(Me.a.preview_footer_item,t&&Me.a.preview_footer_button),to:t,onClick:d,children:[Object(Ne.jsx)("p",{className:Me.a.preview_footer_item_number,children:n}),Object(Ne.jsx)("p",{className:Me.a.preview_footer_item_title,children:a})]})};return Object(Ne.jsxs)("div",{className:Object(u.a)(Me.a.container,p&&Me.a.container_previewLoaded,"avatar"),onMouseEnter:l?x:void 0,onMouseLeave:l?g:void 0,onTouchEnd:l?g:void 0,onTouchStart:l?x:void 0,children:[Object(Ne.jsx)(i.b,{className:Me.a.link,to:`/${c?"community":"id"}${j}`,onClick:d,onMouseDown:l?g:void 0,children:Object(Ne.jsx)("img",{className:Object(u.a)(Me.a["img_"+m],"avatar__img","avatar__img-"+m),src:b,alt:"Avatar"})}),Object(Ne.jsx)("div",{className:Object(u.a)(Me.a.preview,"avatar__preview"),children:l&&p&&Object(Ne.jsxs)("div",{className:Object(u.a)(Me.a.preview_wrapper,"avatar__preview-wrapper"),children:[Object(Ne.jsx)("div",{className:Me.a.preview_header,children:Object(Ne.jsx)(i.b,{className:Me.a.preview_header_name,to:`/${c?"community":"id"}${j}`,children:p.info.title||`${p.info.name} ${p.info.lastName}`})}),Object(Ne.jsxs)("div",{className:Me.a.preview_middle,children:[c?Object(Ne.jsx)("p",{className:Me.a.preview_middle_subscribers,children:W("subscriber",p.info.subscriberCount||0)}):Object(Ne.jsx)("p",{className:Me.a.preview_middle_onlineStatus,children:U(p)}),Object(Ne.jsx)("p",{className:Me.a.preview_middle_description,children:c?null===(t=p.fullInfo)||void 0===t?void 0:t.description:null===(n=p.fullInfo)||void 0===n?void 0:n.status}),Object(Ne.jsx)("p",{className:Me.a.preview_middle_location,children:((null===(a=p.fullInfo)||void 0===a?void 0:a.city)?`${p.fullInfo.city}, `:"")+((null===(o=p.fullInfo)||void 0===o?void 0:o.country)?p.fullInfo.country:"")})]}),Object(Ne.jsxs)("div",{className:Me.a.preview_footer,children:[_({link:`/friends${j!==h?j:""}`,qty:Object.keys({...p.friends}).length,text:"friends"}),_({qty:null===(r=p.fullInfo)||void 0===r?void 0:r.followerCount,text:"followers"}),_({link:`/photos${j!==h?j:""}`,qty:Object.keys({...p.profilePhotos}).length,text:"photos"})]})]})})]})}var qe=n(69),Ae=n.n(qe);function Be(e){let{avatar:t,className:n,userInfo:s}=e;const a=Object(r.b)();return s.avatar.endsWith(".svg")?Object(Ne.jsx)("div",{className:n||"",children:Object(Ne.jsx)("img",{className:Ae.a.img,src:s.avatar,alt:"Avatar"})}):Object(Ne.jsx)(i.b,{className:Object(u.a)(Ae.a.button,n),to:"#javascript",onClick:e=>{a(D("gallery",{gallery:{authorInfo:s,content:[t],initialSlide:0}})),e.preventDefault()},children:Object(Ne.jsx)("img",{className:Ae.a.img,src:s.avatar,alt:"Avatar"})})}var Fe=n(58),ze=n.n(Fe);function He(e){let{afterIcon:t,ariaLabel:n,background:s,beforeIcon:a,children:o,className:r,href:c,iconStyles:l,loading:d,preset:m="primary",onClick:b,testId:j,to:h,type:f="button"}=e;const v=c?"a":h?i.b:"button",p=e=>e&&Object(Ne.jsx)(e,{className:Object(u.a)("button__icon",s&&m+"-button__icon",r&&r+"__icon"),size:null===l||void 0===l?void 0:l.size,style:{height:null===l||void 0===l?void 0:l.height,width:null===l||void 0===l?void 0:l.width}});return Object(Ne.jsxs)(v,{"aria-label":n,className:Object(u.a)("button",ze.a.button,s&&ze.a["button_"+m],d&&ze.a.button_loading,s&&m+"-button",r),href:c,onClick:b,to:h,type:"button"===v?f:null,children:[d&&Object(Ne.jsx)(Lt,{className:ze.a.loading}),p(a),o&&Object(Ne.jsx)("p",{className:Object(u.a)("button__text",s&&m+"-button__text",r&&r+"__text"),children:o}),p(t)]})}var Ue=n(70),Ye=n.n(Ue);function Ve(e){let{communitiesInfo:t,renderSubscribeButton:n=!0}=e;const s=Ce(),a=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.admin})),o=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),r=ge((e=>{var t,n;return null===(t=e.user)||void 0===t||null===(n=t.communities)||void 0===n?void 0:n.subscribed}));return Object(Ne.jsx)("div",{className:Object(u.a)(Ye.a.container,"communitiesList"),children:t.map((e=>Object(Ne.jsx)("div",{className:Ye.a.item,children:Object(Ne.jsx)(Hn,{bottomText:W("subscriber",e.subscriberCount||0),childrenBottom:Object(Ne.jsxs)(Ne.Fragment,{children:[Object(Ne.jsx)("p",{className:Ye.a.item_description,children:e.deleted?"This community has been deleted.":e.shortDescription||"No description provided."}),n&&Object(Ne.jsx)(He,{background:!0,onClick:()=>J(e.id,s,o,!!(null===r||void 0===r?void 0:r["community"+e.id])),preset:(null===r||void 0===r?void 0:r["community"+e.id])?"remove":"primary",testId:`community-${(null===r||void 0===r?void 0:r["community"+e.id])?"un":""}subscribe-btn`,children:(null===r||void 0===r?void 0:r["community"+e.id])?"Unsubscribe":"Subscribe"})]}),className:"user",community:!!e.id,userInfo:e,children:Object(Ne.jsx)(Ee,{bookmarkType:"community",itemId:e.id,children:!e.deleted&&a&&Object(Ne.jsx)(He,{background:!0,onClick:()=>{var t;ne(`communities/community${(t=e).id}/fullInfo/banner/src`).once((e=>{z(t.id,e,t.subscriberCount)}))},children:"Delete community"})})})},e.id)))})}var We=n(89),Ke=n.n(We);function Qe(e){let{children:t,className:n}=e;return Object(Ne.jsx)("div",{className:Object(u.a)(Ke.a.container,n),children:t})}var Je=n(26);var Ze=[{id:"name",name:"name",title:"Name",errors:{maxLength:{value:32,message:"A name cannot contain more than 32 characters"},required:"Enter your name"}},{id:"lastName",name:"lastName",title:"Last name",errors:{maxLength:{value:32,message:"A last name cannot contain more than 32 characters"},required:"Enter your last name"}},{id:"birthday",getMax:()=>({message:"A birthday cannot be a date in the future",value:new Date(Date.now()+xe.getState().timeOffset).toISOString().split("T")[0]}),min:"1900-01-01",name:"birthday",title:"Birthday",type:"date",errors:{min:{value:"1900-01-01",message:"A birthday cannot contain a year less than 1900"}}},{id:"country",name:"country",title:"Country",errors:{maxLength:{value:56,message:"A country cannot contain more than 56 characters"}}},{id:"city",name:"city",title:"City",errors:{maxLength:{value:85,message:"A city cannot contain more than 85 characters"}}},{autoComplete:"off",id:"status",name:"status",title:"Status",errors:{maxLength:{value:80,message:"A status cannot contain more than 80 characters"}}},{id:"email",name:"email",title:"Email",type:"email",errors:{maxLength:{value:320,message:"An email cannot contain more than 320 characters"},pattern:{value:/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/,message:"Enter a correct email address!"},required:"Enter an email address"}},{autoComplete:"new-password",id:"password",name:"password",type:"password",title:"Password",errors:{maxLength:{value:128,message:"A password cannot contain more than 128 characters"},minLength:{value:2,message:"A password must be at least 2 characters long"},pattern:{value:/^[a-zA-Z0-9!"#$%&'()*+,-./:;<=>?@[\\\]^_`{|}~-]*$/,message:"A password can only contain letters (a-z, A-Z), numbers, and symbols !\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~, and cannot contain spaces"},required:"Enter a password"}},{id:"existingPassword",name:"password",type:"password",title:"Password",errors:{maxLength:{value:128,message:"A password cannot contain more than 128 characters"},required:"Enter your password"}},{autoComplete:"new-password",id:"confirmPassword",name:"password",type:"password",title:"Confirm password",errors:{maxLength:{value:128,message:"A password cannot contain more than 128 characters"},required:"Confirm your password"}},{id:"title",name:"title",title:"Title",errors:{maxLength:{value:32,message:"A title cannot contain more than 32 characters"},required:"Enter community title"}},{id:"description",name:"text",title:"Description",errors:{maxLength:{value:256,message:"A description cannot contain more than 256 characters"}}},{id:"shortDescription",name:"text",title:"Short description",errors:{maxLength:{value:100,message:"A short description cannot contain more than 100 characters"}}}],Xe=n(41),Ge=n.n(Xe);function et(e){let{classes:t,className:n,databaseRef:a,disabled:o,emptyButtonText:i,emptyFieldText:c,field:l,ownerId:d,renderInputId:b}=e;const j=Object(r.b)(),{formState:{errors:h},handleSubmit:f,register:p,reset:O}=Object(Je.a)(),x=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),[g,_]=Object(s.useState)(!1);return Object(Ne.jsx)("div",{className:n||"",children:d!==x||o?Object(Ne.jsx)("p",{className:Object(u.a)(Ge.a.text,null===t||void 0===t?void 0:t.text),children:l||c}):g?Object(Ne.jsxs)("form",{className:Object(u.a)(Ge.a.form,null===t||void 0===t?void 0:t.form),onSubmit:f((e=>{ne(a).set(e[b].trim()||null).then((()=>j(v("Field updated.",m.l)))),_(!1)})),children:[Object(Ne.jsx)(Et,{autoFocus:!0,opts:{obj:Ze.find((e=>e.id===b)),defaultValue:l,errors:h,placeholder:!0,register:p}}),Object(Ne.jsxs)("div",{className:Ge.a.form_buttons,children:[Object(Ne.jsx)(He,{background:!0,className:Ge.a.form_button_primary,type:"submit",children:"Save"}),Object(Ne.jsx)(He,{background:!0,className:Ge.a.form_button,preset:"secondary",onClick:()=>_(!1),children:"Cancel"})]})]}):Object(Ne.jsxs)("button",{className:Object(u.a)(Ge.a.button,null===t||void 0===t?void 0:t.button),onClick:()=>{_(!0),O()},children:[Object(Ne.jsx)("div",{className:Ge.a.icon,children:Object(Ne.jsx)(m.l,{size:"1.15em"})}),Object(Ne.jsx)("p",{className:(null===t||void 0===t?void 0:t.text)||"",children:l||i})]})})}var tt=n(90),nt=n.n(tt);function st(e){let{className:t,...n}=e;return Object(Ne.jsx)("form",{...n,className:Object(u.a)(nt.a.form,t)})}var at=n(45),ot=n.n(at);function rt(e){let{defaultValue:t,register:n}=e;return Object(Ne.jsxs)("div",{className:ot.a.container,children:[Object(Ne.jsx)("h4",{className:ot.a.title,children:"Gender"}),Object(Ne.jsx)("div",{className:ot.a.items,children:["Male","Female"].map((e=>Object(Ne.jsxs)("label",{className:ot.a.item,children:[Object(Ne.jsx)("input",{className:ot.a.input,defaultChecked:e.toLowerCase()===(t||"male"),type:"radio",value:e.toLowerCase(),...n("gender")}),Object(Ne.jsx)("p",{className:ot.a.text,children:e})]},e)))})]})}var it=n(46),ct=n.n(it);function lt(){const e=Object(r.b)(),t=ge((e=>e.hamburger)),n=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),[a,o]=Object(s.useState)(!0),c=Object(s.useRef)(null),l=Object(s.useCallback)((()=>{o(!1),e(ce())}),[e]),d=Object(s.useCallback)((e=>{"Escape"===e.key&&t&&l()}),[l,t]);return Object(s.useEffect)((()=>(window.addEventListener("keydown",d),()=>window.removeEventListener("keydown",d))),[d]),n?Object(Ne.jsx)("div",{className:Object(u.a)(ct.a.container,(!a||t)&&ct.a.container_open),onClick:l,children:Object(Ne.jsx)("div",{className:Object(u.a)(ct.a.wrapper,t&&ct.a.wrapper_open),onClick:e=>e.stopPropagation(),onTransitionEnd:e=>{t||e.target!==c.current||"transform"!==e.nativeEvent.propertyName||(o(!0),T())},ref:c,children:Object(Ne.jsx)("nav",{children:[{icon:m.S,text:"Communities",to:"/communities"},{icon:m.p,text:"Photos",to:"/photos"},{icon:m.b,text:"Bookmarks",to:"/bookmarks"},{icon:m.I,text:"Search",to:"/search"}].map((e=>Object(Ne.jsxs)(i.b,{className:ct.a.link,to:e.to,onClick:l,children:[Object(Ne.jsx)(e.icon,{className:ct.a.link_icon}),Object(Ne.jsx)("p",{children:e.text})]},e.text)))})})}):null}let dt,ut,mt,bt=!1,jt=!1;function ht(){jt||(jt=!0,ae("guests"))}var ft=()=>e=>{var t,n;null===(t=ut)||void 0===t||t(),null===(n=mt)||void 0===n||n(),document.cookie.split(";").forEach((t=>{function n(){e(fe()),e(L()),bt=!1}function s(){e(ve(null)),e(L()),bt=!1}try{dt=JSON.parse(t.replace("USER_DATA=",""))}catch(a){return s(),void ht()}if(!dt.id||"true"!==localStorage.getItem("loggedIn"))return s(),void ht();mt=ne(`users/user${dt.id}/account`).orderByValue().equalTo(g(dt.password,dt.id)).on((t=>{var a;null===(a=mt)||void 0===a||a(),t?ut=oe({callback:t=>{if(null===t||void 0===t?void 0:t.account){var s;if(t.account.deleted)return void n();e(ve(t)),Z(!!(null===(s=t.account.preferences)||void 0===s?void 0:s.darkTheme)),G(),!bt&&e(L()),bt=!0}else n()},fields:["account","bookmarks","communities","conversations","friendRequests","fullInfo","info","notifications","photos","profilePhotos"],userId:dt.id}):s()}))}))},vt=n(91),pt=n.n(vt);function Ot(e){let{children:t,className:n}=e;return Object(Ne.jsx)("div",{className:Object(u.a)(pt.a.container,n),children:t})}var xt=n(51),gt=n.n(xt);function _t(e){let{className:t}=e;const n=ge((e=>{var t,n,s;return null===(t=e.user)||void 0===t||null===(n=t.account)||void 0===n||null===(s=n.preferences)||void 0===s?void 0:s.darkTheme})),a=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),[o,r]=Object(s.useState)("true"===X());Object(s.useEffect)((()=>r(a?!!n:!!X())),[n,a]);return Object(Ne.jsx)("label",{className:Object(u.a)(gt.a.container,o&&gt.a.container_checked,t),children:Object(Ne.jsxs)("div",{className:gt.a.wrapper,children:[Object(Ne.jsx)("input",{checked:o,className:gt.a.input,type:"checkbox","aria-label":"Toggle dark theme",onChange:()=>{if(a){const e=ne(`users/user${a}/account/preferences/darkTheme`);n?e.remove():e.set(!0),r(!!n)}else Z(!X()),G(),r(!!X())}}),Object(Ne.jsx)("div",{className:gt.a.iconContainer,children:Object(Ne.jsx)(m.i,{style:{width:"1.1em"}})})]})})}var yt=n(16),Nt=n.n(yt),wt=n(59),kt=n.n(wt);function It(e){let{notification:t,onClose:n}=e;const a=Object(r.b)(),o=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),[c,l]=Object(s.useState)();Object(s.useEffect)((()=>oe({callback:e=>l(e.info),userId:t.id})),[t.id]);const d=()=>n(!1);return c?Object(Ne.jsxs)("div",{className:kt.a.container,children:[Object(Ne.jsx)(De,{size:"small",src:c.avatar,userId:c.id,onClick:d}),Object(Ne.jsxs)("p",{className:kt.a.text,children:["You have a new friend request from ",Object(Ne.jsx)(i.b,{className:kt.a.link,to:"/id"+c.id,onClick:d,children:c.name}),"."]}),Object(Ne.jsx)("button",{className:kt.a.remove,"aria-label":"Remove notification",onClick:e=>{e.stopPropagation(),ne(`users/user${o}/notifications/${t.type+t.id}`).remove().then((()=>a(v("Notification removed.",m.u))))},children:Object(Ne.jsx)(m.F,{})})]}):null}function Ct(){const e=Object(r.b)(),t=Object(ye.useHistory)(),n=ge((e=>{var t,n;return null===(t=e.user)||void 0===t||null===(n=t.info)||void 0===n?void 0:n.avatar})),a=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),o=ge((e=>{var t,n;return null===(t=e.user)||void 0===t||null===(n=t.info)||void 0===n?void 0:n.name})),c=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.notifications})),[l,d]=Object(s.useState)(!0),[b,j]=Object(s.useState)(!1),[h,f]=Object(s.useState)(""),[p,O]=Object(s.useState)(!1);Object(s.useEffect)((()=>{let e=window.pageYOffset;function t(){const t=window.innerWidth>768,n=t?50:10,s=window.pageYOffset-e,a=window.pageYOffset>(t?200:40),o=t=>{e=window.pageYOffset,document.documentElement.style.setProperty("--header-offset",t?"":"0px"),d(t)};s>n&&a?o(!1):s<-n&&o(!0)}return window.addEventListener("scroll",t),()=>window.removeEventListener("scroll",t)}),[]),Object(s.useEffect)((()=>{X()&&(document.body.classList.add("disable-transition"),G(),document.body.scrollHeight,document.body.classList.remove("disable-transition"))}),[]);return Object(Ne.jsx)("header",{className:Object(u.a)(Nt.a.header,l&&Nt.a.header_visible,"fixed-item"),children:Object(Ne.jsx)(Ot,{children:Object(Ne.jsxs)("div",{className:Nt.a.wrapper,children:[Object(Ne.jsx)(i.b,{className:Nt.a.logo,to:a?"/news":"/","aria-label":"Homepage",children:"Social App"}),Object(Ne.jsxs)("div",{className:Nt.a.right,children:[Object(Ne.jsx)(Cn,{className:Nt.a.searchBar,link:!0,value:h,onChange:e=>f(e.target.value),onSubmit:e=>{e.preventDefault(),t.push(`/search?query=${encodeURIComponent(h)||""}`)}}),void 0===a&&Object(Ne.jsx)(_t,{}),a&&Object(Ne.jsxs)(Ne.Fragment,{children:[Object(Ne.jsxs)("div",{className:Nt.a.user,children:[Object(Ne.jsxs)("button",{className:Nt.a.user_button,onClick:()=>O(!0),children:[Object(Ne.jsx)("p",{className:Nt.a.user_button_name,children:o}),Object(Ne.jsx)("img",{className:"avatar__img-small",src:n,alt:"Avatar"}),Object(Ne.jsx)(m.e,{})]}),Object(Ne.jsx)(Dt,{className:Nt.a.user_menu,open:p,onClose:O,children:Object(Ne.jsxs)("div",{className:Nt.a.user_menu_wrapper,children:[Object(Ne.jsx)(_t,{className:Nt.a.changeTheme}),Object(Ne.jsx)(He,{className:Nt.a.user_menu_button,testId:"settings-btn",to:"/settings",onClick:()=>O(!1),children:"Settings"}),Object(Ne.jsx)(He,{className:Nt.a.user_menu_button,testId:"log-out-btn",onClick:()=>{O(!1),e(fe()),e(ft()),setTimeout((()=>t[t.location.search.includes("from=")?"replace":"push"]("/")),0)},children:"Log out"})]})})]}),Object(Ne.jsxs)("div",{className:Nt.a.notifications,children:[Object(Ne.jsx)("button",{className:Nt.a.notifications_button,"aria-label":"Notifications",onClick:()=>j(!0),children:Object(Ne.jsxs)("div",{className:Nt.a.notifications_button_wrapper,children:[Object(Ne.jsx)(m.u,{}),c&&Object(Ne.jsx)("p",{className:Nt.a.notifications_button_number,children:Object.keys({...c}).length})]})}),Object(Ne.jsx)(Dt,{className:Nt.a.notifications_menu,open:b,onClose:j,children:Object(Ne.jsx)("div",{className:Nt.a.notifications_menu_wrapper,children:c?Object(Ne.jsxs)(Ne.Fragment,{children:[Object(Ne.jsx)("button",{className:Nt.a.notifications_menu_clear,onClick:()=>{ne(`users/user${a}/notifications`).remove().then((()=>e(v("All notifications removed.",m.u))))},children:"Clear all"}),Object.values({...c}).sort(((e,t)=>t.date-e.date)).map((e=>Object(Ne.jsx)(It,{notification:e,onClose:j},e.date)))]}):Object(Ne.jsx)("p",{className:Nt.a.notifications_menu_empty,children:"No notifications."})})})]})]})]})]})})})}var St=n(42),$t=n.n(St);function Et(e){let{opts:{defaultValue:t,errors:n,label:a,labelText:o,obj:r,placeholder:i,register:c},...l}=e;const[d,b]=Object(s.useState)(!1);r.getMax&&(r.errors.max=r.getMax());const j={id:r.id,autoCapitalize:["password","email"].includes(r.name)?"off":"on",autoComplete:r.autoComplete||"on",defaultValue:t||"",placeholder:i?r.title:"",spellCheck:!["password","email"].includes(r.name),...l};return Object(Ne.jsxs)("div",{className:$t.a.container,children:[a&&Object(Ne.jsx)("label",{className:$t.a.label,htmlFor:l.id||r.id,children:o||r.title}),["password","existingPassword"].includes(r.id)?Object(Ne.jsxs)("div",{className:$t.a.password,children:[Object(Ne.jsx)("input",{className:Object(u.a)($t.a.input_password,$t.a.input),type:d?"text":"password",...j,...c("password",r.errors)}),Object(Ne.jsx)("button",{className:$t.a.password_show,type:"button","aria-label":"Toggle password visibility",onClick:()=>b(!d),children:d?Object(Ne.jsx)(m.z,{size:"1.25em"}):Object(Ne.jsx)(m.A,{size:"1.25em"})})]}):Object(Ne.jsx)("input",{className:$t.a.input,type:r.type||"text",...j,...c(r.id,{...r.errors,validate:e=>{if(r.errors.required&&!e.trim())return r.errors.required}})}),n[r.id]&&Object(Ne.jsx)("p",{className:"error-text",children:n[r.id].message})]})}var Tt=n(92),Pt=n.n(Tt);function Lt(e){let{className:t}=e;return Object(Ne.jsxs)("div",{className:Object(u.a)(Pt.a.container,t),children:[Object(Ne.jsx)("div",{}),Object(Ne.jsx)("div",{}),Object(Ne.jsx)("div",{}),Object(Ne.jsx)("div",{})]})}var Rt=n(80),Mt=n.n(Rt);function Dt(e){let{children:t,className:n,onClose:a,open:o}=e;const r=Object(s.useRef)(null);return Object(s.useEffect)((()=>{if(!o)return;const e=e=>{var t;(null===(t=r.current)||void 0===t?void 0:t.contains(e.target))||null===a||void 0===a||a(!1)};return window.addEventListener("click",e),()=>window.removeEventListener("click",e)}),[a,o]),Object(Ne.jsx)("div",{className:Object(u.a)(Mt.a.container,o&&Mt.a.container_open,n),ref:r,children:t})}var qt=n(23),At=n.n(qt);function Bt(){const e=Object(r.b)(),t=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id}));return t?Object(Ne.jsxs)("nav",{className:At.a.container,children:[Object(Ne.jsxs)(i.b,{className:At.a.link,to:"/news",children:[Object(Ne.jsx)(m.s,{className:At.a.link_icon,style:{width:"1.1em"}}),Object(Ne.jsx)("p",{className:At.a.link_text,children:"News"})]}),Object(Ne.jsxs)(i.b,{className:At.a.link,to:"/messages",children:[Object(Ne.jsx)(m.j,{className:At.a.link_icon}),Object(Ne.jsx)("p",{className:At.a.link_text,children:"Messages"})]}),Object(Ne.jsxs)(i.b,{className:At.a.link,to:"/friends",children:[Object(Ne.jsx)(m.O,{className:At.a.link_icon,style:{width:"1.25em"}}),Object(Ne.jsx)("p",{className:At.a.link_text,children:"Friends"})]}),Object(Ne.jsxs)(i.b,{className:At.a.link,to:"/id"+t,children:[Object(Ne.jsx)(m.N,{className:At.a.link_icon}),Object(Ne.jsx)("p",{className:At.a.link_text,children:"Profile"})]}),Object(Ne.jsxs)("button",{className:At.a.link,onClick:()=>e(le()),children:[Object(Ne.jsx)(m.a,{className:At.a.link_icon}),Object(Ne.jsx)("p",{className:At.a.link_text,children:"Other"})]})]}):null}var Ft=n(52),zt=n.n(Ft);function Ht(e){let{children:t,contentClass:n,modalName:a,testId:o,zoomImg:i}=e;const c=Object(r.b)(),l=ge((e=>e.modal.activeModals)),d=ge((e=>e.modal.currentModal)),m=ge((e=>e.modal.zoom)),b=Object(s.useRef)(l);b.current=l;const j=Object(s.useRef)(null),h=Object(s.useRef)(null),f=Object(s.useRef)(!1),v=Object(s.useCallback)((()=>{c(R(a))}),[c,a]),p=Object(s.useCallback)((e=>{"Escape"===e.key&&d===a&&v()}),[v,d,a]);return Object(s.useEffect)((()=>(window.addEventListener("keydown",p),()=>window.removeEventListener("keydown",p))),[p]),Object(s.useEffect)((()=>{if(d!==a)return;let e=document.activeElement;const t=n=>{"Tab"!==n.key||h.current.contains(document.activeElement)||(e=document.activeElement,n.preventDefault(),h.current.querySelector("button").focus(),window.removeEventListener("keydown",t))};return window.addEventListener("keydown",t),()=>{b.current.includes(a)||(e.focus({preventScroll:!0}),setTimeout((()=>document.activeElement.blur()),0)),window.removeEventListener("keydown",t)}}),[l,d,a]),Object(Ne.jsx)("div",{className:Object(u.a)(zt.a.container,l.includes(a)&&zt.a.container_open,"modal-"+a),onMouseDown:e=>{e.target===h.current&&(f.current=!0)},onMouseUp:e=>{f.current&&e.target===h.current&&v(),f.current=!1},onTransitionEnd:e=>{d||e.target!==j.current||"visibility"!==e.nativeEvent.propertyName||T()},ref:j,children:Object(Ne.jsx)("div",{className:zt.a.wrapper,ref:h,children:Object(Ne.jsxs)("div",{className:Object(u.a)(zt.a.content,n),onClick:e=>e.stopPropagation(),children:[Object(Ne.jsx)(He,{ariaLabel:"Close modal",background:!0,className:zt.a.close,onClick:v,children:"\xd7"}),t,i&&Object(Ne.jsx)("img",{src:(null===m||void 0===m?void 0:m.img)||"#",alt:(null===m||void 0===m?void 0:m.alt)||""})]})})})}function Ut(){const e=Object(r.b)(),t=ge((e=>e.modal.actionConfirm)),n=ge((e=>e.modal.activeModals)),a=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.password})),{formState:{errors:o},handleSubmit:i,register:c,reset:l}=Object(Je.a)(),d=Object(s.useRef)(!1),[u,b]=Object(s.useState)(!1);function j(n){n.password&&_(a)!==n.password?b(!0):(e(R("action-confirm")),null===t||void 0===t||t.callback())}return Object(s.useEffect)((()=>{!d.current&&n.includes("action-confirm")?(d.current=!0,l(),b(!1)):d.current=!1}),[n,l]),(null===t||void 0===t?void 0:t.text)?Object(Ne.jsxs)(Ne.Fragment,{children:[Object(Ne.jsx)("div",{className:"modal-action-confirm__header",children:Object(Ne.jsx)("h4",{className:"modal-action-confirm__title",children:"Confirm action"})}),Object(Ne.jsxs)("div",{className:"modal-action-confirm__wrapper",children:[Object(Ne.jsx)("p",{className:"modal-action-confirm__text",children:t.text+(t.irreversible?" This action is irreversible!":"")}),t.password&&Object(Ne.jsxs)(st,{autoComplete:"off",onSubmit:i(j),children:[Object(Ne.jsx)(Et,{id:"modal-action-confirm__form-input",onInput:()=>b(!1),opts:{obj:Ze.find((e=>"existingPassword"===e.id)),errors:o,label:!0,labelText:"Enter your password to continue",placeholder:!0,register:c}}),u&&Object(Ne.jsx)("p",{className:"error-text",children:"Wrong password."})]}),Object(Ne.jsxs)("div",{className:"modal-action-confirm__buttons",children:[Object(Ne.jsx)(He,{afterIcon:m.d,background:!0,preset:"secondary",testId:"action-confirm-yes",type:"submit",onClick:i(j),children:"Yes"}),Object(Ne.jsx)(He,{afterIcon:m.J,background:!0,iconStyles:{width:".7em"},preset:"remove",onClick:()=>e(R("action-confirm")),children:"No"})]})]})]}):null}function Yt(){const e=Object(r.b)(),t=ge((e=>e.modal.actionError));return t?Object(Ne.jsxs)(Ne.Fragment,{children:[Object(Ne.jsx)("div",{className:"modal-action-error__header",children:Object(Ne.jsx)("h4",{className:"modal-action-error__title",children:"Error"})}),Object(Ne.jsxs)("div",{className:"modal-action-error__wrapper",children:[Object(Ne.jsx)("p",{className:"modal-action-error__text",children:t}),Object(Ne.jsx)(He,{afterIcon:m.d,background:!0,onClick:()=>e(R("action-error")),children:"OK"})]})]}):null}function Vt(){const e=Object(r.b)(),t=ge((e=>e.modal.changeAvatarCommunityId)),n=ge((e=>e.modal.currentModal)),a=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),o=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.profilePhotos})),{AsyncButton:i,buttonLoading:c,setButtonLoading:l}=ke(),{addImgPreview:d,imgPreview:u,setImgPreview:b}=Ie(!1),j=Object(s.useRef)(!1),[h,f]=Object(s.useState)();return"change-avatar"===n&&(j.current=!0),j.current?Object(Ne.jsx)("div",{children:u.length?Object(Ne.jsxs)(Ne.Fragment,{children:[Object(Ne.jsx)(Bn,{imgPreview:u[0],loadingPercentage:h,removeOnClick:()=>b([])}),Object(Ne.jsx)(i,{afterIcon:m.d,className:"set-button",preset:"secondary",onClick:function(){c||(l(),f(0),ee({addToPhotos:!0,callback:n=>{let{link:s}=n;ne(`${t?`communities/community${t}`:`users/user${a}`}/info/avatar`).set(s).then((()=>{e(R("change-avatar")),setTimeout((()=>{l(!1),b([]),f(null)}),400)}))},communityId:t,file:u[0].file,setLoadingPercentage:f,userId:a}))},children:"Set as avatar"})]}):Object(Ne.jsxs)(Ne.Fragment,{children:[!t&&o&&Object(Ne.jsx)(He,{afterIcon:m.p,background:!0,iconStyles:{width:"1.15em"},onClick:()=>e(D("choose-photo")),children:"Choose an existing photo"}),Object(Ne.jsxs)("label",{className:"modal-change-avatar__upload",htmlFor:"modal-change-avatar__upload-input",children:[Object(Ne.jsx)(He,{afterIcon:m.M,background:!0,preset:"secondary",onClick:e=>{var t;return null===(t=e.target.closest("label"))||void 0===t?void 0:t.click()},children:"Upload photo"}),Object(Ne.jsx)("input",{className:"modal-change-avatar__upload-input",id:"modal-change-avatar__upload-input",type:"file",accept:".jpg, .jpeg, .png",hidden:!0,onChange:d})]})]})}):null}function Wt(){const e=Object(r.b)(),t=ge((e=>e.modal.currentModal)),n=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),a=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.photos})),o=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.profilePhotos})),i=Object(s.useRef)(!1),[c,l]=Object(s.useState)([]);return Object(s.useEffect)((()=>{const e=[];Object.keys({...o}).forEach((t=>e.push(null===a||void 0===a?void 0:a[t]))),e.includes(void 0)||l(e.sort(((e,t)=>t.date-e.date)))}),[a,o]),"choose-photo"===t&&(i.current=!0),i.current?Object(Ne.jsxs)("div",{className:"modal-choose-photo__photos",children:[Object(Ne.jsx)("div",{className:"photos__header",children:Object(Ne.jsx)("h4",{className:"photos__title",children:`Your photos (${c.length})`})}),Object(Ne.jsx)("div",{className:"photos__items",children:c.map((t=>Object(Ne.jsx)("button",{className:"photos__item",onClick:()=>{return s=t.src,K(n,s),e(R("choose-photo")),void e(R("change-avatar"));var s},children:Object(Ne.jsx)("img",{className:"photos__item-img",src:t.src,alt:""})},t.id)))})]}):null}function Kt(){const e=Object(r.b)(),t=ge((e=>e.modal.currentModal)),n=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),{formState:{errors:a},handleSubmit:o,register:i,reset:c}=Object(Je.a)(),{AsyncButton:l,buttonLoadingRef:d,setButtonLoading:u}=ke(),m=Object(s.useRef)(!1);return"create-community"===t&&(m.current=!0),m.current?Object(Ne.jsxs)(st,{onSubmit:o((function(t){if(!d.current){u(),t=H(t);for(const e in t)t[e]||(t[e]=null);ne("contentData/nextCommunityId").once((s=>{const a={fullInfo:{creationTime:I,description:t.description},info:{avatar:"img/community-default.svg",creatorId:n,id:s,shortDescription:t.shortDescription,title:t.title}};ne().update({["communities/community"+s]:a,"contentData/nextCommunityId":`${parseInt(s,10)+1}`}).then((()=>{e(R("create-community")),setTimeout((()=>{c(),u(!1)}),400)}))}))}})),children:[Ze.filter((e=>["title","description","shortDescription"].includes(e.id))).map((e=>Object(Ne.jsx)(Et,{opts:{obj:e,errors:a,placeholder:!0,register:i}},e.id))),Object(Ne.jsx)(l,{testId:"create-community-btn",type:"submit",children:"Create community"})]}):null}var Qt=n(136),Jt=n(131),Zt=n(132),Xt=n(133),Gt=n(134),en=n(137),tn=n(135);function nn(){const e=Object(r.b)(),t=ge((e=>e.modal.gallery)),n=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.admin})),a=ge((e=>{var t,n;return null===(t=e.user)||void 0===t||null===(n=t.info)||void 0===n?void 0:n.avatar})),o=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),i=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.profilePhotos})),c=Object(s.useRef)(null),l=Object(s.useRef)(null),[d,u]=Object(s.useState)(),[b,j]=Object(s.useState)();Object(s.useEffect)((()=>{d&&b&&(d.params.navigation.prevEl=c.current,d.params.navigation.nextEl=l.current,d.controller.control=b,b.controller.control=d)}),[d,b]),Object(s.useEffect)((()=>{t&&d&&(d[t.content.length>1?"enable":"disable"](),d.update(),d.slideToLoop(t.initialSlide,0))}),[t,d]);const h=()=>e(R("gallery"));if(!t)return null;return Object(Ne.jsxs)(Ne.Fragment,{children:[Object(Ne.jsxs)(en.a,{className:"gallery-swiper__container",autoHeight:!0,keyboard:!0,navigation:{prevEl:c.current,nextEl:l.current},onBeforeInit:e=>{e.params.navigation.prevEl=c.current,e.params.navigation.nextEl=l.current},onSwiper:u,pagination:{type:"fraction"},speed:600,children:[t.content.map((s=>{var r;return Object(Ne.jsxs)(tn.a,{className:"gallery-swiper__slide",children:[Object(Ne.jsx)("div",{className:"modal-gallery__img-container",children:Object(Ne.jsx)("img",{className:"modal-gallery__img",src:s.src,alt:""})}),Object(Ne.jsxs)("div",{className:"modal-gallery__info",children:[Object(Ne.jsx)(Hn,{avatarSize:"small",bottomText:A(s.date),className:"user",community:!!(null===(r=t.authorInfo)||void 0===r?void 0:r.title),linksOnClick:h,userInfo:t.authorInfo}),Object(Ne.jsxs)("div",{className:"modal-gallery__info-buttons",children:[t.authorInfo.id===o&&s.src!==a&&(null===i||void 0===i?void 0:i[s.id])&&Object(Ne.jsx)(He,{background:!0,beforeIcon:m.N,preset:"secondary",onClick:()=>{return e=s.src,K(o,e),void h();var e},children:"Set as avatar"}),(t.authorInfo.id===o||t.authorInfo.creatorId&&t.authorInfo.creatorId===o||n)&&Object(Ne.jsx)(He,{background:!0,beforeIcon:m.K,preset:"remove",onClick:()=>(n=>{const s=t.authorInfo.title,a=(s?"communities/community":"users/user")+t.authorInfo.id;e(D("action-confirm",{actionConfirm:{callback:()=>{ne().update({[`${a}/photos/${n.id}`]:null,[`${a}/profilePhotos/${n.id}`]:null,...t.authorInfo.avatar===n.src&&{[`${a}/info/avatar`]:`img/${s?"community":"user"}-default.svg`}}).then((()=>e(v("Photo deleted.",m.F)))),C.delete(n.src),h()},irreversible:!0,text:"Are you sure you want to delete this photo?"}}))})(s),children:"Delete photo"})]})]})]},s.id)})),Object(Ne.jsx)("button",{className:"gallery-swiper__button-prev swiper-button-prev",ref:c,children:Object(Ne.jsx)(m.f,{})}),Object(Ne.jsx)("button",{className:"gallery-swiper__button-next swiper-button-next",ref:l,children:Object(Ne.jsx)(m.g,{})})]}),Object(Ne.jsx)(en.a,{breakpoints:{768:{slidesPerView:6}},centeredSlides:!0,className:"gallery-thumbs__container",onSwiper:j,slidesPerView:4,slideToClickedSlide:!0,spaceBetween:10,speed:600,children:t.content.map((e=>Object(Ne.jsx)(tn.a,{className:"gallery-thumbs__slide",children:Object(Ne.jsx)("button",{className:"gallery-thumbs__slide-button",children:Object(Ne.jsx)("img",{className:"gallery-thumbs__slide-img",src:e.src,alt:""})})},e.id)))})]})}let sn;function an(){const e=Object(r.b)(),{formState:{errors:t},handleSubmit:n,register:a}=Object(Je.a)(),{AsyncButton:o,buttonLoadingRef:i,setButtonLoading:c}=ke(),[l,d]=Object(s.useState)({});const u={errors:t,placeholder:!0,register:a};return Object(Ne.jsxs)(st,{noValidate:!0,onChange:()=>c(!1),onSubmit:n((function(t){var n;i.current||(c(),t=H(t),null===(n=sn)||void 0===n||n(),sn=ne("users").orderByChild("account/email").equalTo(t.email.toLowerCase()).on((n=>{if(sn(),!i.current)return;const s=function(e){const t={...l};return e.password!==e.confirmPassword&&(t.wrongConfirmPassword=!0),d(t),t}(t);n&&(d({...s,emailExists:!0}),s.emailExists=!0),Object.values(s).includes(!0)?c(!1):ne("contentData/nextUserId").once((async n=>{t.confirmPassword=null;const s=await se(),a={account:{email:t.email.toLowerCase(),id:n,password:g(t.password,n),preferences:{darkTheme:!!X()||null},registrationData:{date:I,location:s}},info:{avatar:"img/user-default.svg",gender:t.gender,id:n,lastName:t.lastName,lastSeen:I,name:t.name}};ne().update({["users/user"+n]:a,"contentData/nextUserId":`${parseInt(n,10)+1}`}).then((()=>{e(R("sign-up")),setTimeout((()=>{e(he(a)),e(ft())}),400)}))}))})))})),children:[Object(Ne.jsx)(Et,{opts:{obj:Ze.find((e=>"name"===e.id)),...u}}),Object(Ne.jsx)(Et,{opts:{obj:Ze.find((e=>"lastName"===e.id)),...u}}),Object(Ne.jsx)(rt,{register:a}),Object(Ne.jsx)(Et,{onInput:()=>d({...l,emailExists:!1}),opts:{obj:Ze.find((e=>"email"===e.id)),...u}}),l.emailExists&&Object(Ne.jsx)("p",{className:"error-text",children:"This email is already used."}),Ze.filter((e=>["password","confirmPassword"].includes(e.id))).map((e=>Object(Ne.jsx)(Et,{onInput:()=>d({...l,wrongConfirmPassword:!1}),opts:{obj:e,...u}},e.id))),l.wrongConfirmPassword&&Object(Ne.jsx)("p",{className:"error-text",children:"Wrong confirm password."}),Object(Ne.jsx)(o,{testId:"sign-up-btn",type:"submit",children:"Sign up"})]})}function on(){const e=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id}));return Object(Ne.jsxs)("div",{children:[Object(Ne.jsx)(Ht,{contentClass:"modal-gallery__content",modalName:"gallery",children:Object(Ne.jsx)(nn,{})}),e?Object(Ne.jsxs)(Ne.Fragment,{children:[Object(Ne.jsx)(Ht,{contentClass:"modal-create-community__content",modalName:"create-community",children:Object(Ne.jsx)(Kt,{})}),Object(Ne.jsx)(Ht,{contentClass:"modal-change-avatar__content",modalName:"change-avatar",children:Object(Ne.jsx)(Vt,{})}),Object(Ne.jsx)(Ht,{modalName:"choose-photo",children:Object(Ne.jsx)(Wt,{})}),Object(Ne.jsx)(Ht,{modalName:"action-confirm",testId:"action-confirm-modal",children:Object(Ne.jsx)(Ut,{})}),Object(Ne.jsx)(Ht,{modalName:"action-error",children:Object(Ne.jsx)(Yt,{})}),Object(Ne.jsx)(Ht,{contentClass:"modal-zoom__content",modalName:"zoom",zoomImg:!0})]}):Object(Ne.jsx)(Ht,{contentClass:"modal-sign-up__content",modalName:"sign-up",children:Object(Ne.jsx)(an,{})})]})}Qt.a.use([Jt.a,Zt.a,Xt.a,Gt.a]);var rn=n(60),cn=n.n(rn);function ln(){const e=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id}));return e?Object(Ne.jsx)("nav",{className:cn.a.container+" navigation",children:Object(Ne.jsx)("div",{className:cn.a.wrapper+" navigation__wrapper",children:[{icon:m.N,testId:"nav-profile",text:"My Profile",to:"/id"+e},{icon:m.s,text:"News",to:"/news"},{icon:m.j,testId:"nav-messages",text:"Messages",to:"/messages"},{icon:m.O,text:"Friends",to:"/friends"},{icon:m.S,testId:"nav-communities",text:"Communities",to:"/communities"},{icon:m.p,text:"Photos",to:"/photos"},{icon:m.b,text:"Bookmarks",to:"/bookmarks"}].map((e=>Object(Ne.jsxs)(i.b,{className:cn.a.link,to:e.to,children:[Object(Ne.jsx)(e.icon,{className:cn.a.link_icon}),Object(Ne.jsx)("p",{children:e.text})]},e.text)))})}):null}var dn=n(21),un=n.n(dn);function mn(e){let{comment:t,postId:n,replyComment:a,selectedReply:o,setReplyComment:i,setSelectedReply:c,uploadCallback:l}=e;const d=Object(r.b)(),b=Ce(),j=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.admin})),h=ge((e=>{var t,n;return null===(t=e.user)||void 0===t||null===(n=t.info)||void 0===n?void 0:n.avatar})),f=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),[p,O]=Object(s.useState)(),[x,g]=Object(s.useState)([]),[_,y]=Object(s.useState)([]);Object(s.useEffect)((()=>g(Object.values({...t.replies}))),[t.replies]),Object(s.useEffect)((()=>{const e=oe({callback:O,fields:["info","photos"],userId:t.authorId}),n=[],s=[];return x.forEach(((e,t)=>{n.push(oe({callback:e=>{s[t]=e,s.length!==x.length||s.includes(void 0)||y([...s])},fields:["info","photos"],userId:e.authorId}))})),()=>{e(),n.forEach((e=>e()))}}),[t.authorId,x]);const N=e=>{var t;null===(t=document.querySelector("#"+e))||void 0===t||t.scrollIntoView({behavior:"auto",block:"center"}),c(e),setTimeout((()=>c(null)),0)},w=e=>{var s;let{replies:r,replyTo:c,tempAuthor:O,tempComment:g}=e;return Object(Ne.jsxs)("div",{className:un.a.container,id:g.id,children:[Object(Ne.jsx)(De,{src:O.info.avatar,userId:O.info.id}),Object(Ne.jsxs)("div",{className:Object(u.a)(un.a.wrapper,g.id===o&&un.a.wrapper_selected),children:[Object(Ne.jsx)(Le,{className:"authorInfo",text:A(g.date),userInfo:O.info}),Object(Ne.jsx)(Gn,{author:O,className:"userMessage",content:g.content,renderReplyToAuthorText:g.replyTo?()=>(e=>{var t;return c&&Object(Ne.jsxs)("button",{className:un.a.replyTo,onClick:()=>N(e),children:[Object(Ne.jsx)("span",{className:un.a.replyTo_name,children:null===(t=_.find((e=>{var t;return e.info.id===(null===(t=x.find((e=>e.id===g.replyTo)))||void 0===t?void 0:t.authorId)})))||void 0===t?void 0:t.info.name}),", "]})})(g.replyTo):void 0}),Object(Ne.jsxs)("div",{className:un.a.footer,children:[Object(Ne.jsxs)("button",{className:un.a.footer_button,onClick:function(e){var s;let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!r&&g.id;return Y({condition:!!(null===(s=g.likes)||void 0===s?void 0:s["user"+f]),contentId:t.id,contentPath:`posts/post${n}/comments/${t.id}${a?`/replies/${a}`:""}`,redirect:b,userId:f,userPath:`comments/post${n}/${a?`reply${a}`:`comment${t.id}`}`})},children:[(null===(s=g.likes)||void 0===s?void 0:s["user"+f])?Object(Ne.jsx)(m.o,{className:un.a.footer_button_icon}):Object(Ne.jsx)(m.B,{className:un.a.footer_button_icon}),Object(Ne.jsx)("p",{className:un.a.footer_button_text,children:g.likeCounter||0})]}),Object(Ne.jsxs)("button",{className:un.a.footer_button,onClick:()=>{return e=g,void(f?i({author:_.find((t=>t.info.id===e.authorId))||p,commentId:t.id,reply:e}):b());var e},children:[Object(Ne.jsx)(m.H,{className:un.a.footer_button_icon,style:{width:"1.01em"}}),Object(Ne.jsx)("p",{className:un.a.footer_button_text,children:"reply"})]}),(O.info.id===f||j)&&Object(Ne.jsxs)("button",{className:un.a.footer_deleteButton,onClick:()=>{return e=r?"":g.id,d(D("action-confirm",{actionConfirm:{callback:()=>ne(`posts/post${n}/comments/${t.id}${e?`/replies/${e}`:""}`).remove().then((()=>d(v("Comment deleted.",m.F)))),irreversible:!0,text:"Are you sure you want to delete this comment?"}}));var e},children:[Object(Ne.jsx)(m.F,{className:un.a.footer_button_icon,style:{width:".9em"}}),Object(Ne.jsx)("p",{className:un.a.footer_button_text,children:"Delete"})]})]}),(null===r||void 0===r?void 0:r.length)>0&&Object(Ne.jsx)("div",{className:un.a.replies,children:r}),(null===a||void 0===a?void 0:a.commentId)===t.id&&r&&Object(Ne.jsx)(gn,{avatar:h,buttonText:"Reply",inputPlaceholder:"Leave a comment",uploadCallback:l(t.id,a.reply.id),userId:f,children:Object(Ne.jsxs)("button",{className:"postMsg_form_replyTo",type:"button",onClick:()=>N(a.reply.id),children:[Object(Ne.jsx)("p",{className:"postMsg_form_replyTo_text",children:`reply to ${a.author.info.name} ${a.author.info.lastName}`}),Object(Ne.jsx)(m.q,{className:"postMsg_form_replyTo_icon",style:{width:".62em"}})]})})]})]},g.id)};return p?w({tempAuthor:p,tempComment:t,replies:x.map(((e,t)=>_[t]&&w({tempAuthor:_[t],tempComment:e,replyTo:_.find((t=>{var n;return t.info.id===(null===(n=x.find((t=>t.id===e.replyTo)))||void 0===n?void 0:n.authorId)}))})))}):null}var bn=n(61),jn=n.n(bn);function hn(e){let{post:t}=e;const{hash:n}=Object(ye.useLocation)(),a=ge((e=>{var t,n;return null===(t=e.user)||void 0===t||null===(n=t.info)||void 0===n?void 0:n.avatar})),o=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),r=Object(s.useRef)(null),[i,c]=Object(s.useState)(null),[l,d]=Object(s.useState)(null),u=Object(s.useCallback)((()=>{var e;return null===(e=r.current)||void 0===e?void 0:e.scrollIntoView({behavior:"auto",block:"start"})}),[]);Object(s.useEffect)((()=>"#comments"===n&&setTimeout(u,0)),[n,u]);const m=(e,n)=>s=>{const a=ne().newKey(),r=e?`/${e}/replies`:"";return ne(`posts/post${t.id}/comments${r}/${a}`).set({authorId:o,content:s,date:I,id:a,replyTo:n||null}).then((()=>{c(null),!n&&setTimeout(u,0)}))},b=Object.values({...t.comments}).sort(((e,t)=>t.date-e.date));return Object(Ne.jsx)("div",{ref:r,className:jn.a.container,children:Object(Ne.jsxs)("div",{className:jn.a.innerContainer,children:[Object(Ne.jsx)("div",{className:jn.a.title,children:`Comments (${b.length})`}),Object(Ne.jsx)("div",{className:jn.a.wrapper,children:b.map((e=>Object(Ne.jsx)(mn,{comment:e,postId:t.id,replyComment:i,selectedReply:l,setReplyComment:c,setSelectedReply:d,uploadCallback:m},e.id)))}),o&&Object(Ne.jsx)(gn,{avatar:a,buttonText:"Comment",inputPlaceholder:"Leave a comment",uploadCallback:m(),userId:o})]})})}var fn=n(17),vn=n.n(fn);function pn(e){var t,n,o;let{fetchedItems:c,index:l=0,loadingCallback:d,post:b,renderComments:j}=e;const h=Object(r.b)(),f=Ce(),p=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.admin})),O=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),g=Object(s.useRef)(null),[_,y]=Object(s.useState)(),[N,w]=Object(s.useState)(),[k,C]=Object(s.useState)();Object(s.useEffect)((()=>{if(null===O)return;let e,t,n;const s=()=>{b.shareOrigin?e&&void 0!==t&&n&&(Object(a.unstable_batchedUpdates)((()=>{C(e),w(t),y(n)})),c.current.incrementQty(b.id,d)):e&&(C(e),c.current.incrementQty(b.id,d))},o=oe({callback:t=>{e=t,s()},community:!!b.communityId,fields:b.shareOrigin?void 0:["info","photos"],userId:b.authorId||b.communityId});let r;const i=b.shareOrigin?ne("posts/post"+b.shareOrigin).on((e=>{e?(n=e,r=oe({callback:e=>{t=e,s()},community:!!e.communityId,fields:["info","photos"],userId:e.authorId||e.communityId})):(t=null,n={deleted:!0},s())})):void 0;return()=>{var e;o(),null===(e=r)||void 0===e||e(),null===i||void 0===i||i()}}),[c,d,b.authorId,b.communityId,b.id,b.shareOrigin,O]);const S=null===(t=b.views)||void 0===t?void 0:t["user"+O];return Object(s.useEffect)((()=>{if(!(null===k||void 0===k?void 0:k.info.id)||!O||S)return;let e;const t=new IntersectionObserver((t=>{let[n]=t;n.isIntersecting?e=setTimeout((()=>{const e=`posts/post${b.id}/`;ne().update({[`${e}viewCounter`]:Object(x.e)(1),[`${e}views/user${O}`]:{date:I,userId:O}})}),5e3):clearInterval(e)}),{threshold:.5});return t.observe(g.current),()=>{t.disconnect(),clearTimeout(e)}}),[b.id,null===k||void 0===k?void 0:k.info.id,S,O]),k?Object(Ne.jsxs)("article",{className:Object(u.a)(vn.a.container,"post"),ref:g,children:[Object(Ne.jsxs)("div",{className:vn.a.main,children:[Object(Ne.jsx)(Hn,{bottomText:A(b.date),bottomTextLink:"/post"+b.id,community:!!b.communityId,userInfo:k.info,children:Object(Ne.jsx)(Ee,{bookmarkType:"post",itemId:b.id,children:(k.info.id===O||k.info.creatorId&&k.info.creatorId===O||p)&&Object(Ne.jsx)(He,{background:!0,testId:"delete-post-btn",onClick:function(){h(D("action-confirm",{actionConfirm:{callback:()=>ne("posts/post"+b.id).remove().then((()=>h(v("Post deleted.",m.F)))),irreversible:!0,text:"Are you sure you want to delete this post?"}}))},children:"Delete post"})})}),_?Object(Ne.jsx)("div",{className:vn.a.origin,children:_.deleted?Object(Ne.jsx)("p",{className:vn.a.origin_deleted,children:"Shared post deleted"}):Object(Ne.jsxs)("div",{className:vn.a.origin_content,children:[Object(Ne.jsx)(Hn,{bottomText:A(_.date),bottomTextLink:"/post"+_.id,community:!!_.communityId,userInfo:N.info}),Object(Ne.jsx)(Gn,{author:N,className:"userMessage",content:_.content||_.content,lazy:!0,msgIndex:l})]})}):Object(Ne.jsx)(Gn,{author:k,className:"userMessage",content:b.content,lazy:!0,msgIndex:l}),Object(Ne.jsxs)("div",{className:vn.a.footer,children:[Object(Ne.jsxs)("div",{className:vn.a.footer_buttons,children:[Object(Ne.jsxs)("button",{"aria-label":(null===(n=b.likes)||void 0===n?void 0:n["user"+O])?"Dislike":"Like",className:vn.a.footer_button,onClick:()=>{var e;return Y({condition:!!(null===(e=b.likes)||void 0===e?void 0:e["user"+O]),contentId:b.id,contentPath:`posts/post${b.id}`,redirect:f,userId:O,userPath:`posts/post${b.id}`})},children:[(null===(o=b.likes)||void 0===o?void 0:o["user"+O])?Object(Ne.jsx)(m.o,{className:vn.a.footer_item_icon,"aria-label":"Likes"}):Object(Ne.jsx)(m.B,{className:vn.a.footer_item_icon,"aria-label":"Likes"}),Object(Ne.jsx)("p",{className:vn.a.footer_item_text,children:b.likeCounter||0})]}),Object(Ne.jsxs)(i.b,{className:vn.a.footer_button,to:`/post${b.id}#comments`,children:[Object(Ne.jsx)(m.x,{className:vn.a.footer_item_icon,"aria-label":"Comments"}),Object(Ne.jsx)("p",{className:vn.a.footer_item_text,children:Object.keys({...b.comments}).length})]}),Object(Ne.jsxs)("button",{className:vn.a.footer_button,"aria-label":"Share",onClick:function(){O?ne("contentData/nextPostId").once((e=>{const t={authorId:O,date:I,id:e,shareOrigin:b.shareOrigin||b.id};ne().update({["posts/post"+e]:t,"contentData/nextPostId":`${parseInt(e,10)+1}`,...!(null===_||void 0===_?void 0:_.deleted)&&{[`posts/post${b.shareOrigin||b.id}/shareCounter`]:Object(x.e)(1)}}).then((()=>h(v("Shared to your wall.",m.E))))})):f()},children:[Object(Ne.jsx)(m.E,{className:vn.a.footer_item_icon,style:{width:"1.1em"},"aria-label":"Shares"}),Object(Ne.jsx)("p",{className:vn.a.footer_item_text,children:b.shareCounter||0})]})]}),Object(Ne.jsxs)("div",{className:vn.a.footer_item,children:[Object(Ne.jsx)(m.n,{className:vn.a.footer_item_icon,style:{width:"1.1em"}}),Object(Ne.jsx)("p",{className:vn.a.footer_item_text,children:b.viewCounter||0})]})]})]}),j&&Object(Ne.jsx)(hn,{post:b})]}):null}var On=n(22),xn=n.n(On);function gn(e){let{addToPhotosButton:t,avatar:n,buttonText:a="Post",children:o,community:r,inputPlaceholder:i="Share your thoughts",mobileSubmit:c,uploadCallback:l,userId:d}=e;const b=r?d:null,j=Object(s.useRef)(),[h,f]=Object(s.useState)([]),{formState:{errors:v},handleSubmit:p,register:O,reset:x,setValue:g}=Object(Je.a)(),{AsyncButton:_,buttonLoading:y,setButtonLoading:N}=ke(),{addImgPreview:w,imgPreview:k,setImgPreview:C}=Ie(),{ref:S,...$}=O("msg",{maxLength:{value:5e3,message:"A message cannot contain more than 5000 characters"}});function E(e){var t;if(y)return;const n=document.activeElement===j.current,s=new Array(k.length).fill(0),a=null===(t=e.msg)||void 0===t?void 0:t.trim(),o=[];if(k.length||a){N(),f(s),k.length||i();const e=e=>{let{id:t,index:n}=e;o[n]=t,o.length!==k.length||o.includes(void 0)||i()};k.forEach(((t,n)=>ee({addToPhotos:t.addToPhotos,callback:e,communityId:b,file:t.file,index:n,setLoadingPercentage:(e,t)=>{s[t]=e,f([...s])},userId:d})))}async function i(){const e={images:o,text:a||null},t=()=>{var e;x(),C([]),f([]),N(!1),n&&(null===(e=j.current)||void 0===e||e.focus())};l?(await l(e),t()):ne("contentData/nextPostId").once((n=>{const s={authorId:r?null:d,communityId:b,content:e,date:I,id:n};ne().update({["posts/post"+n]:s,"contentData/nextPostId":`${parseInt(n,10)+1}`}).then(t)}))}}return Object(Ne.jsxs)("div",{className:Object(u.a)(xn.a.container,"postMsg"),children:[Object(Ne.jsx)(De,{community:r,enablePreview:!1,size:"small",src:n,userId:d}),Object(Ne.jsxs)("form",{className:Object(u.a)(xn.a.form,"postMsg_form"),onSubmit:p(E),children:[Object(Ne.jsxs)("div",{className:Object(u.a)(xn.a.header,"postMsg_header"),children:[o,Object(Ne.jsx)("textarea",{className:Object(u.a)(xn.a.input,y&&xn.a.input_disabled),disabled:y,onKeyPress:function(e){"Enter"!==e.key||e.shiftKey||(e.preventDefault(),g("msg",e.target.value),p(E)())},placeholder:i+"...",ref:e=>{S(e),j.current=e},rows:1,...$}),c&&Object(Ne.jsxs)("button",{className:Object(u.a)(xn.a.mobileSubmit,y&&xn.a.mobileSubmit_loading),children:[y&&Object(Ne.jsx)(Lt,{className:xn.a.mobileSubmit_loading_animation}),Object(Ne.jsx)(m.D,{})]})]}),v.msg&&Object(Ne.jsx)("p",{className:"error-text",children:v.msg.message}),Object(Ne.jsxs)("div",{className:Object(u.a)(xn.a.footer,"postMsg_footer"),children:[Object(Ne.jsxs)("div",{className:xn.a.footer_inputs,children:[Object(Ne.jsxs)("label",{className:Object(u.a)(xn.a.photo,"postMsg_photo"),children:[Object(Ne.jsx)("input",{className:xn.a.photo_input,disabled:y,type:"file",accept:".jpg, .jpeg, .png",multiple:!0,hidden:!0,onChange:w}),Object(Ne.jsx)("button",{"aria-label":"Photo",className:Object(u.a)(xn.a.photo_button,y&&xn.a.photo_button_disabled),type:"button",onClick:e=>e.target.closest("label").click(),children:Object(Ne.jsx)(m.c,{})})]}),Object(Ne.jsx)(_,{className:xn.a.button,testId:"postMsg-btn",type:"submit",children:a})]}),k.length>0&&Object(Ne.jsx)("div",{className:xn.a.uploadPreviews,children:Object(Ne.jsx)("div",{className:xn.a.uploadPreviews_wrapper,children:k.map(((e,n)=>Object(Ne.jsx)(Bn,{addToPhotosHandler:t?e=>function(e,t){C(k.map(((n,s)=>(s===t&&(n.addToPhotos=e.target.checked),n))))}(e,n):void 0,community:r,imgPreview:e,loadingPercentage:h[n],removeOnClick:()=>C(k.filter((t=>t.result!==e.result)))},n)))})})]})]})]})}function _n(){const e=Object(r.b)(),{pathname:t}=Object(ye.useLocation)(),n=ge((e=>e.modal.currentModal)),a=Object(s.useRef)();return a.current=n,Object(s.useEffect)((()=>{a.current&&e(L())}),[e,t]),null}var yn=n(53),Nn=n.n(yn);function wn(){const[e,t]=Object(s.useState)(Nn.a.button_hidden);return Object(s.useEffect)((()=>{const e=setInterval((()=>{t(Object(u.a)(Nn.a.button,window.pageYOffset<window.innerHeight&&Nn.a.button_hidden))}),100);return()=>clearInterval(e)}),[]),Object(Ne.jsx)("div",{className:Nn.a.container,children:Object(Ne.jsx)(Ot,{className:Nn.a.pageWidth,children:Object(Ne.jsx)("button",{className:e,"aria-label":"Scroll to top",onClick:function(){document.body.scrollIntoView({behavior:"smooth",block:"start"})},children:Object(Ne.jsx)(m.h,{})})})})}var kn=n(71),In=n.n(kn);function Cn(e){let{className:t,link:n,onChange:s,onSubmit:a,value:o}=e;const r=n?i.b:"button";return Object(Ne.jsxs)("form",{className:Object(u.a)(In.a.form,t),onSubmit:a,children:[Object(Ne.jsx)("input",{className:In.a.input,name:"search",placeholder:"Search...",type:"text",value:o,onChange:s}),Object(Ne.jsx)(r,{className:In.a.button,to:n&&"/search?query="+encodeURIComponent(o),children:Object(Ne.jsx)(m.I,{})})]})}var Sn=n(93),$n=n.n(Sn);function En(e){let{children:t,className:n}=e;return Object(Ne.jsx)("section",{className:Object(u.a)($n.a.container,n),children:t})}var Tn=n(72),Pn=n.n(Tn);function Ln(e){let{items:t}=e;const{search:n}=Object(ye.useLocation)(),s=t.find((e=>e.to===n))||t[0];return Object(Ne.jsx)("aside",{className:"sidebar",children:Object(Ne.jsx)("div",{className:Object(u.a)(Pn.a.wrapper,"sidebar__wrapper"),children:t.map((e=>Object(Ne.jsx)(i.b,{className:Object(u.a)(Pn.a.button,e===s&&Pn.a.button_active),to:e.to,children:e.text},e.text)))})})}var Rn=n(47),Mn=n.n(Rn);function Dn(){const e=Object(r.b)(),t=ge((e=>e.toast)),n=Object(s.useRef)(""),[a,o]=Object(s.useState)(!1);Object(s.useEffect)((()=>{if(!t)return;let s,a;n.current="0s",o(!1);const r=setTimeout((()=>{n.current="",o(!0),s=setTimeout((()=>{o(!1),a=setTimeout((()=>e(h())),400)}),2500)}),10);return()=>{clearTimeout(r),clearTimeout(s),clearTimeout(a)}}),[e,t]);const i=null===t||void 0===t?void 0:t.icon;return Object(Ne.jsx)(Ot,{className:Mn.a.pageWidth,children:Object(Ne.jsx)("div",{className:Object(u.a)(Mn.a.wrapper,a&&Mn.a.wrapper_open),style:{transitionDuration:n.current},children:Object(Ne.jsxs)("div",{className:Mn.a.innerWrapper,children:[i&&Object(Ne.jsx)(i,{className:Mn.a.icon}),Object(Ne.jsx)("p",{className:Mn.a.text,children:null===t||void 0===t?void 0:t.msg})]})})})}var qn=n(24),An=n.n(qn);function Bn(e){let{addToPhotosHandler:t,community:n,imgPreview:s,loadingPercentage:a,removeOnClick:o}=e;const i=Object(r.b)(),c=Number.isInteger(a);return Object(Ne.jsxs)("div",{className:Object(u.a)(An.a.container,"upload-preview"),children:[Object(Ne.jsxs)("div",{className:An.a.header,children:[!c&&Object(Ne.jsx)("button",{className:An.a.header_remove,type:"button","aria-label":"Remove photo",onClick:o,children:"\xd7"}),Object(Ne.jsxs)("button",{className:An.a.header_imgContainer,onClick:()=>i(D("zoom",{zoom:{img:s.result,alt:""}})),type:"button",children:[Object(Ne.jsx)("img",{className:Object(u.a)(An.a.header_img,"upload-preview__header-img"),src:s.result,alt:""}),c&&Object(Ne.jsxs)("div",{className:An.a.header_overlay,children:[Object(Ne.jsx)("div",{className:An.a.header_overlay_loading,style:{width:a+"%"}}),Object(Ne.jsx)("p",{className:An.a.header_overlay_text,children:a+"%"})]})]})]}),Object(Ne.jsx)("div",{className:An.a.footer,children:Object(Ne.jsxs)("div",{className:An.a.footer_wrapper,children:[Object(Ne.jsx)("h4",{className:Object(u.a)(An.a.title,An.a.footer_item),children:s.props.name}),t&&Object(Ne.jsxs)("label",{className:Object(u.a)(An.a.checkbox,An.a.footer_item),children:[Object(Ne.jsx)("input",{className:An.a.checkbox_input,disabled:c,type:"checkbox",name:"checkbox",onChange:t}),Object(Ne.jsx)("p",{className:An.a.checkbox_text,children:`Add to ${n?"community":"my"} photos`})]})]})})]})}var Fn=n(62),zn=n.n(Fn);function Hn(e){let{avatarSize:t="medium",bottomText:n,bottomTextLink:s,children:a,childrenBottom:o,className:r,community:c,enableAvatarPreview:l,linksOnClick:d,userInfo:m,wrapperLink:b}=e;const j=b?i.b:"div";return Object(Ne.jsxs)("div",{className:Object(u.a)(zn.a.container,r),children:[Object(Ne.jsx)(De,{community:c,enablePreview:l,size:t,src:m.avatar,userId:m.id,onClick:d}),Object(Ne.jsxs)(j,{className:Object(u.a)(zn.a.wrapper,r&&r+"_wrapper"),to:b,children:[Object(Ne.jsxs)("div",{className:Object(u.a)(zn.a.header,r&&r+"_header"),children:[Object(Ne.jsx)(Le,{className:"authorInfo",community:c,nameIsLink:!b,text:n,textLink:s,userInfo:m,onClick:d}),a]}),o&&Object(Ne.jsx)("div",{className:Object(u.a)(zn.a.bottom,r&&r+"_bottom"),children:o})]})]})}var Un=n(94),Yn=n.n(Un),Vn=n(95),Wn=n.n(Vn);const Kn=Object(s.createContext)(null);function Qn(e){let{autoCheck:t=!0,autoCheckInterval:n=2e3,className:a,scrollOffset:o=0,Tag:r="div",...i}=e;const c=Object(s.useCallback)((()=>d(!0)),[]),[l,d]=Object(s.useState)(!1);return Object(Ne.jsx)(Kn.Provider,{value:{autoCheck:t,autoCheckInterval:n,loadItem:c,scrollOffset:o},children:Object(Ne.jsx)(r,{...i,className:Object(u.a)(a,!l&&Wn.a.container)})})}function Jn(e){let{alt:t,src:n,...a}=e;const{autoCheck:o,autoCheckInterval:r,loadItem:i,scrollOffset:c}=Object(s.useContext)(Kn),l=Object(s.useRef)(),d=Object(s.useRef)(null),u=Object(s.useRef)(!1),[m,b]=Object(s.useState)({src:"#",alt:""}),j=Object(s.useCallback)((()=>{window.removeEventListener("load",h),window.removeEventListener("resize",h),window.removeEventListener("scroll",h),clearInterval(l.current)}),[]),h=Object(s.useCallback)((()=>{if(!d.current)return;const e=d.current,s=e.getBoundingClientRect().top+window.pageYOffset+c-window.innerHeight;window.pageYOffset>=s&&e.offsetParent&&"hidden"!==getComputedStyle(e).visibility&&(u.current=!0,b({src:n,alt:t||""}),j())}),[t,j,c,n]);return Object(s.useEffect)((()=>(u.current||(h(),window.addEventListener("load",h),window.addEventListener("resize",h),window.addEventListener("scroll",h),o&&(l.current=setInterval(h,r))),j)),[o,r,h,j]),Object(Ne.jsx)("img",{...a,...m,ref:d,onLoad:i})}var Zn=n(27),Xn=n.n(Zn);function Gn(e){var t;let{author:n,className:a,content:o,lazy:c,linkStopPropagation:l,msgIndex:d,renderReplyToAuthorText:m}=e;const b=Object(r.b)(),j=Object(s.useRef)(null),[h,f]=Object(s.useState)(!1),[v,p]=Object(s.useState)(!1),O=(null===(t=o.images)||void 0===t?void 0:t.map((e=>Object.values({...n.photos}).find((t=>t.id===e)))))||[],x=O.filter((e=>e));Object(s.useEffect)((()=>{const e=()=>{var e,t;return!v&&f((null===(e=j.current)||void 0===e?void 0:e.scrollHeight)>(null===(t=j.current)||void 0===t?void 0:t.offsetHeight))};return e(),window.addEventListener("loadFinished",e),window.addEventListener("resize",e),()=>{window.removeEventListener("loadFinished",e),window.removeEventListener("resize",e)}}),[v]);const g=(e,t)=>{e.preventDefault(),l&&e.stopPropagation(),b(D("gallery",{gallery:{authorInfo:n.info,content:x,initialSlide:x.indexOf(x.find((e=>e.id===t)))}}))};return Object(Ne.jsxs)("div",{className:Object(u.a)(Xn.a.container,a),children:[o.text&&Object(Ne.jsx)(Yn.a,{componentDecorator:(e,t,n)=>Object(Ne.jsx)("a",{className:Xn.a.text_link,href:e,rel:"noreferrer",target:"_blank",onClick:e=>e.stopPropagation(),children:t},n),children:Object(Ne.jsxs)("div",{className:Object(u.a)(Xn.a.item,Xn.a.textContainer,a&&a+"_textContainer"),children:[Object(Ne.jsxs)("p",{className:Object(u.a)(Xn.a.text,a&&a+"_text"),ref:j,style:{display:v?"block":""},children:[null===m||void 0===m?void 0:m(),o.text]}),h&&Object(Ne.jsx)("div",{className:Object(u.a)(Xn.a.text_showMore,a&&a+"_text_showMore"),role:"button",tabIndex:0,onClick:e=>{e.stopPropagation(),p(!v)},onKeyPress:e=>{["Enter"," "].includes(e.key)&&(e.preventDefault(),e.target.click())},children:v?"Show less":"Show more"})]})}),O.map(((e,t)=>Object(Ne.jsx)(s.Fragment,{children:e?!c||d<4?Object(Ne.jsx)(i.b,{className:Object(u.a)(Xn.a.item,Xn.a.imgContainer,a&&a+"_imgContainer"),to:"#javascript",onClick:t=>g(t,e.id),children:Object(Ne.jsx)("img",{className:Xn.a.img,src:e.src,alt:""})}):Object(Ne.jsx)(Qn,{className:Object(u.a)(Xn.a.item,Xn.a.imgContainer,Xn.a.lazy,a&&a+"_imgContainer"),onClick:t=>g(t,e.id),scrollOffset:-1e3,Tag:i.b,to:"#javascript",children:Object(Ne.jsx)(Jn,{className:Xn.a.img,src:e.src,alt:""})}):Object(Ne.jsx)("p",{className:Object(u.a)(Xn.a.item,Xn.a.deletedPhoto),children:"Deleted photo"})},t)))]})}function es(){const e=Object(r.b)(),t=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id}));return Object(s.useEffect)((()=>{if(!t)return;const e="users/user"+t;let n;const s=ne(".info/connected").on((t=>{t&&(n&&Object(x.m)(n),n=ne(e+"/connections").push(),Object(x.o)(n,!0),Object(x.f)(n).remove(),ne(e+"/info/lastSeen").onDisconnect().set(I))}));return()=>{Object(x.m)(n),ne(e+"/info/lastSeen").onDisconnect().cancel(),ne(e+"/info/lastSeen").set(I),s()}}),[e,t]),Object(s.useEffect)((()=>{const t=()=>e(ft());return t(),window.addEventListener("storage",t),()=>window.removeEventListener("storage",t)}),[e]),null}var ts=n(73),ns=n.n(ts);function ss(e){let{button:t,requestDate:n,singleUser:s,users:a}=e;const o=Object(r.b)(),i=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),c=e=>Object(Ne.jsx)("div",{className:ns.a.item,children:Object(Ne.jsx)(Hn,{bottomText:n?A(n):U(e),childrenBottom:Object(Ne.jsxs)(Ne.Fragment,{children:["bookmarks"===t&&!n&&Object(Ne.jsx)(He,{background:!0,className:ns.a.button,onClick:()=>(e=>ne(`users/user${i}/bookmarks/users/user${e.info.id}`).remove().then((()=>o(v("Item removed from bookmarks.",m.v)))))(e),children:"Remove from bookmarks"}),n&&Object(Ne.jsx)(He,{background:!0,className:ns.a.button,onClick:()=>B({reqUserId:e.info.id,userId:i}),children:"Accept friend request"})]}),className:"user",userInfo:e.info})},e.info.id);return s?c(s):Object(Ne.jsx)("div",{className:"usersList",children:a.map((e=>c(e)))})}var as=n(54),os=n.n(as);function rs(){var e;const t=Object(r.b)(),{search:n}=Object(ye.useLocation)(),a=new URLSearchParams(n).get("tab"),o=Ce(),i=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.bookmarks})),c=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),l=["communities","users"].find((e=>e===a))||"posts",d=Object(s.useRef)(),[u,b]=Object(s.useState)([]),{fetchedItems:j,finishLoading:h}=we(),f=Object(s.useCallback)((()=>h("Bookmarks")),[h]);Object(s.useEffect)((()=>{if(void 0===c&&o(),!c)return;const e=Object.values({...null===i||void 0===i?void 0:i[l]}).sort(((e,t)=>t.date-e.date));e.length||(f(),b([]));const t=[],n=[],s=(t,s,a)=>{n[a]=t||{id:s.id,unavailable:!0},n.length!==e.length||n.includes(void 0)||(b([...n]),["users","communities"].includes(l)?f():j.current.setExpected(n.length,f)),!t&&j.current.incrementQty(s.id,f)};return e.forEach(((e,n)=>{["communities","users"].includes(l)?t.push(oe({callback:t=>s(t,e,n),community:"communities"===l,fields:"communities"===l?["fullInfo","info"]:["connections","info"],userId:e.id})):t.push(ne("posts/post"+e.id).on((t=>s(t,e,n))))})),()=>t.forEach((e=>e()))}),[l,j,f,o,i,c]),Object(s.useEffect)((()=>d.current=l),[l]);const p=u.filter((e=>!e.unavailable)),O=null===(e=u.filter((e=>e.unavailable)))||void 0===e?void 0:e.length;return Object(Ne.jsxs)(En,{className:os.a.container,children:[Object(Ne.jsxs)(Qe,{children:[Object(Ne.jsxs)("div",{className:os.a.header,children:[Object(Ne.jsx)("h1",{className:os.a.header_title,children:`${l} bookmarks (${u.length})`}),O>0&&Object(Ne.jsxs)("p",{className:os.a.header_unavailable,children:[O+" unavailable item(s) are hidden ",Object(Ne.jsx)("button",{className:os.a.header_unavailable_remove,onClick:()=>{const e="communities"===l?"community":l.slice(0,-1);ne().update(u.reduce(((t,n)=>(n.unavailable&&(t[`users/user${c}/bookmarks/${l}/${e+n.id}`]=null),t)),{})).then((()=>t(v("Unavailable bookmarks removed.",m.v))))},children:"(Remove)."})]})]}),l===d.current&&("posts"===l?p.map(((e,t)=>Object(Ne.jsx)(pn,{fetchedItems:j,index:t,loadingCallback:f,post:e},e.id))):"users"===l?Object(Ne.jsx)(ss,{button:"bookmarks",users:p}):Object(Ne.jsx)(Ve,{communitiesInfo:p.map((e=>e.info))}))]}),Object(Ne.jsx)(Ln,{items:[{text:`Posts (${Object.keys({...null===i||void 0===i?void 0:i.posts}).length})`,to:"/bookmarks"},{text:`Users (${Object.keys({...null===i||void 0===i?void 0:i.users}).length})`,to:"?tab=users"},{text:`Communities (${Object.keys({...null===i||void 0===i?void 0:i.communities}).length})`,to:"?tab=communities"}]})]})}var is=n(35),cs=n.n(is);function ls(){const e=Object(r.b)(),t=Ce(),n=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),[o,i]=Object(s.useState)([]),[c,l]=Object(s.useState)(),[d,u]=Object(s.useState)([]),{finishLoading:m}=we();return Object(s.useEffect)((()=>{if(null!==n)return ne("communities").on((e=>{m("Communities");const t=Object.values({...e}),s=t.filter((e=>e.info.creatorId!==n));Object(a.unstable_batchedUpdates)((()=>{i(t.filter((e=>e.info.creatorId===n))),l(s.filter((e=>{var t;return!(null===(t=e.subscribers)||void 0===t?void 0:t["user"+n])&&!e.info.deleted}))),u(s.filter((e=>{var t;return null===(t=e.subscribers)||void 0===t?void 0:t["user"+n]})))}))}))}),[m,n]),c?Object(Ne.jsx)(En,{children:Object(Ne.jsxs)(Qe,{children:[Object(Ne.jsxs)("div",{className:cs.a.header,children:[Object(Ne.jsx)("h1",{className:cs.a.title,children:"Communities"}),Object(Ne.jsx)(He,{background:!0,className:cs.a.button,testId:"open-create-community-modal",onClick:()=>n?e(D("create-community")):t(),children:"Create new community"})]}),o.length>0&&Object(Ne.jsxs)("div",{className:cs.a.item,children:[Object(Ne.jsx)("div",{className:cs.a.item_header,children:Object(Ne.jsx)("h2",{className:cs.a.item_title,children:`My communities (${o.length})`})}),Object(Ne.jsx)(Ve,{communitiesInfo:o.map((e=>e.info)),renderSubscribeButton:!1})]}),d.length>0&&Object(Ne.jsxs)("div",{className:cs.a.item,children:[Object(Ne.jsx)("div",{className:cs.a.item_header,children:Object(Ne.jsx)("h2",{className:cs.a.item_title,children:`Subscribed (${d.length})`})}),Object(Ne.jsx)(Ve,{communitiesInfo:d.map((e=>e.info))})]}),c.length>0&&Object(Ne.jsxs)("div",{className:cs.a.item,children:[Object(Ne.jsx)("div",{className:cs.a.item_header,children:Object(Ne.jsx)("h2",{className:cs.a.item_title,children:`Explore (${c.length})`})}),Object(Ne.jsx)(Ve,{communitiesInfo:c.map((e=>e.info))})]})]})}):null}var ds=n(63),us=n.n(ds);function ms(){return Object(s.useEffect)((()=>document.title="404 Not Found | Social App"),[]),Object(Ne.jsx)(En,{children:Object(Ne.jsx)(Qe,{children:Object(Ne.jsxs)("div",{className:us.a.wrapper,children:[Object(Ne.jsx)("p",{className:us.a.number,children:"404"}),Object(Ne.jsx)("h2",{className:us.a.title,children:"Not Found"}),Object(Ne.jsx)("p",{className:us.a.text,children:"The requested page was not found on our server. It may have been removed."})]})})})}var bs=n(10),js=n.n(bs);function hs(){var e,t,n,a,o,i;const c=Object(r.b)(),{communityId:l}=Object(ye.useParams)(),d=Ce(),b=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.admin})),j=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),h=ge((e=>{var t,n,s;return null===(t=e.user)||void 0===t||null===(n=t.communities)||void 0===n||null===(s=n.subscribed)||void 0===s?void 0:s["community"+l]})),{AsyncButton:f,buttonLoading:v,setButtonLoading:p}=ke(),{addImgPreview:O,imgPreview:x,setImgPreview:g}=Ie(!1),_=Object(s.useRef)([]),[y,N]=Object(s.useState)(),[w,k]=Object(s.useState)(),[I,S]=Object(s.useState)(!1),[$,E]=Object(s.useState)(),[T,P]=Object(s.useState)(!1),{fetchedItems:L,finishLoading:R,loaded:M,setTitle:q}=we(),A=Object(s.useCallback)((()=>R(y.info.title)),[y,R]);Object(s.useEffect)((()=>{if(null===j)return;let e,t;const n=oe({callback:n=>{if(_.current=[],null===n||void 0===n?void 0:n.profilePhotos){for(const e in n.profilePhotos){var s;(null===(s=n.photos)||void 0===s?void 0:s[e])&&_.current.push(n.photos[e])}_.current.sort(((e,t)=>t.date-e.date))}N(n),n?((t=>{var n;t.info.deleted||(null===(n=e)||void 0===n||n(),e=oe({callback:e=>k([e.info]),userId:t.info.creatorId}))})(n),(()=>{var e;null===(e=t)||void 0===e||e(),t=ne("posts").orderByChild("communityId").equalTo(l).on((e=>{const t=Object.values({...e});E(t.sort(((e,t)=>+t.id-+e.id))),L.current.setExpected(t.length)}))})()):R()},community:!0,fields:["fullInfo","info","photos","profilePhotos"],userId:l});return()=>{var s,a;n(),null===(s=e)||void 0===s||s(),null===(a=t)||void 0===a||a()}}),[l,L,R,j]),Object(s.useEffect)((()=>{M.current&&y?q(y.info.title):0===(null===$||void 0===$?void 0:$.length)?A():null===y&&R()}),[y,R,M,A,$,q]);const B=()=>{var e;return z(l,null===(e=y.fullInfo.banner)||void 0===e?void 0:e.src,y.info.subscriberCount)};return void 0===y?null:y?Object(Ne.jsxs)(En,{className:js.a.container,children:[Object(Ne.jsxs)(Qe,{children:[Object(Ne.jsxs)("div",{className:js.a.header,children:[y.info.creatorId!==j&&!b||y.info.deleted?(null===(a=y.fullInfo)||void 0===a?void 0:a.banner)&&Object(Ne.jsx)("div",{className:js.a.banner,children:Object(Ne.jsx)("img",{className:js.a.banner_img,src:null===(o=y.fullInfo)||void 0===o?void 0:o.banner.src,alt:""})}):x[0]?Object(Ne.jsxs)(Ne.Fragment,{children:[Object(Ne.jsx)("div",{className:js.a.banner,children:Object(Ne.jsx)("img",{className:js.a.banner_img,src:x[0].result,alt:""})}),Object(Ne.jsxs)("div",{className:js.a.header_buttons,children:[Object(Ne.jsx)(f,{className:js.a.header_button,onClick:()=>{var e;if(v)return;p();const t=null===(e=y.fullInfo.banner)||void 0===e?void 0:e.src;ee({callback:()=>{t&&C.delete(t),p(!1),g([])},communityId:l,createId:!1,file:x[0].file,imgParent:"fullInfo",imgPath:"banner",storagePrefix:"community"+l})},children:"Confirm banner"}),!v&&Object(Ne.jsx)(He,{background:!0,className:js.a.header_button,preset:"secondary",onClick:()=>g([]),children:"Cancel"})]})]}):Object(Ne.jsxs)("label",{htmlFor:"community_banner_overlay",children:[Object(Ne.jsxs)("button",{className:Object(u.a)(js.a.banner,js.a.banner_button),onClick:e=>{var t;return null===(t=e.target.closest("label"))||void 0===t?void 0:t.click()},children:[(null===(e=y.fullInfo)||void 0===e?void 0:e.banner)?Object(Ne.jsx)("img",{className:js.a.banner_img,src:null===(t=y.fullInfo)||void 0===t?void 0:t.banner.src,alt:""}):Object(Ne.jsx)("p",{className:js.a.banner_placeholder,children:"No banner"}),Object(Ne.jsxs)("div",{className:js.a.banner_overlay,children:[Object(Ne.jsx)(m.C,{className:js.a.banner_overlay_icon,style:{height:"1.1em"}}),Object(Ne.jsx)("p",{className:js.a.banner_overlay_text,children:((null===(n=y.fullInfo)||void 0===n?void 0:n.banner)?"Change":"Set")+" banner"})]})]}),Object(Ne.jsx)("input",{accept:".jpg, .jpeg, .png",hidden:!0,id:"community_banner_overlay",type:"file",onChange:O})]}),Object(Ne.jsxs)("div",{className:js.a.info,children:[Object(Ne.jsxs)("div",{className:js.a.info_content,children:[Object(Ne.jsx)(Be,{avatar:_.current.find((e=>e.src===y.info.avatar)),className:"avatar-gallery",userInfo:y.info}),Object(Ne.jsxs)("div",{className:js.a.info_text,children:[Object(Ne.jsx)(et,{classes:{form:js.a.info_title_form,text:js.a.info_title_text},className:js.a.info_title,databaseRef:`communities/community${l}/info/title`,disabled:y.info.deleted,field:y.info.title,ownerId:y.info.creatorId,renderInputId:"title"}),Object(Ne.jsx)("p",{className:js.a.info_subscribers,children:W("subscriber",y.info.subscriberCount||0)}),I&&Object(Ne.jsx)("div",{className:js.a.contacts,children:null===w||void 0===w?void 0:w.map((e=>Object(Ne.jsx)(Hn,{avatarSize:"small",bottomText:"Creator",className:"user",enableAvatarPreview:!1,userInfo:e},e.id)))})]})]}),Object(Ne.jsxs)("div",{className:js.a.info_buttons,children:[Object(Ne.jsx)(He,{background:!0,className:js.a.info_subscribe,preset:h?"remove":"primary",onClick:()=>J(l,d,j,!!h),children:h?"Unsubscribe":"Subscribe"}),!y.info.deleted&&Object(Ne.jsx)("button",{className:js.a.toggle,onClick:()=>S(!I),children:(I?"Hide":"Show")+" contacts"})]})]}),(j===y.info.creatorId||b)&&Object(Ne.jsxs)("div",{className:js.a.info_footerButtons,children:[Object(Ne.jsx)(He,{background:!0,className:js.a.info_footerButton,onClick:()=>c(D("change-avatar",{changeAvatarCommunityId:l})),children:"Change avatar"}),Object(Ne.jsx)(He,{background:!0,className:js.a.info_footerButton,preset:"remove",onClick:B,children:"Delete community"})]})]}),Object(Ne.jsxs)("div",{className:js.a.description,children:[Object(Ne.jsx)("h3",{className:js.a.description_title,children:"Description"}),Object(Ne.jsxs)("div",{className:js.a.description_wrapper,children:[Object(Ne.jsx)(et,{classes:{text:js.a.description_wrapper_text},databaseRef:`communities/community${l}/fullInfo/description`,disabled:y.info.deleted,emptyButtonText:"Set description",emptyFieldText:"No description provided.",field:y.info.deleted?"This community has been deleted.":null===(i=y.fullInfo)||void 0===i?void 0:i.description,ownerId:y.info.creatorId,renderInputId:"description"}),T&&Object(Ne.jsxs)("div",{className:js.a.description_short,children:[Object(Ne.jsx)("h4",{className:js.a.description_short_title,children:"Short description:"}),Object(Ne.jsx)(et,{classes:{text:js.a.description_wrapper_text},databaseRef:`communities/community${l}/info/shortDescription`,disabled:y.info.deleted,emptyButtonText:"Set short description",emptyFieldText:"No description provided.",field:y.info.deleted?"This community has been deleted.":y.info.shortDescription,ownerId:y.info.creatorId,renderInputId:"shortDescription"})]}),(j===y.info.creatorId||b)&&!y.info.deleted&&Object(Ne.jsx)("button",{className:js.a.toggle,onClick:()=>P(!T),children:(T?"Hide":"Show")+" short description"})]})]}),j===y.info.creatorId&&!y.info.deleted&&Object(Ne.jsx)(gn,{addToPhotosButton:!0,avatar:y.info.avatar,community:!!l,userId:l}),!y.info.deleted&&Object(Ne.jsxs)("div",{className:js.a.posts,children:[Object(Ne.jsx)("div",{className:js.a.posts_header,children:Object(Ne.jsx)("h3",{className:js.a.posts_title,children:"Posts"})}),null===$||void 0===$?void 0:$.map(((e,t)=>Object(Ne.jsx)(pn,{fetchedItems:L,index:t,loadingCallback:A,post:e},e.id)))]})]}),!y.info.deleted&&Object(Ne.jsxs)("aside",{className:Object(u.a)(js.a.sidebar,"sidebar"),children:[Object(Ne.jsx)("h3",{className:js.a.sidebar_title,children:`Contacts (${null===w||void 0===w?void 0:w.length})`}),Object(Ne.jsx)("div",{className:js.a.sidebar_content,children:Object(Ne.jsx)("div",{className:js.a.contacts,children:null===w||void 0===w?void 0:w.map((e=>Object(Ne.jsx)(Hn,{avatarSize:"small",bottomText:"Creator",className:"user",userInfo:e},e.id)))})}),(j===y.info.creatorId||b)&&Object(Ne.jsxs)("div",{className:js.a.sidebar_buttons,children:[Object(Ne.jsx)(He,{background:!0,className:js.a.sidebar_button,onClick:()=>c(D("change-avatar",{changeAvatarCommunityId:l})),children:"Change avatar"}),Object(Ne.jsx)(He,{background:!0,className:js.a.sidebar_button,preset:"remove",testId:"delete-community-btn",onClick:B,children:"Delete community"})]})]})]}):Object(Ne.jsx)(ms,{})}var fs=n(29),vs=n.n(fs),ps=n(64),Os=n.n(ps);function xs(e){let{index:t,message:n,participants:s,previousMessage:a,selectedMessages:o,selectMessage:r}=e;const i=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),c=0===t||n.authorId!==a.authorId||n.date>a.date+3e5,l=e=>e.stopPropagation();return Object(Ne.jsxs)("button",{className:Object(u.a)(Os.a.container,o.find((e=>e.id===n.id))&&Os.a.container_selected),onClick:e=>r(e,n),children:[c&&Object(Ne.jsx)(De,{onClick:l,size:"small",src:s.find((e=>e.info.id===n.authorId)).info.avatar,userId:n.authorId}),Object(Ne.jsxs)("div",{className:Os.a.wrapper,children:[c&&Object(Ne.jsx)(Le,{className:"authorInfo",onClick:l,onlyName:!0,text:A(n.date),userInfo:s.find((e=>e.info.id===n.authorId)).info}),Object(Ne.jsx)(Gn,{author:s.find((e=>e.info.id===n.authorId)),className:"userMessage",content:n.content,linkStopPropagation:!0}),n.authorId===i&&Object(Ne.jsx)("div",{className:Os.a.status,children:n.read?Object(Ne.jsx)(m.d,{}):Object(Ne.jsx)(m.D,{})})]})]})}function gs(){const e=Object(r.b)(),{replace:t}=Object(ye.useHistory)(),{search:n}=Object(ye.useLocation)(),o=new URLSearchParams(n).get("interlocutor"),{conversationId:i}=Object(ye.useParams)(),c=Ce(),l=ge((e=>e.modal.currentModal)),d=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.conversations})),u=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),b=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.info})),j=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.photos})),[h,f]=Object(s.useState)(null),[p,O]=Object(s.useState)(null),[x,g]=Object(s.useState)(),[_,y]=Object(s.useState)([]),{finishLoading:N,loaded:w}=we(),k=Object(s.useRef)(),C=Object(s.useRef)(!1);C.current=!!o||!!(null===d||void 0===d?void 0:d["conversation"+i]);const S=Object(s.useRef)([]),$=()=>S.current.forEach((e=>e())),E=Object(s.useCallback)((()=>{window.innerHeight<document.body.offsetHeight&&window.scrollTo(0,document.body.offsetHeight)}),[]);Object(s.useEffect)((()=>(null===h||void 0===h?void 0:h.info.id)&&setTimeout(E,0)),[null===h||void 0===h?void 0:h.info.id,E]);const T=Object(s.useCallback)((()=>{f(null),O(null),g([]),!w.current&&N()}),[N,w]);Object(s.useEffect)((()=>{!i&&!o&&T()}),[i,T,o]),Object(s.useEffect)((()=>void 0===u&&c()),[c,u]);const P=Object(s.useCallback)((e=>{u&&(k.current=oe({callback:t=>{!w.current&&N("Conversation");const n=`conversations/conversation${e.info.id}/`,s=e.messages.reduce(((e,t)=>(t.read||t.authorId===u||(e[`${n}messages/${t.id}/read`]=I),e)),{}),{lastMessage:o}=e.info;(null===o||void 0===o?void 0:o.content)&&!o.read&&o.authorId!==u&&(s[`${n}info/lastMessage/read`]=I),ne().update(s),Object(a.unstable_batchedUpdates)((()=>{f(e),O(t),g([t,{info:b,photos:j}])}))},fields:["connections","info","photos"],userId:e.info.participants.find((e=>e!==u))}))}),[N,w,u,b,j]),L=Object(s.useCallback)((e=>{const t=Object.values({...d}),n=[];S.current=[];const s=()=>{if(n.length===t.length&&!n.includes(void 0)){$();for(const s of n)if(s.includes(u)&&s.includes(o||(null===p||void 0===p?void 0:p.info.id)))return void e(t[n.indexOf(s)]);e()}};t.forEach(((e,t)=>{S.current.push(ne(`conversations/conversation${e}/info/participants`).on((e=>{n[t]=e,s()})))})),!t.length&&s()}),[null===p||void 0===p?void 0:p.info.id,o,d,u]);Object(s.useEffect)((()=>$),[null===p||void 0===p?void 0:p.info.id,o,d,u]),Object(s.useEffect)((()=>{if(!i&&o&&u){if(u!==o)return L((e=>{e?t("/conversation"+e):P({info:{creationTime:null,id:"0",lastMessage:null,participants:[u,o]},messages:[]})})),k.current;T()}}),[L,T,i,P,t,o,u]),Object(s.useEffect)((()=>{if(!i||!u)return;if(!C.current)return void N();const e=ne("conversations/conversation"+i).on((e=>{var t;null===(t=k.current)||void 0===t||t.call(k),e?(e.messages=Object.values({...e.messages}).sort(((e,t)=>e.date-t.date)),P(e)):T()}));return()=>{var t;e(),null===(t=k.current)||void 0===t||t.call(k)}}),[T,i,P,N,d,u]);Object(s.useEffect)((()=>{const e=e=>{"Escape"!==e.key||l||y([])};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)}),[l]);const R=(e,t)=>{if(_.find((e=>e.id===t.id))){const e=[..._];e.splice(_.indexOf(t),1),y(e)}else if(e.shiftKey){const e=h.messages,n=e.indexOf(t),s=e.indexOf(_[_.length-1]),a=[..._];for(let t=Math.min(s+1,n);t<Math.max(n+1,s);t++)!_.find((n=>n.id===e[t].id))&&a.push(e[t]);y(a)}else y([..._,t])};return null===u||!x&&C.current?null:void 0!==u&&p&&x&&C.current?Object(Ne.jsx)(En,{className:vs.a.container,children:Object(Ne.jsx)(Qe,{children:Object(Ne.jsxs)("div",{className:vs.a.wrapper,children:[Object(Ne.jsx)("div",{className:vs.a.header,children:Object(Ne.jsxs)("div",{className:vs.a.header_wrapper,children:[Object(Ne.jsxs)("div",{className:vs.a.header_interlocutor,children:[Object(Ne.jsx)(De,{size:"small",src:p.info.avatar,userId:p.info.id}),Object(Ne.jsx)(Le,{className:"authorInfo",text:U(p),userInfo:p.info})]}),_.length>0&&Object(Ne.jsxs)("div",{className:vs.a.header_overlay,children:[Object(Ne.jsxs)("button",{className:vs.a.header_overlay_qty,onClick:()=>y([]),children:[Object(Ne.jsx)("span",{className:vs.a.header_overlay_qty_icon,children:"\xd7"}),W("message",_.length)]}),Object(Ne.jsxs)("div",{className:vs.a.header_overlay_buttons,children:[Object(Ne.jsx)(He,{afterIcon:m.w,className:vs.a.header_overlay_button,ariaLabel:"Copy messages to clipboard",onClick:()=>{navigator.clipboard.writeText([..._].sort(((e,t)=>e.date-t.date)).reduce(((e,t)=>e+((t.content.text||"")+" ")),"").trim()).then((()=>e(v("Text copied to clipboard.",m.w))))}}),Object(Ne.jsx)(He,{afterIcon:m.F,className:vs.a.header_overlay_button,ariaLabel:"Delete messages",onClick:()=>{const t=_.map((e=>e.id)),n=h.messages.filter((e=>!t.includes(e.id)));_.find((e=>e.authorId!==u))?e(D("action-error",{actionError:"You can't delete someone else's messages. Try to select only your own messages and try again."})):e(D("action-confirm",{actionConfirm:{callback:()=>{y([]);const t=`conversations/conversation${i}/`,s={[t+"info/lastMessage"]:n[n.length-1]||{date:h.info.lastMessage.date}};_.forEach((e=>s[`${t}messages/${e.id}`]=null)),ne().update(s).then((()=>e(v(_.length+" message(s) deleted.",m.F))))},irreversible:!0,text:`Are you sure you want to delete ${W("message",_.length)}?`}}))}})]})]})]})}),Object(Ne.jsx)("div",{className:vs.a.content,children:h.messages.map(((e,t)=>Object(Ne.jsx)(xs,{index:t,message:e,participants:x,previousMessage:h.messages[t-1],selectedMessages:_,selectMessage:R},e.id)))}),Object(Ne.jsx)("div",{className:vs.a.footer,children:Object(Ne.jsx)("div",{className:vs.a.footer_wrapper,children:Object(Ne.jsx)(gn,{avatar:b.avatar,buttonText:"Message",inputPlaceholder:"Your message",mobileSubmit:!0,uploadCallback:e=>new Promise((n=>{const s=(s,a)=>{const r=ne().newKey(),c={authorId:u,content:e,date:I,id:r},l=e=>`users/user${e}/conversations/conversation${s}`,d=`conversations/conversation${s}/`;ne().update(a?{"contentData/nextConversationId":`${parseInt(s,10)+1}`,["conversations/conversation"+s]:{info:{creationTime:I,id:s,lastMessage:c,participants:x.map((e=>e.info.id))},messages:{[r]:c}},[l(u)]:s,[l(o)]:s}:{[d+"info/lastMessage"]:c,[d+"messages/"+r]:c}).then((()=>{(a||i!==s)&&t("/conversation"+s),n(),E()}))};"0"===h.info.id?L((e=>{e?s(e):ne("contentData/nextConversationId").once((e=>s(e,!0)))})):s(h.info.id)})),userId:u})})})]})})}):Object(Ne.jsx)(ms,{})}function _s(e){let{fetchedItems:t,friendId:n,friendRequestDate:a,loadingCallback:o}=e;const[r,i]=Object(s.useState)();return Object(s.useEffect)((()=>oe({callback:e=>{i(e),t.current.incrementQty(n,o)},fields:["connections","info"],userId:n})),[t,n,o]),r?Object(Ne.jsx)(ss,{requestDate:a,singleUser:r}):null}var ys=n(74),Ns=n.n(ys);function ws(){const{search:e}=Object(ye.useLocation)(),{ownerId:t}=Object(ye.useParams)(),n=new URLSearchParams(e).get("tab"),a=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),o=ge((e=>{var t,n;return null===(t=e.user)||void 0===t||null===(n=t.friendRequests)||void 0===n?void 0:n.received})),[r,c]=Object(s.useState)(),[l,d]=Object(s.useState)(!1),u=Object(s.useRef)(""),{fetchedItems:m,finishLoading:b,loaded:j,setTitle:h}=we(),f=Object(s.useCallback)((()=>b(u.current)),[b]);if(Object(s.useEffect)((()=>{if(null!==a)return oe({callback:c,fields:["friends","info"],userId:t||a})}),[m,t,a]),Object(s.useEffect)((()=>{(null===r||void 0===r?void 0:r.info.id)?(u.current=r.info.id===a?"requests"===n?"My friend requests":"My friends":`${r.info.name} ${r.info.lastName}'s friends`,j.current&&h(u.current),l||d(!0),m.current.setExpected(Object.keys("requests"===n?{...o}:{...r.friends}).length,f)):null===r&&(d(!0),b())}),[m,b,r,j,f,n,h,l,o,a]),!l)return null;if(!r)return Object(Ne.jsx)(ms,{});const v=Object.values({...r.friends}),p=Object.values({...o}),O=r.info.id===a&&"requests"===n;return Object(Ne.jsxs)(En,{className:Ns.a.container,children:[Object(Ne.jsxs)(Qe,{children:[Object(Ne.jsx)("div",{className:Ns.a.header,children:Object(Ne.jsx)(i.b,{className:Ns.a.title,to:"/id"+r.info.id,children:O?`Your friend requests (${p.length})`:`${r.info.id!==a?`${r.info.name}'s`:"Your"} friends (${v.length})`})}),(O?p:v).length>0&&Object(Ne.jsx)("div",{className:"usersList",children:(O?p:v).map((e=>Object(Ne.jsx)(_s,{fetchedItems:m,friendId:e.userId,friendRequestDate:e.date,loadingCallback:f},e.userId)))})]}),r.info.id===a&&Object(Ne.jsx)(Ln,{items:[{text:`Friends (${v.length})`,to:"/friends"},{text:`Friend requests (${p.length})`,to:"?tab=requests"}]})]})}var ks=n(36),Is=n.n(ks);let Cs;function Ss(){const e=Object(r.b)(),{replace:t}=Object(ye.useHistory)(),{search:n}=Object(ye.useLocation)(),a=new URLSearchParams(n).get("from"),o=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),{formState:{errors:i},handleSubmit:c,register:l}=Object(Je.a)(),{AsyncButton:d,buttonLoadingRef:u,setButtonLoading:b}=ke(),[j,h]=Object(s.useState)(!1);Object(s.useEffect)((()=>{o?t(a||"/news"):void 0===o&&(document.title="Log in | Social App")}),[a,t,o]);if(void 0!==o)return null;const f={errors:i,label:!0,placeholder:!0,register:l};return Object(Ne.jsx)(En,{className:Is.a.container,children:Object(Ne.jsx)(Qe,{className:Is.a.contentWidth,children:Object(Ne.jsxs)("div",{className:Is.a.wrapper,children:[Object(Ne.jsxs)("div",{className:Is.a.info,children:[Object(Ne.jsx)("h1",{className:Is.a.info_title,children:"Social App"}),Object(Ne.jsx)("p",{className:Is.a.info_text,children:"Connect with your friends and communities on Social App."})]}),Object(Ne.jsxs)("div",{className:Is.a.content,children:[Object(Ne.jsxs)(st,{noValidate:!0,onChange:()=>b(!1),onSubmit:c((t=>{var n;u.current||(b(),null===(n=Cs)||void 0===n||n(),Cs=ne("users").orderByChild("account/email").equalTo(t.email).on((n=>{if(Cs(),u.current){if(n){const s=Object.values(n)[0];(null===s||void 0===s?void 0:s.account.email)===t.email&&_(s.account.password)===t.password?(ae("users/user"+s.account.id),e(he(s)),e(ft())):h(!0)}else h(!0);b(!1)}})))})),children:[Object(Ne.jsx)(Et,{autoFocus:!0,id:"index-email",onInput:()=>h(!1),opts:{obj:Ze.find((e=>"email"===e.id)),...f}}),Object(Ne.jsx)(Et,{id:"index-password",onInput:()=>h(!1),opts:{obj:Ze.find((e=>"existingPassword"===e.id)),...f}}),j&&Object(Ne.jsx)("p",{className:"error-text",children:"Wrong email or password."}),Object(Ne.jsx)(d,{testId:"log-in-btn",type:"submit",children:"Log in"})]}),Object(Ne.jsx)(He,{className:Is.a.content_forgot,onClick:()=>e(v("Not available.",m.m)),children:"Forgot password?"}),Object(Ne.jsx)("hr",{className:Is.a.content_hr}),Object(Ne.jsx)(He,{background:!0,className:Is.a.content_signup,preset:"secondary",testId:"index-signup",onClick:()=>e(D("sign-up")),children:"Sign up"})]})]})})})}var $s=n(48),Es=n.n($s);function Ts(e){var t;let{conversation:n,fetchedItems:a,loadingCallback:o}=e;const r=ge((e=>{var t,n;return null===(t=e.user)||void 0===t||null===(n=t.info)||void 0===n?void 0:n.avatar})),i=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),[c,l]=Object(s.useState)();return Object(s.useEffect)((()=>oe({callback:e=>{l(e.info),a.current.incrementQty(e.info.id,o)},userId:n.participants.find((e=>e!==i))})),[n.participants,a,o,i]),c?Object(Ne.jsx)("div",{className:Es.a.item,children:Object(Ne.jsx)(Hn,{bottomText:n.lastMessage&&A(n.lastMessage.date,!0),childrenBottom:(null===(t=n.lastMessage)||void 0===t?void 0:t.content)?Object(Ne.jsxs)("div",{className:Es.a.lastMessage,children:[!n.lastMessage.read&&Object(Ne.jsx)(m.y,{className:Es.a.lastMessage_unread}),Object(Ne.jsx)("img",{className:Es.a.lastMessage_avatar,src:n.lastMessage.authorId===i?r:c.avatar,alt:"Avatar"}),Object(Ne.jsx)("p",{className:Es.a.lastMessage_content,children:n.lastMessage.content.text||"Photo"})]}):Object(Ne.jsx)("p",{className:Es.a.noMessages,children:"No messages yet"}),className:"user",userInfo:c,wrapperLink:"/conversation"+n.id})}):null}var Ps=n(96),Ls=n.n(Ps);function Rs(){const e=Ce(),t=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.conversations})),n=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),[a,o]=Object(s.useState)(),{fetchedItems:r,finishLoading:i}=we(),c=Object(s.useCallback)((()=>i("Messages")),[i]);return Object(s.useEffect)((()=>{if(!n)return;if(!t)return c(),void o([]);const e=Object.values({...t}),s=[],a=[];return e.forEach(((t,n)=>{s[n]=ne(`conversations/conversation${t}/info`).on((t=>{a[n]=t,a.includes(void 0)||a.length!==e.length||(o(a.sort(((e,t)=>t.lastMessage.date-e.lastMessage.date))),r.current.setExpected(e.length,c))}))})),()=>s.forEach((e=>e()))}),[r,c,t,n]),Object(s.useEffect)((()=>void 0===n&&e()),[e,n]),void 0!==n&&a?Object(Ne.jsx)(En,{children:Object(Ne.jsx)(Qe,{children:a.length?a.map((e=>Object(Ne.jsx)(Ts,{conversation:e,fetchedItems:r,loadingCallback:c},e.id))):Object(Ne.jsx)("p",{className:Ls.a.noContent,children:"No messages"})})}):null}var Ms=n(97),Ds=n.n(Ms);function qs(){const{replace:e}=Object(ye.useHistory)(),t=ge((e=>{var t,n;return null===(t=e.user)||void 0===t||null===(n=t.info)||void 0===n?void 0:n.avatar})),n=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),[a,o]=Object(s.useState)([]),{fetchedItems:r,finishLoading:i}=we(),c=Object(s.useCallback)((()=>i("News")),[i]);return Object(s.useEffect)((()=>{if(void 0===n&&e("/"),n)return ne("posts").on((e=>{const t=Object.values(e);o(t.sort(((e,t)=>+t.id-+e.id))),r.current.setExpected(t.length,c)}))}),[r,c,e,n]),n&&a.length?Object(Ne.jsx)(En,{className:Ds.a.container,children:Object(Ne.jsxs)(Qe,{children:[Object(Ne.jsx)(gn,{addToPhotosButton:!0,avatar:t,userId:n}),a.map(((e,t)=>Object(Ne.jsx)(pn,{fetchedItems:r,index:t,loadingCallback:c,post:e},e.id)))]})}):null}function As(){const e=Object(r.b)(),{ownerId:t}=Object(ye.useParams)(),n=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),[a,o]=Object(s.useState)([]),[c,l]=Object(s.useState)(),{finishLoading:d,loaded:u,setTitle:m}=we();return Object(s.useEffect)((()=>{if(null!==n)return oe({callback:e=>{const t=[];for(const n in null===e||void 0===e?void 0:e.profilePhotos)(null===e||void 0===e?void 0:e.photos)&&t.push(e.photos[n]);o(t.sort(((e,t)=>t.date-e.date))),l(e)},fields:["info","photos","profilePhotos"],userId:t||n})}),[t,n]),Object(s.useEffect)((()=>{const e=t!==n&&t?`${null===c||void 0===c?void 0:c.info.name} ${null===c||void 0===c?void 0:c.info.lastName}'s photos`:"My photos";u.current?m(e):c?d(e):null===c&&d()}),[u,t,c,d,n,m]),void 0===c?null:c?Object(Ne.jsx)(En,{children:Object(Ne.jsxs)(Qe,{children:[Object(Ne.jsx)("div",{className:"photos__header",children:Object(Ne.jsx)(i.b,{className:"photos__title",to:"/id"+c.info.id,children:`${t!==n&&t?`${c.info.name}'s`:"My"} photos (${a.length})`})}),Object(Ne.jsx)("div",{className:"photos__items",children:a.map(((t,n)=>Object(Ne.jsx)(i.b,{className:"photos__item",onClick:t=>{e(D("gallery",{gallery:{authorInfo:c.info,content:a,initialSlide:n}})),t.preventDefault()},to:"#javascript",children:Object(Ne.jsx)("img",{className:"photos__item-img",src:t.src,alt:""})},t.id)))})]})}):Object(Ne.jsx)(ms,{})}function Bs(){const{postId:e}=Object(ye.useParams)(),[t,n]=Object(s.useState)(),{fetchedItems:a,finishLoading:o}=we(),r=Object(s.useCallback)((()=>o("Post")),[o]);return Object(s.useEffect)((()=>ne("posts/post"+e).on((e=>{e?(n(e),a.current.setExpected(1)):(o(),n(null))}))),[a,o,e]),void 0===t?null:null===t?Object(Ne.jsx)(ms,{}):Object(Ne.jsx)(En,{children:Object(Ne.jsx)(Qe,{children:Object(Ne.jsx)(pn,{fetchedItems:a,loadingCallback:r,post:t,renderComments:!0})})})}var Fs=n(65),zs=n.n(Fs);const Hs=e=>{if(!e)return;const t=new Date(e);return`${t.toLocaleString("en-US",{month:"long"})} ${t.getDate()}, ${t.getFullYear()}`};function Us(e){let{fullInfo:t}=e;const n=[{title:"Birthday",value:Hs(null===t||void 0===t?void 0:t.birthday)},{title:"Country",value:null===t||void 0===t?void 0:t.country},{title:"City",value:null===t||void 0===t?void 0:t.city}].filter((e=>e.value));return Object(Ne.jsx)("div",{className:zs.a.container,children:n.map((e=>Object(Ne.jsxs)("p",{className:zs.a.item,children:[Object(Ne.jsx)("span",{className:zs.a.item_title,children:e.title+": "}),Object(Ne.jsx)("span",{className:zs.a.item_value,children:e.value})]},e.title)))})}var Ys=n(81),Vs=n.n(Ys);function Ws(e){let{friendId:t}=e;const[n,a]=Object(s.useState)();return Object(s.useEffect)((()=>oe({callback:e=>a(e.info),userId:t})),[t]),n?Object(Ne.jsxs)("div",{className:Vs.a.container,children:[Object(Ne.jsx)(De,{size:"small",src:n.avatar,userId:t}),Object(Ne.jsx)(i.b,{className:Vs.a.name,to:"/id"+t,children:n.name})]}):null}var Ks=n(39),Qs=n.n(Ks);function Js(e){var t,n;let{owner:s,profilePhotos:a}=e;const o=Object(r.b)(),{ownerId:c}=Object(ye.useParams)(),l=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),d=ge((e=>{var t,n,s;return null===(t=e.user)||void 0===t||null===(n=t.friendRequests)||void 0===n||null===(s=n.received)||void 0===s?void 0:s["user"+c]})),u=ge((e=>{var t,n,s;return null===(t=e.user)||void 0===t||null===(n=t.friendRequests)||void 0===n||null===(s=n.sent)||void 0===s?void 0:s["user"+c]})),b=()=>o(D("action-confirm",{actionConfirm:{callback:()=>ne().update({[`users/user${c}/friends/user${l}`]:null,[`users/user${l}/friends/user${c}`]:null}).then((()=>o(v("Friend removed.",m.P)))),text:"Are you sure you want to remove this friend?"}})),j=Object.values({...s.friends}),h={width:"1.25em"};return Object(Ne.jsxs)("div",{className:Qs.a.container,children:[Object(Ne.jsx)(Be,{avatar:a.current.find((e=>e.src===s.info.avatar)),className:"avatar-gallery",userInfo:s.info}),Object(Ne.jsx)("p",{className:Qs.a.onlineStatus,children:U(s)}),s.info.deleted?(null===(n=s.friends)||void 0===n?void 0:n["user"+l])&&Object(Ne.jsx)("div",{className:Qs.a.buttons,children:Object(Ne.jsx)(He,{afterIcon:m.P,background:!0,iconStyles:h,preset:"remove",onClick:b,children:"Remove friend"})}):Object(Ne.jsxs)(Ne.Fragment,{children:[l&&(c!==l?Object(Ne.jsxs)("div",{className:Qs.a.buttons,children:[(null===(t=s.friends)||void 0===t?void 0:t["user"+l])?Object(Ne.jsx)(He,{afterIcon:m.P,background:!0,iconStyles:h,preset:"remove",onClick:b,children:"Remove friend"}):d?Object(Ne.jsx)(He,{afterIcon:m.Q,background:!0,iconStyles:h,onClick:()=>B({reqUserId:c,userId:l}),children:"Accept friend request"}):u?Object(Ne.jsx)(He,{afterIcon:m.R,background:!0,iconStyles:h,preset:"remove",onClick:()=>{const e=`users/user${c}/`;ne().update({[`${e}friendRequests/received/user${l}`]:null,[`users/user${l}/friendRequests/sent/user${c}`]:null,[e+"fullInfo/followerCount"]:Object(x.e)(-1),[e+"notifications/friendRequest"+l]:null}).then((()=>o(v("Friend request cancelled.",m.R))))},children:"Cancel friend request"}):Object(Ne.jsx)(He,{afterIcon:m.Q,background:!0,iconStyles:h,onClick:()=>{const e=`users/user${c}/`;ne().update({[`${e}friendRequests/received/user${l}`]:{date:I,userId:l},[`users/user${l}/friendRequests/sent/user${c}`]:{date:I,userId:c},[e+"fullInfo/followerCount"]:Object(x.e)(1),[e+"notifications/friendRequest"+l]:{date:I,id:l,type:"friendRequest"}}).then((()=>o(v("Friend request sent.",m.Q))))},children:"Add friend"}),Object(Ne.jsx)(He,{afterIcon:m.k,background:!0,to:"/conversation?interlocutor="+c,children:"Send message"})]}):Object(Ne.jsx)("div",{className:Qs.a.buttons,children:Object(Ne.jsx)(He,{afterIcon:m.t,background:!0,iconStyles:{width:".75em"},preset:"secondary",onClick:()=>o(D("change-avatar")),children:"Change avatar"})})),Object(Ne.jsxs)("div",{className:Qs.a.friends,children:[Object(Ne.jsx)("div",{className:Qs.a.friends_header,children:Object(Ne.jsx)(i.b,{className:Qs.a.friends_title,to:`/friends${c!==l?c:""}`,children:`Friends (${j.length})`})}),j.length>0&&Object(Ne.jsx)("div",{className:Qs.a.friends_items,children:j.map((e=>Object(Ne.jsx)(Ws,{friendId:e.userId},e.userId)))})]})]})]})}var Zs=n(25),Xs=n.n(Zs),Gs=n(55),ea=n.n(Gs);function ta(e){let{postsQty:t,user:{fullInfo:n,info:s,profilePhotos:a}}=e;const o=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),r=[{qty:null===n||void 0===n?void 0:n.followerCount,text:"followers"},{link:`/photos${s.id!==o?s.id:""}`,qty:Object.keys({...a}).length,text:"photos"},{qty:t,renderZero:!0,text:"posts"}].filter((e=>!!e.renderZero||e.qty));return Object(Ne.jsx)("div",{className:ea.a.container,children:r.map((e=>{const t=e.link?i.b:"div";return Object(Ne.jsxs)(t,{className:Object(u.a)(ea.a.item,e.link&&ea.a.button),to:e.link,children:[Object(Ne.jsx)("p",{className:ea.a.item_number,children:e.qty}),Object(Ne.jsx)("p",{className:ea.a.item_title,children:e.text})]},e.text)}))})}function na(){var e;const t=Object(r.b)(),{ownerId:n}=Object(ye.useParams)(),a=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.admin})),o=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),[c,l]=Object(s.useState)(),[d,u]=Object(s.useState)(),m=Object(s.useRef)(),b=Object(s.useRef)([]),{fetchedItems:j,finishLoading:h,loaded:f,setTitle:v}=we(),p=Object(s.useCallback)((()=>{h((null===d||void 0===d?void 0:d.info.name)+" "+(null===d||void 0===d?void 0:d.info.lastName))}),[h,null===d||void 0===d?void 0:d.info.lastName,null===d||void 0===d?void 0:d.info.name]),O=Object(s.useCallback)((e=>{if(e){if(document.activeElement.blur(),b.current=[],e.profilePhotos){for(const n in e.profilePhotos){var t;(null===(t=e.photos)||void 0===t?void 0:t[n])&&b.current.push(e.photos[n])}b.current.sort(((e,t)=>t.date-e.date))}m.current=ne("posts").orderByChild("authorId").equalTo(n).on((e=>{const t=Object.values({...e});l(t.sort(((e,t)=>+t.id-+e.id))),j.current.setExpected(t.length)}))}else u(null)}),[j,n]);Object(s.useEffect)((()=>{f.current?v((null===d||void 0===d?void 0:d.info.name)+" "+(null===d||void 0===d?void 0:d.info.lastName)):0===(null===c||void 0===c?void 0:c.length)?p():null===d&&h()}),[h,f,p,n,c,d,v,o]),Object(s.useEffect)((()=>{if(null===o)return;const e=oe({callback:e=>{var t;null===(t=m.current)||void 0===t||t.call(m),O(e),u(e)},fields:["connections","friends","fullInfo","info","photos","profilePhotos"],userId:n});return()=>{var t;e(),null===(t=m.current)||void 0===t||t.call(m)}}),[n,O,o]);return void 0===d?null:d?Object(Ne.jsx)(En,{children:Object(Ne.jsx)(Qe,{children:Object(Ne.jsxs)("div",{className:Xs.a.wrapper,children:[Object(Ne.jsx)(Js,{owner:d,profilePhotos:b}),Object(Ne.jsxs)("div",{className:Xs.a.content,children:[Object(Ne.jsxs)("div",{className:Xs.a.info,children:[Object(Ne.jsxs)("div",{className:Xs.a.info_header,children:[Object(Ne.jsxs)("div",{className:Xs.a.info_header_wrapper,children:[Object(Ne.jsx)("h1",{className:Xs.a.info_header_name,children:`${d.info.name} ${d.info.lastName}`}),n!==o&&!d.info.deleted&&Object(Ne.jsx)(Ee,{bookmarkType:"user",className:Xs.a.actionsMenu,itemId:n,children:a&&Object(Ne.jsx)(He,{background:!0,onClick:()=>t(D("action-confirm",{actionConfirm:{callback:()=>F(n),irreversible:!0,password:!0,text:"Are you sure you want to delete this account?"}})),children:"Delete user"})})]}),Object(Ne.jsx)(et,{classes:{button:"user-status_button",form:"user-status_form"},className:"user-status",databaseRef:`users/user${n}/fullInfo/status`,emptyButtonText:"Set status",field:null===(e=d.fullInfo)||void 0===e?void 0:e.status,ownerId:n,renderInputId:"status"})]}),Object(Ne.jsx)(Us,{fullInfo:d.fullInfo}),Object(Ne.jsx)(ta,{postsQty:null===c||void 0===c?void 0:c.length,user:d})]}),!d.info.deleted&&Object(Ne.jsxs)(Ne.Fragment,{children:[Object(Ne.jsxs)("div",{className:Xs.a.photos,children:[Object(Ne.jsx)(i.b,{className:Xs.a.photos_title,to:`/photos${n!==o?n:""}`,children:"Photos: "+Object.keys({...d.profilePhotos}).length}),b.current.length>0&&Object(Ne.jsx)("div",{className:Xs.a.photos_wrapper,children:b.current.map(((e,n)=>n<4&&Object(Ne.jsx)(i.b,{className:Xs.a.photos_imgContainer,onClick:e=>{t(D("gallery",{gallery:{authorInfo:d.info,content:b.current,initialSlide:n}})),e.preventDefault()},to:"#javascript",children:Object(Ne.jsx)("div",{className:Xs.a.photos_imgInnerContainer,children:Object(Ne.jsx)("img",{className:Xs.a.photos_img,src:e.src,alt:""})})},e.id)))})]}),Object(Ne.jsxs)("div",{className:Xs.a.posts,children:[Object(Ne.jsx)("div",{className:Xs.a.posts_header,children:Object(Ne.jsx)("h3",{className:Xs.a.posts_title,children:"Posts"})}),null===c||void 0===c?void 0:c.map(((e,t)=>Object(Ne.jsx)(pn,{fetchedItems:j,index:t,loadingCallback:p,post:e},e.id)))]})]})]})]})})}):Object(Ne.jsx)(ms,{})}var sa=n(56),aa=n.n(sa);function oa(){const{push:e}=Object(ye.useHistory)(),{finishLoading:t}=we(),{search:n}=Object(ye.useLocation)(),a=new URLSearchParams(n).get("query"),o=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),[r,i]=Object(s.useState)(),[c,l]=Object(s.useState)(""),d=Object(s.useCallback)((e=>!a||e.toLowerCase().includes(a.toLowerCase())),[a]);return Object(s.useEffect)((()=>{const e=[];let t=!1;return ne("contentData/nextUserId").once((n=>{if(t)return;const s=parseInt(n,10)-1,a=[],o=[];for(let t=0;t<s;t++)e[t]=oe({callback:e=>{a[t]||e.info.deleted||!d(e.info.name)&&!d(e.info.lastName)||o.push(e),a[t]=!0,a.length!==s||a.includes(void 0)||i(o.sort(((e,t)=>+e.info.id-+t.info.id)))},fields:["connections","info"],userId:`${t+1}`})})),()=>{t=!0,e.forEach((e=>e()))}}),[d]),Object(s.useEffect)((()=>{r&&t(a?`Search results for ${a}`:"Search")}),[t,r,a]),Object(s.useEffect)((()=>l(a||"")),[a]),Object(s.useEffect)((()=>{const t=setTimeout((()=>{(a||"")!==c&&e(`?query=${encodeURIComponent(c)||""}`)}),250);return()=>clearTimeout(t)}),[e,a,c]),null===o?null:Object(Ne.jsx)(En,{children:Object(Ne.jsx)(Qe,{children:Object(Ne.jsxs)("div",{className:aa.a.wrapper,children:[Object(Ne.jsxs)("div",{className:aa.a.header,children:[Object(Ne.jsx)("h1",{className:aa.a.title,children:`Search users (${null===r||void 0===r?void 0:r.length})`}),Object(Ne.jsx)(Cn,{className:aa.a.searchBar,value:c,onChange:e=>l(e.target.value),onSubmit:e=>e.preventDefault()})]}),(null===r||void 0===r?void 0:r.length)?Object(Ne.jsx)(ss,{users:r}):Object(Ne.jsx)("p",{className:aa.a.noResults,children:"No results."})]})})})}var ra=n(28),ia=n.n(ra);function ca(){const e=Object(r.b)(),t=ge((e=>e.user.account.id));return Object(Ne.jsxs)(st,{onSubmit:n=>{n.preventDefault(),e(D("action-confirm",{actionConfirm:{callback:()=>{e(R("action-confirm")),setTimeout((()=>{e(fe()),setTimeout((()=>F(t)),0)}),400)},irreversible:!0,password:!0,text:"Are you sure you want to delete your account?"}}))},children:[Object(Ne.jsx)("h3",{className:ia.a.formTitle,children:"Account removal"}),Object(Ne.jsx)("div",{className:ia.a.buttons,style:{marginTop:0},children:Object(Ne.jsx)(He,{background:!0,className:ia.a.delete,preset:"remove",type:"submit",children:"Delete account"})})]})}function la(){const e=Object(r.b)(),t=ge((e=>e.user.fullInfo)),n=ge((e=>e.user.info)),{formState:{errors:s},handleSubmit:a,register:o,reset:i}=Object(Je.a)(),{AsyncButton:c,buttonLoadingRef:l,setButtonLoading:d}=ke(),u={errors:s,label:!0,register:o};return Object(Ne.jsxs)(st,{onSubmit:a((t=>{if(l.current)return;d(),t=H(t);for(const e in t)t[e]||(t[e]=null);const s=`users/user${n.id}/`,a=s+"fullInfo/",o=s+"info/";ne().update({[a+"birthday"]:t.birthday,[a+"city"]:t.city,[a+"country"]:t.country,[o+"gender"]:t.gender,[o+"lastName"]:t.lastName,[o+"name"]:t.name}).then((()=>{e(v("Information saved.",m.l)),d(!1),i()}))})),children:[Ze.filter((e=>["name","lastName"].includes(e.id))).map((e=>Object(Ne.jsx)(Et,{opts:{obj:e,defaultValue:n[e.id],...u}},e.id))),Object(Ne.jsx)(rt,{defaultValue:n.gender,register:o}),Ze.filter((e=>["birthday","country","city"].includes(e.id))).map((e=>{var n;return Object(Ne.jsx)(Et,{max:null===(n=e.getMax)||void 0===n?void 0:n.call(e).value,min:e.min,opts:{obj:e,defaultValue:null===t||void 0===t?void 0:t[e.id],...u}},e.id)})),Object(Ne.jsxs)("div",{className:ia.a.buttons,children:[Object(Ne.jsx)(c,{className:ia.a.submit,type:"submit",children:"Save"}),Object(Ne.jsx)(He,{background:!0,preset:"secondary",onClick:()=>i(),children:"Cancel"})]})]})}function da(){const e=Object(r.b)(),t=ge((e=>e.user.account)),n=ge((e=>e.user.account.id)),a=Object(s.useRef)(),[o,i]=Object(s.useState)(!1),{formState:{errors:c},handleSubmit:l,register:d,reset:u}=Object(Je.a)(),{AsyncButton:b,buttonLoadingRef:j,setButtonLoading:h}=ke();return Object(Ne.jsxs)(st,{noValidate:!0,onSubmit:l((s=>{var o;j.current||(h(),null===(o=a.current)||void 0===o||o.call(a),a.current=ne("users").orderByChild("account/email").equalTo(s.email.toLowerCase()).on((o=>{if(a.current(),o&&!o["user"+n])return s.email=t.email,h(!1),void i(!0);ne(`users/user${t.id}/account`).update({email:s.email.toLowerCase(),password:g(s.password,n)}).then((()=>{_(t.password)!==s.password&&Q({id:n,password:s.password}),e(v("Security data saved.",m.L)),h(!1),u()}))})))})),children:[Object(Ne.jsx)(Et,{onInput:()=>i(!1),opts:{obj:Ze.find((e=>"email"===e.id)),defaultValue:t.email,errors:c,label:!0,register:d}}),o&&Object(Ne.jsx)("p",{className:"error-text",children:"This email is already used."}),Object(Ne.jsx)(Et,{opts:{obj:Ze.find((e=>"password"===e.id)),defaultValue:_(t.password),errors:c,label:!0,register:d}}),Object(Ne.jsxs)("div",{className:ia.a.buttons,children:[Object(Ne.jsx)(b,{className:ia.a.submit,type:"submit",children:"Save"}),Object(Ne.jsx)(He,{background:!0,onClick:()=>{u(),i(!1)},preset:"secondary",children:"Cancel"})]})]})}function ua(){const{search:e}=Object(ye.useLocation)(),t=new URLSearchParams(e).get("tab"),n=Ce(),a=ge((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),o=["account","security"].find((e=>e===t))||"information",{finishLoading:r}=we();return Object(s.useEffect)((()=>{void 0===a?n():a&&r("Settings")}),[r,n,a]),a?Object(Ne.jsxs)(En,{className:ia.a.container,children:[Object(Ne.jsx)(Qe,{children:Object(Ne.jsxs)("div",{className:ia.a.wrapper,children:[Object(Ne.jsx)("div",{className:ia.a.header,children:Object(Ne.jsxs)("h1",{className:ia.a.title,children:["information"===o&&"Main Information","security"===o&&"Security","account"===o&&"Account"]})}),"information"===o&&Object(Ne.jsx)(la,{}),"security"===o&&Object(Ne.jsx)(da,{}),"account"===o&&Object(Ne.jsx)(ca,{})]})}),Object(Ne.jsx)(Ln,{items:[{text:"Information",to:"/settings"},{testId:"settings-security-btn",text:"Security",to:"?tab=security"},{testId:"settings-account-btn",text:"Account",to:"?tab=account"}]})]}):null}n(128);const ma=()=>document.documentElement.style.setProperty("--page-height",window.innerHeight+"px");function ba(){return window.history.scrollRestoration="manual",Object(Ne.jsx)(i.a,{children:Object(Ne.jsx)(r.a,{store:xe,children:Object(Ne.jsxs)(o.b.Provider,{value:{style:{flexShrink:0}},children:[Object(Ne.jsx)(_n,{}),Object(Ne.jsx)(es,{}),Object(Ne.jsx)(Ct,{}),Object(Ne.jsx)("main",{className:d.a.main,children:Object(Ne.jsxs)(Ot,{className:d.a.pageWidth,children:[Object(Ne.jsx)(ln,{}),Object(Ne.jsxs)(c.Switch,{loadingScreen:()=>Object(Ne.jsx)(Lt,{className:d.a.loading}),children:[Object(Ne.jsx)(c.Route,{component:Ss,exact:!0,path:"/"}),Object(Ne.jsx)(c.Route,{component:rs,loading:!0,path:"/bookmarks"}),Object(Ne.jsx)(c.Route,{component:ls,loading:!0,path:"/communities"}),Object(Ne.jsx)(c.Route,{component:hs,loading:!0,path:"/community:communityId"}),Object(Ne.jsx)(c.Route,{component:gs,loading:!0,path:"/conversation:conversationId"}),Object(Ne.jsx)(c.Route,{component:ws,loading:!0,path:"/friends:ownerId?"}),Object(Ne.jsx)(c.Route,{component:Rs,loading:!0,path:"/messages"}),Object(Ne.jsx)(c.Route,{component:qs,loading:!0,path:"/news"}),Object(Ne.jsx)(c.Route,{component:As,loading:!0,path:"/photos:ownerId?"}),Object(Ne.jsx)(c.Route,{component:Bs,loading:!0,path:"/post:postId"}),Object(Ne.jsx)(c.Route,{component:na,loading:!0,path:"/id:ownerId"}),Object(Ne.jsx)(c.Route,{component:oa,loading:!0,path:"/search"}),Object(Ne.jsx)(c.Route,{component:ua,loading:!0,path:"/settings"}),Object(Ne.jsx)(c.Route,{component:ms,path:"/"})]})]})}),Object(Ne.jsx)(Bt,{}),Object(Ne.jsx)(wn,{}),Object(Ne.jsx)(Dn,{}),Object(Ne.jsx)(lt,{}),Object(Ne.jsx)(on,{})]})})})}ma(),window.addEventListener("resize",ma);var ja=e=>{e&&e instanceof Function&&n.e(3).then(n.bind(null,138)).then((t=>{let{getCLS:n,getFID:s,getFCP:a,getLCP:o,getTTFB:r}=t;n(e),s(e),a(e),o(e),r(e)}))};Object(a.render)(Object(Ne.jsx)(s.StrictMode,{children:Object(Ne.jsx)(ba,{})}),document.getElementById("app")),ja()}],[[129,1,2]]]);