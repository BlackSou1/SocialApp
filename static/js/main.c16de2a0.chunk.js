(this["webpackJsonpreact-project"]=this["webpackJsonpreact-project"]||[]).push([[0],{10:function(e,t,s){e.exports={notifications_submenu_wrapper:"jsH+a",user_submenu_wrapper:"p8-vI",header:"NXzL8",header_visible:"D19C5",wrapper:"_7R1Vb",logo:"_7bOtT",right:"ZNT+4",changeTheme:"_8YZBL",changeTheme_checked:"fenWx",changeTheme_wrapper:"_9wK7U",changeTheme_iconContainer:"HCGGD",changeTheme_input:"N05lZ",searchBar:"_6lY9N",notifications:"NG2xi",user:"c7q2f",notifications_submenu:"L+7KB",user_submenu:"dSQN1",user_button:"-3m-x",user_button_name:"T-lmu",user_submenu_button:"hCaAB",notifications_button:"Rg669",notifications_button_number:"iVQjb",notifications_button_wrapper:"ud9gz",notifications_submenu_clear:"c84G-",notifications_submenu_item:"+8Ou+",notifications_submenu_item_text:"oniLn",notifications_submenu_item_link:"hV9yn",notifications_submenu_item_remove:"_200d+",notifications_submenu_empty:"W6Ssp"}},17:function(e,t,s){e.exports={container:"sWim0",link:"MYsjU",link_icon:"jcnmp",link_text:"G4H01"}},30:function(e,t,s){e.exports={container:"Dfs75",container_open:"jelgF",wrapper:"_4+LHt",wrapper_open:"bYDRd",link:"He94R",link_icon:"nZXNA"}},31:function(e,t,s){e.exports={innerWrapper:"_3FqdH",pageWidth:"oLzQT",wrapper:"SiTpB",wrapper_open:"F7MRC",icon:"v6BQ9",text:"_2D0S0"}},35:function(e,t,s){e.exports={wrapper:"_0GKre",link:"b7eCA",link_icon:"vNGKn",container:"MAjnn"}},36:function(e,t,s){e.exports={pageWidth:"_3nHVV",button:"x8+CY",button_hidden:"+HKve",container:"MYCOf"}},42:function(e,t,s){e.exports={main:"_2WXj-",pageWidth:"KKVsj"}},50:function(e,t,s){e.exports={container:"tn98w"}},82:function(e,t,s){},83:function(e,t,s){"use strict";s.r(t);var n=s(2),o=s(25),a=s(0),i=s(5),c=s(7),r=s(15),l=(s(67),s(42)),d=s.n(l),u=s(19),m=s(4),b=s(22);let j;function h(){const e=window.innerWidth-document.body.offsetWidth+"px";j=document.querySelectorAll(".fixed-item"),document.body.style.overflow="hidden",document.body.style.marginRight=e,j.forEach((t=>t.style.paddingRight=e))}function f(){var e;document.body.style.overflow="",document.body.style.marginRight="",null===(e=j)||void 0===e||e.forEach((e=>e.style.paddingRight=""))}const v=Object(b.b)({initialState:!1,name:"hamburger",reducers:{closeHamburger:()=>!1,openHamburger:()=>(h(),!0)}});var p=v.reducer;const{closeHamburger:O,openHamburger:x}=v.actions;var _=s(26),g=s(12);function y(e,t){let s=0;[...e].forEach((e=>s+=e.charCodeAt(0)));const n=n=>(s+e.length+parseInt(t.toString(),36)%(n+1)**2)%26+(2===n?0:10),o=e=>e.toString(36),a=n(1),i=n(2),c=n(3),r=n(4);let l="";return[...e].forEach(((e,t)=>{l+=String.fromCharCode(e.charCodeAt(0)+a+i+c+r-Math.min(t%60,t%65,t%70))})),l=btoa(l),l[0]+o(a)+o(i)+o(c)+l.slice(1,-2)+o(r)+l.slice(-2)}function N(e){const t=parseInt(e[1],36),s=parseInt(e[2],36),n=parseInt(e[3],36),o=parseInt(e[e.length-3],36),a=e[0]+e.slice(4,-3)+e.slice(-2);let i="";return[...atob(a)].forEach(((e,a)=>{i+=String.fromCharCode(e.charCodeAt(0)-t-s-n-o+Math.min(a%60,a%65,a%70))})),i}var w=s(48),k=s(32);Object(w.a)({apiKey:N("mpipaDQtqfMlLqnhbeCgLaZk5aos7aSibO5j3WYf3Nzr4x/gJiHpXkh/"),authDomain:"social-app-bs.firebaseapp.com",databaseURL:N("slelLu6tbd9cXCzrqGmnadnmqinY5enYJaWlpCjmaBYnJ2MiVSKmZWRkYVMlYKPj0tHfoCIenZ0hXZ0cIJuqqi5qnKpt7gY="),projectId:"social-app-bs",storageBucket:"social-app-bs.appspot.com",messagingSenderId:"129896299882",appId:"1:129896299882:web:7bf515fc32dcf9a735f913"});const I=Object(g.b)(),C=Object(k.c)(),S=Object(g.n)(),$={delete:e=>Object(k.a)(Object(k.d)(C,e)),getDownloadURL:e=>Object(k.b)(e),upload:(e,t,s)=>Object(k.e)(Object(k.d)(C,e),t,s)};var E=s(49);const T=Object(b.b)({initialState:{activeModals:[],currentModal:null,gallery:null},name:"modal",reducers:{closeAllModals(e){f(),e.activeModals=[],e.currentModal=null},closeModal(e,t){let{payload:s}=t;e.activeModals.includes(s)&&(e.activeModals.splice(e.activeModals.indexOf(s)),e.currentModal=e.activeModals[e.activeModals.length-1])},openModal(e,t){var s;let{payload:n}=t;h(),e.activeModals.push(n.name),e.currentModal=n.name,e.actionConfirm=n.opts.actionConfirm,e.actionError=n.opts.actionError,e.changeAvatarCommunityId=n.opts.changeAvatarCommunityId,n.opts.gallery&&(e.gallery=n.opts.gallery),(null===(s=n.opts.zoom)||void 0===s?void 0:s.img)&&(e.zoom={img:n.opts.zoom.img,alt:n.opts.zoom.alt||""})}}}),{closeAllModals:L,closeModal:P,openModal:R}=T.actions,D=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return R({name:e,opts:t})};var M=T.reducer;const A=Object(b.b)({initialState:null,name:"toast",reducers:{closeToast:()=>null,openToast:(e,t)=>{let{payload:s}=t;return{icon:s.icon,msg:s.msg}}}}),{closeToast:q,openToast:B}=A.actions,F=(e,t)=>B({icon:t,msg:e});var z=A.reducer;function H(e,t){const s=new Date(e),n=Date.now()+xe.getState().timeOffset,o=new Date(n),a=(n-e)/1e3,i=a/60,c=i/60,r=s;return a<1?"just now":i<1?`${G("second",Math.floor(a))} ago`:c<1?`${G("minute",Math.floor(i))} ago`:c<3&&o.getDate()===s.getDate()?`${G("hour",Math.floor(c))} ago`:c<24&&o.getDate()===s.getDate()?t?"today":`today at ${r.getHours()}:${r.getMinutes()<10?0:""}${r.getMinutes()}`:c<48&&new Date(n-864e5).getDate()===s.getDate()?t?"yesterday":`yesterday at ${r.getHours()}:${r.getMinutes()<10?0:""}${r.getMinutes()}`:o.getFullYear()===s.getFullYear()?t?`${r.toLocaleString("en-US",{month:"long"})} ${r.getDate()}`:`${r.toLocaleString("en-US",{month:"long"})} ${r.getDate()} at ${r.getHours()}:${r.getMinutes()<10?0:""}${r.getMinutes()}`:t?`${r.toLocaleString("en-US",{month:"long"})} ${r.getDate()}, ${r.getFullYear()}`:`${r.toLocaleString("en-US",{month:"long"})} ${r.getDate()}, ${r.getFullYear()} at ${r.getHours()}:${r.getMinutes()<10?0:""}${r.getMinutes()}`}const U=e=>{let{reqUserId:t,userId:s}=e;const n=`users/user${t}/`,o=`users/user${s}/`;ie().update({[`${n}friendRequests/sent/user${s}`]:null,[`${n}friends/user${s}`]:{friendAddDate:S,userId:s},[`${o}friendRequests/received/user${t}`]:null,[`${o}friends/user${t}`]:{friendAddDate:S,userId:t},[o+"fullInfo/followerCount"]:Object(g.e)(-1),[o+"notifications/friendRequest"+t]:null}).then((()=>xe.dispatch(F("Friend request accepted.",m.Q))))},Y=e=>{ie("posts").orderByChild("authorId").equalTo(e).once((t=>{const s=`users/user${e}/`,n=s+"fullInfo/",o={[n+"birthday"]:null,[n+"city"]:null,[n+"country"]:null,[n+"status"]:null,[s+"account"]:{deleted:!0,id:e},[s+"bookmarks"]:null,[s+"connections"]:null,[s+"info"]:{avatar:"img/user-deleted.svg",deleted:!0,gender:null,id:e,lastName:"account",lastSeen:null,name:"Deleted"},[s+"profilePhotos"]:null};Object.values({...t}).forEach((e=>o["posts/post"+e.id]=null)),ie().update(o)}))},V=(e,t,s)=>{xe.dispatch(D("action-confirm",{actionConfirm:{callback:()=>{ie("posts").orderByChild("communityId").equalTo(e).once((n=>{const o=`communities/community${e}/`,a={[o+"fullInfo"]:null,[o+"info"]:{avatar:"img/community-deleted.svg",deleted:!0,id:e,subscriberCount:s||null,title:"Deleted community"},[o+"profilePhotos"]:null};Object.values({...n}).forEach((e=>a["posts/post"+e.id]=null)),ie().update(a).then((()=>xe.dispatch(F("Community deleted.",m.F)))),t&&$.delete(t)}))},irreversible:!0,password:!0,text:"Are you sure you want to delete this community?"}}))};function W(e){for(const t in e)e[t]=e[t].trim();return e}const K=e=>e.info.deleted?"This user account has been removed":e.connections?"Online":"Last seen "+H(e.info.lastSeen),Z=e=>{let{condition:t,contentId:s,contentPath:n,redirect:o,userId:a,userPath:i}=e;if(!a)return void o();const c=n+"/likeCounter",r=`${n}/likes/user${a}`,l=`users/user${a}/likes/${i}`;t?ie().update({[c]:Object(g.e)(-1),[r]:null,[l]:null}):ie().update({[c]:Object(g.e)(1),[r]:{date:S,userId:a},[l]:{date:S,id:s}})},Q=e=>{throw xe.dispatch(F("Permission denied.",m.r)),e},G=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"s";return`${t} ${e}${1!==t?s:""}`},J=(e,t)=>{ie(`users/user${e}/info/avatar`).set(t).then((()=>xe.dispatch(F("Avatar updated.",m.G))))},X=e=>{document.cookie=`USER_DATA=${JSON.stringify(e)||""}; expires=${e?new Date(Date.now()+31536e6):new Date}`},ee=(e,t,s,n)=>{if(!s)return void t();const o="communities/community"+e,a=`${o}/subscribers/user${s}`,i=o+"/info/subscriberCount",c=`users/user${s}/communities/subscribed/community${e}`;n?ie().update({[i]:Object(g.e)(-1),[a]:null,[c]:null}):ie().update({[i]:Object(g.e)(1),[a]:s,[c]:{date:S,id:e}})},te=e=>e?localStorage.setItem("darkTheme","true"):localStorage.removeItem("darkTheme"),se=()=>localStorage.getItem("darkTheme"),ne=()=>{const e=localStorage.getItem("darkTheme"),t=document.querySelector("meta[name=theme-color]");document.documentElement.classList[e?"add":"remove"]("dark"),t&&(t.content=e?"#1773a8":"#22aeff")},oe=async e=>{let{addToPhotos:t,callback:s,communityId:n,createId:o=!0,file:a,imgParent:i,imgPath:c="photos",index:r,setLoadingPercentage:l,storagePrefix:d="",userId:u}=e;const m=o?ie().newKey():c,b=await Object(E.a)(a,{initialQuality:.7,maxWidthOrHeight:3840}),j=b.name.split(".").slice(-1),h=`img/${d?`${d}_`:""}${m}.${j}`,f=$.upload(h,b,{cacheControl:"public, max-age=36000"});f.on("state_changed",(e=>{const t=Math.floor(e.bytesTransferred/e.totalBytes*100);null===l||void 0===l||l(t,r)}),(()=>xe.dispatch(D("action-error",{actionError:"Failed to load image to our database. Try again."}))),(()=>$.getDownloadURL(f.snapshot.ref).then((e=>new Promise((()=>{const a=n?`communities/community${n}`:`users/user${u}`,l={[`${a}/${i?`${i}/`:""}${c}${o?`/${m}`:""}`]:{date:S,id:o?m:null,src:e},...t&&{[`${a}/profilePhotos/${m}`]:{id:m}}};ie().update(l),null===s||void 0===s||s({id:m,index:r||0,link:e})}))))))},ae=e=>Object(g.l)(I,e);function ie(e){const t=(e,t,s)=>Object(g.g)(e,(e=>t(e.val())),{onlyOnce:s}),s=e=>({equalTo:s=>({on:n=>t(Object(g.k)(e,Object(g.a)(s)),n),once:n=>t(Object(g.k)(e,Object(g.a)(s)),n,!0)})});return{newKey:()=>Object(g.j)(ae()).key,on:s=>t(ae(e),s),once:s=>t(ae(e),s,!0),onDisconnect:()=>Object(g.f)(ae(e)),orderByChild:t=>s(Object(g.k)(ae(e),Object(g.h)(t))),orderByValue:()=>s(Object(g.k)(ae(e),Object(g.i)())),push:()=>Object(g.j)(ae(e)),reconnect(){Object(g.c)(I),Object(g.d)(I)},remove:()=>Object(g.m)(ae(e)).catch(Q),set:t=>Object(g.o)(ae(e),t).catch(Q),update:t=>Object(g.p)(ae(e),t).catch(Q)}}function ce(){const e=N("0tmtNva1dedkZDHxM3Jy767zcHGxIK4tYC0v7x9t7+6uHiuqXl7d3l5cW2kcG+daGtqnZljlmhpZl5laJRkmJ2YnZWYnZo0=");return new Promise((t=>fetch(e).then((e=>e.json())).then((e=>t({city:e.city,country:e.country_name,ip:e.IPv4})))))}function re(e){ce().then((t=>{const s=`ipAddresses/${e}/${t.ip.split(".").join("\u2024")}/`;ie().update({[s+"city"]:t.city,[s+"country"]:t.country,[`${s}visits/${ie().newKey()}`]:S})}))}function le(e){let{callback:t,community:s,fields:n=["info"],userId:o}=e;const a={},i=[],c=n.map((e=>{const t=e.split("/");return t[t.length-1]}));return n.forEach(((e,n)=>{i.push(ie(`${s?"communities/community":"users/user"}${o}/${e}`).on((e=>{a[c[n]]=e,c.map((e=>a[e])).includes(void 0)||t(a.info?{...a}:null)})))})),()=>i.forEach((e=>e()))}const de=Object(b.b)({initialState:0,name:"timeOffset",reducers:{setTimeOffset:(e,t)=>{let{payload:s}=t;return s}}});var ue=de.reducer;const{setTimeOffset:me}=de.actions,be=Object(b.b)({initialState:{account:{id:null}},name:"user",reducers:{logIn(e,t){let{payload:s}=t;return X({id:s.account.id,password:N(s.account.password)}),localStorage.setItem("loggedIn","true"),s},logOut:()=>(X(),localStorage.removeItem("loggedIn"),null),logSync(e,t){let{payload:s}=t;return"true"!==localStorage.getItem("loggedIn")?(X(),null):s}}});var je=be.reducer;const{logIn:he,logOut:fe,logSync:ve}=be.actions,pe=Object(_.b)({hamburger:p,modal:M,timeOffset:ue,toast:z,user:je}),Oe=Object(b.a)({devTools:!1,middleware:Object(b.c)({serializableCheck:!1}),reducer:pe});var xe=Oe;const _e=i.c;ie(".info/serverTimeOffset").on((e=>Oe.dispatch(me(e))));let ge=Date.now();setInterval((()=>{Math.abs(Date.now()-ge)>6e3&&ie().reconnect(),ge=Date.now()}),5e3);var ye=s(30),Ne=s.n(ye),we=s(1);function ke(){const e=Object(i.b)(),t=_e((e=>e.hamburger)),s=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),o=Object(n.useRef)(null),[a,r]=Object(n.useState)(!0),l=Object(n.useCallback)((()=>{r(!1),e(O())}),[e]);const d=Object(n.useCallback)((e=>{"Escape"===e.key&&t&&l()}),[l,t]);return Object(n.useEffect)((()=>(window.addEventListener("keydown",d),()=>window.removeEventListener("keydown",d))),[d]),s?Object(we.jsx)("div",{className:Object(u.a)(Ne.a.container,(!a||t)&&Ne.a.container_open),onClick:l,children:Object(we.jsx)("div",{className:Object(u.a)(Ne.a.wrapper,t&&Ne.a.wrapper_open),onClick:e=>e.stopPropagation(),onTransitionEnd:function(e){t||e.target!==o.current||"transform"!==e.nativeEvent.propertyName||(r(!0),f())},ref:o,children:Object(we.jsx)("nav",{children:[{icon:m.S,text:"Communities",to:"/communities"},{icon:m.b,text:"Bookmarks",to:"/bookmarks"},{icon:m.I,text:"Search",to:"/search"}].map((e=>Object(we.jsxs)(c.b,{className:Ne.a.link,to:e.to,onClick:l,children:[Object(we.jsx)(e.icon,{className:Ne.a.link_icon}),Object(we.jsx)("p",{children:e.text})]},e.text)))})})}):null}var Ie=s(14);const Ce=Object(n.createContext)(null);function Se(e){let{openState:t,setOpenState:s,submenuClass:o="submenu",Tag:a=n.Fragment,...i}=e;const c=Object(n.useRef)(null),[r,l]=Object(n.useState)(!1);return null!=t&&s||([t,s]=[r,l]),Object(we.jsx)(Ce.Provider,{value:{buttonRef:c,openState:t,setOpenState:s,submenuClass:o},children:Object(we.jsx)(a,{...i})})}function $e(e){let{Tag:t,...s}=e;const{buttonRef:o,openState:a,setOpenState:i,submenuClass:c}=Object(n.useContext)(Ce);return Object(we.jsx)(t,{...s,ref:o,className:`${s.className} ${c}__button${a?` ${c}__button--open`:""}`,onClick:()=>i(!a)})}function Ee(e){let{Tag:t="div",...s}=e;const{buttonRef:o,openState:a,setOpenState:i,submenuClass:c}=Object(n.useContext)(Ce),r=Object(n.useRef)(),l=Object(n.useCallback)((e=>{!o.current||o.current.contains(e.target)||r.current.contains(e.target)||i(!1)}),[o,i]);return Object(n.useEffect)((()=>(window.addEventListener("click",l),()=>window.removeEventListener("click",l))),[l]),Object(we.jsx)(t,{...s,ref:r,className:`${s.className} ${c}__wrapper${a?` ${c}__wrapper--open`:""}`})}var Te=s(18);function Le(){const e=Object(n.useContext)(r.LoadingContext),t=Object(n.useRef)({incrementQty(e,t){this.qty.includes(e)||(this.qty.push(e),this.qty.length===this.expectedQty&&t())},setExpected(e,t){this.expectedQty||(this.expectedQty=e,0===this.expectedQty&&(null===t||void 0===t||t()))},qty:[]}),s=Object(n.useRef)(!1),o=Object(n.useCallback)((e=>document.title=e+" | Social App"),[]);return{fetchedItems:t,finishLoading:Object(n.useCallback)((t=>{s.current=!0,e.done(),t&&o(t),window.scrollTo(0,0),setTimeout((()=>window.dispatchEvent(new Event("loadFinished"))),0)}),[e,o]),loaded:s,setTitle:o}}function Pe(){const e=Object(n.useRef)(!1),[t,s]=Object(n.useState)(!1),o=Object(n.useCallback)((function(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e.current=t,s(t)}),[]);return{AsyncButton:Object(n.useCallback)((e=>Object(we.jsx)(He,{loading:t,...e})),[t]),buttonLoading:t,buttonLoadingRef:e,setButtonLoading:o}}function Re(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const[t,s]=Object(n.useState)([]),o=n=>{const o=[...n.target.files];e||(o.length=1);let a=o.length;n.target.value="";const i=[];o.forEach((e=>{let n,o;["jpg","jpeg","png"].includes(e.name.split(".").pop().toLowerCase())||(o=!0,a--);const c={lastModified:e.lastModified,name:e.name,size:e.size,type:e.type};for(const s of t)if(JSON.stringify(s.props)===JSON.stringify(c)){n=!0,a--;break}if(!n||!o){const n=new FileReader;n.onload=()=>{i.push({props:c,file:e,result:n.result}),i.length===a&&s([...t,...i])},n.readAsDataURL(e)}}))};return{addImgPreview:o,imgPreview:t,setImgPreview:s}}function De(){const{push:e}=Object(Ie.useHistory)(),{hash:t,pathname:s,search:o}=Object(Ie.useLocation)();return Object(n.useCallback)((()=>e("/?from="+encodeURIComponent(s+o+t))),[t,s,e,o])}r.topbar.config({barColors:{0:"rgba(128, 215, 255, 1)"},className:"loading-bar",shadowBlur:5,shadowColor:"rgba(0, 0, 0, 1)"});var Me=[{id:"name",name:"name",title:"Name",errors:{maxLength:{value:32,message:"A name cannot contain more than 32 characters"},required:"Enter your name"}},{id:"lastName",name:"lastName",title:"Last name",errors:{maxLength:{value:32,message:"A last name cannot contain more than 32 characters"},required:"Enter your last name"}},{id:"birthday",getMax:()=>({message:"A birthday cannot be a date in the future",value:new Date(Date.now()+xe.getState().timeOffset).toISOString().split("T")[0]}),min:"1900-01-01",name:"birthday",title:"Birthday",type:"date",errors:{min:{value:"1900-01-01",message:"A birthday cannot contain a year less than 1900"}}},{id:"country",name:"country",title:"Country",errors:{maxLength:{value:56,message:"A country cannot contain more than 56 characters"}}},{id:"city",name:"city",title:"City",errors:{maxLength:{value:85,message:"A city cannot contain more than 85 characters"}}},{autoComplete:"off",id:"status",name:"status",title:"Status",errors:{maxLength:{value:80,message:"A status cannot contain more than 80 characters"}}},{id:"email",name:"email",title:"Email",type:"email",errors:{maxLength:{value:320,message:"An email cannot contain more than 320 characters"},pattern:{value:/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/,message:"Enter a correct email address!"},required:"Enter an email address"}},{id:"password",name:"password",type:"password",title:"Password",autoComplete:"new-password",errors:{maxLength:{value:128,message:"A password cannot contain more than 128 characters"},minLength:{value:2,message:"A password must be at least 2 characters long"},pattern:{value:/^[a-zA-Z0-9!"#$%&'()*+,-./:;<=>?@[\\\]^_`{|}~-]*$/,message:"A password can only contain letters (a-z, A-Z), numbers, and symbols !\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~, and cannot contain spaces"},required:"Enter a password"}},{id:"existingPassword",name:"password",type:"password",title:"Password",errors:{maxLength:{value:128,message:"A password cannot contain more than 128 characters"},required:"Enter your password"}},{id:"confirmPassword",name:"password",type:"password",title:"Confirm password",autoComplete:"new-password",errors:{maxLength:{value:128,message:"A password cannot contain more than 128 characters"},required:"Confirm your password"}},{id:"title",name:"title",title:"Title",errors:{maxLength:{value:32,message:"A title cannot contain more than 32 characters"},required:"Enter community title"}},{id:"description",name:"text",title:"Description",errors:{maxLength:{value:256,message:"A description cannot contain more than 256 characters"}}},{id:"shortDescription",name:"text",title:"Short description",errors:{maxLength:{value:100,message:"A short description cannot contain more than 100 characters"}}}];const Ae=e=>{let{register:t,userGender:s}=e;return Object(we.jsxs)("div",{className:"gender",children:[Object(we.jsx)("h4",{className:"gender__title",children:"Gender"}),Object(we.jsx)("div",{className:"gender__items",children:["Male","Female"].map((e=>Object(we.jsxs)("label",{className:"gender__item",children:[Object(we.jsx)("input",{className:"gender__input",defaultChecked:e.toLowerCase()===(s||"male"),type:"radio",value:e.toLowerCase(),...t("gender")}),Object(we.jsx)("p",{className:"gender__text",children:e})]},e)))})]})};var qe=e=>{let{opts:{defaultValue:t,errors:s,label:o,labelText:a,obj:i,placeholder:c,register:r},...l}=e;const[d,u]=Object(n.useState)(!1);i.getMax&&(i.errors.max=i.getMax());const b={id:i.id,autoCapitalize:["password","email"].includes(i.name)?"off":"on",autoComplete:i.autoComplete||"on",defaultValue:t||"",placeholder:c?i.title:"",spellCheck:!["password","email"].includes(i.name),...l};return Object(we.jsxs)("div",{className:"primary-form__item",children:[o&&Object(we.jsx)("label",{className:"primary-form__label",htmlFor:l.id||i.id,children:a||i.title}),["password","existingPassword"].includes(i.id)?Object(we.jsxs)("div",{className:"primary-form__password",children:[Object(we.jsx)("input",{className:"primary-form__input-password primary-form__input",type:d?"text":"password",...b,...r("password",i.errors)}),Object(we.jsx)("button",{className:"primary-form__password-show",type:"button","aria-label":"Toggle password visibility",onClick:()=>u(!d),children:d?Object(we.jsx)(m.z,{size:"1.25em"}):Object(we.jsx)(m.A,{size:"1.25em"})})]}):Object(we.jsx)("input",{className:"primary-form__input",type:i.type||"text",...b,...r(i.id,{...i.errors,validate:e=>{if(i.errors.required&&!e.trim())return i.errors.required}})}),s[i.id]&&Object(we.jsx)("p",{className:"error-text",children:s[i.id].message})]})};const Be=e=>{let{community:t,nameIsLink:s=!0,onClick:n,onlyName:o,text:a,textLink:i,userInfo:r}=e;const l=s?c.b:"h4",d=i?c.b:"p";return Object(we.jsxs)("div",{className:"author-info",children:[Object(we.jsx)(l,{className:"author-info__name",to:s?`/${t?"community":"id"}${r.id}`:null,onClick:n,children:r.title||r.name+(o?"":` ${r.lastName}`)}),a&&Object(we.jsx)(d,{className:"author-info__text",to:i,children:a})]})},Fe=e=>{var t,s,o,a,i;let{community:r,enablePreview:l=!0,onClick:d,size:u="medium",src:m,userId:b}=e;const j=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),h=Object(n.useRef)(),f=Object(n.useRef)(),[v,p]=Object(n.useState)(null),O=e=>{let{link:t,qty:s,renderZero:n,text:o}=e;const a=t?c.b:"div";if(n||s)return Object(we.jsxs)(a,{className:"avatar__preview-footer-item"+(t?" avatar__preview-footer-button":""),to:t,onClick:d,children:[Object(we.jsx)("p",{className:"avatar__preview-footer-item-number",children:s}),Object(we.jsx)("p",{className:"avatar__preview-footer-item-title",children:o})]})};function x(){_(),h.current=setTimeout((()=>{f.current=le({callback:p,community:r,fields:r?["fullInfo","info"]:["connections","friends","fullInfo","info","profilePhotos"],userId:b})}),100)}function _(){var e;clearTimeout(h.current),null===(e=f.current)||void 0===e||e.call(f)}return Object(n.useEffect)((()=>_),[]),Object(we.jsxs)("div",{className:"avatar"+(v?" avatar--preview-loaded":""),onMouseEnter:l?x:void 0,onMouseLeave:l?_:void 0,onTouchStart:l?x:void 0,onTouchEnd:l?_:void 0,children:[Object(we.jsx)(c.b,{className:"avatar__link",to:`/${r?"community":"id"}${b}`,onClick:d,onMouseDown:l?_:void 0,children:Object(we.jsx)("img",{className:`avatar__img-${u} avatar__img`,src:m,alt:"Avatar"})}),Object(we.jsx)("div",{className:"avatar__preview",children:l&&v&&Object(we.jsxs)("div",{className:"avatar__preview-wrapper",children:[Object(we.jsx)("div",{className:"avatar__preview-header",children:Object(we.jsx)(c.b,{className:"avatar__preview-header-name",to:`/${r?"community":"id"}${b}`,children:v.info.title||`${v.info.name} ${v.info.lastName}`})}),Object(we.jsxs)("div",{className:"avatar__preview-middle",children:[r?Object(we.jsx)("p",{className:"avatar__preview-middle-subscribers",children:G("subscriber",v.info.subscriberCount||0)}):Object(we.jsx)("p",{className:"avatar__preview-middle-online-status",children:K(v)}),Object(we.jsx)("p",{className:"avatar__preview-middle-description",children:r?null===(t=v.fullInfo)||void 0===t?void 0:t.description:null===(s=v.fullInfo)||void 0===s?void 0:s.status}),Object(we.jsx)("p",{className:"avatar__preview-middle-location",children:((null===(o=v.fullInfo)||void 0===o?void 0:o.city)?`${v.fullInfo.city}, `:"")+((null===(a=v.fullInfo)||void 0===a?void 0:a.country)?v.fullInfo.country:"")})]}),Object(we.jsxs)("div",{className:"avatar__preview-footer",children:[O({link:`/friends${b!==j?b:""}`,qty:Object.keys({...v.friends}).length,text:"friends"}),O({qty:null===(i=v.fullInfo)||void 0===i?void 0:i.followerCount,text:"followers"}),O({link:`/photos${b!==j?b:""}`,qty:Object.keys({...v.profilePhotos}).length,text:"photos"})]})]})})]})},ze=e=>{let{avatar:t,userInfo:s}=e;const n=Object(i.b)();return s.avatar.endsWith(".svg")?Object(we.jsx)("div",{className:"avatar-gallery-btn--default",children:Object(we.jsx)("img",{className:"avatar-gallery-btn__img",src:s.avatar,alt:"Avatar"})}):Object(we.jsx)(c.b,{className:"avatar-gallery-btn",to:"#javascript",onClick:e=>{n(D("gallery",{gallery:{authorInfo:s,content:[t],initialSlide:0}})),e.preventDefault()},children:Object(we.jsx)("img",{className:"avatar-gallery-btn__img",src:s.avatar,alt:"Avatar"})})},He=e=>{let{afterIcon:t,beforeIcon:s,className:n="",href:o,iconStyles:a,loading:i,preset:r="primary",onClick:l,testId:d,text:u,to:m,type:b="button"}=e;const j=o?"a":m?c.b:"button",h=e=>e&&Object(we.jsx)(e,{className:`${n&&n+"__icon "}${r}-button__icon button__icon `,size:null===a||void 0===a?void 0:a.size,style:{height:null===a||void 0===a?void 0:a.height,width:null===a||void 0===a?void 0:a.width}});return Object(we.jsxs)(j,{className:`${n&&n+" "}${r}-button button${i?" button--loading":""}`,href:o,to:m,type:"button"===j?b:null,onClick:l,children:[i&&Object(we.jsxs)("div",{className:"button__loading loading-spinner",children:[Object(we.jsx)("div",{}),Object(we.jsx)("div",{}),Object(we.jsx)("div",{}),Object(we.jsx)("div",{})]}),h(s),Object(we.jsx)("p",{className:`${n&&n+"__text "}${r}-button__text button__text`,children:u}),h(t)]})},Ue=e=>{let{className:t,databaseRef:s,disabled:o,emptyButtonText:a,emptyFieldText:c,field:r,ownerId:l,renderInputId:d}=e;const u=Object(i.b)(),{formState:{errors:b},handleSubmit:j,register:h,reset:f}=Object(Te.a)(),v=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),[p,O]=Object(n.useState)(!1);return Object(we.jsx)("div",{className:(t?`${t} `:"")+"editable-field",children:l!==v||o?Object(we.jsx)("p",{className:(t?`${t}__text `:"")+"editable-field__text",children:r||c}):p?Object(we.jsxs)("form",{className:(t?`${t}__form `:"")+"editable-field__form",action:"#",method:"post",onSubmit:j((function(e){ie(s).set(e[d].trim()||null).then((()=>u(F("Field updated.",m.l)))),O(!1)})),children:[Object(we.jsx)(qe,{autoFocus:!0,opts:{obj:Me.find((e=>e.id===d)),defaultValue:r,errors:b,placeholder:!0,register:h}}),Object(we.jsxs)("div",{className:(t?`${t}__form-buttons `:"")+"editable-field__form-buttons",children:[Object(we.jsx)(He,{text:"Save",type:"submit"}),Object(we.jsx)(He,{preset:"secondary",text:"Cancel",onClick:()=>O(!1)})]})]}):Object(we.jsxs)("button",{className:(t?`${t}__button `:"")+"editable-field__button",onClick:()=>{O(!0),f()},children:[Object(we.jsx)("div",{className:(t?`${t}__icon-container `:"")+"editable-field__icon-container",children:Object(we.jsx)(m.l,{className:(t?`${t}__icon `:"")+"editable-field__icon",size:"1.15em"})}),Object(we.jsx)("p",{className:(t?`${t}__text `:"")+"editable-field__text",children:r||a})]})})},Ye=e=>{let{bookmarkType:t,children:s,itemId:n}=e;const o="community"===t?"communities":t+"s",a=Object(i.b)(),c=De(),r=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),l=_e((e=>{var s,a,i,c;return null===(s=e.user)||void 0===s||null===(a=s.bookmarks)||void 0===a||null===(i=a[o])||void 0===i||null===(c=i[t+n])||void 0===c?void 0:c.id}));return Object(we.jsxs)("div",{className:"interaction-submenu",children:[Object(we.jsx)("div",{className:"interaction-submenu__icon-container",tabIndex:0,children:Object(we.jsx)(m.e,{className:"interaction-submenu__icon",style:{width:".9em"}})}),Object(we.jsxs)("div",{className:"interaction-submenu__wrapper",children:[Object(we.jsx)(He,{text:(l?"Remove from":"Add to")+" bookmarks",onClick:()=>{if(!r)return void c();const e=ie(`users/user${r}/bookmarks/${o}/${t+n}`);l?e.remove().then((()=>a(F("Item removed from bookmarks.",m.v)))):e.set({date:S,id:n}).then((()=>a(F("Item added to bookmarks.",m.v))))}}),s]})]})},Ve=e=>{let{className:t,link:s,onChange:n,onSubmit:o,value:a}=e;const i=s?c.b:"button";return Object(we.jsxs)("form",{className:Object(u.a)("search-bar",t),action:"#",method:"post",onSubmit:o,children:[Object(we.jsx)("input",{className:"search-bar__input primary-form__input",type:"text",name:"search",placeholder:"Search...",value:a,onChange:n}),Object(we.jsx)(i,{className:"search-bar__button",to:s&&"/search?query="+encodeURIComponent(a),children:Object(we.jsx)(m.I,{className:"search-bar__button-icon"})})]})},We=e=>{let{addToPhotosHandler:t,community:s,imgPreview:n,loadingPercentage:o,removeOnClick:a}=e;const c=Object(i.b)(),r=Number.isInteger(o);return Object(we.jsxs)("div",{className:"upload-preview",children:[Object(we.jsxs)("div",{className:"upload-preview__header",children:[!r&&Object(we.jsx)("button",{className:"upload-preview__header-remove",type:"button","aria-label":"Remove photo",onClick:a,children:"\xd7"}),Object(we.jsxs)("button",{className:"upload-preview__header-img-container",type:"button",onClick:()=>c(D("zoom",{zoom:{img:n.result,alt:""}})),children:[Object(we.jsx)("img",{className:"upload-preview__header-img",src:n.result,alt:""}),r&&Object(we.jsxs)("div",{className:"upload-preview__header-img-overlay",children:[Object(we.jsx)("div",{className:"upload-preview__header-img-overlay-loading",style:{width:o+"%"}}),Object(we.jsx)("p",{className:"upload-preview__header-img-overlay-text",children:o+"%"})]})]})]}),Object(we.jsx)("div",{className:"upload-preview__footer",children:Object(we.jsxs)("div",{className:"upload-preview__footer-wrapper",children:[Object(we.jsx)("h4",{className:"upload-preview__title upload-preview__footer-item",children:n.props.name}),t&&Object(we.jsxs)("label",{className:"upload-preview__checkbox upload-preview__footer-item",children:[Object(we.jsx)("input",{className:"upload-preview__checkbox-input",disabled:r,type:"checkbox",name:"checkbox",onChange:t}),Object(we.jsx)("p",{className:"upload-preview__checkbox-text",children:`Add to ${s?"community":"my"} photos`})]})]})})]})},Ke=e=>{let{avatarSize:t="medium",bottomText:s,bottomTextLink:n,children:o,childrenBottom:a,community:i,enableAvatarPreview:r,linksOnClick:l,userInfo:d,wrapperLink:u}=e;const m=u?c.b:"div";return Object(we.jsxs)("div",{className:"user",children:[Object(we.jsx)(Fe,{community:i,enablePreview:r,size:t,src:d.avatar,userId:d.id,onClick:l}),Object(we.jsxs)(m,{className:"user__wrapper",to:u,children:[Object(we.jsxs)("div",{className:"user__header",children:[Object(we.jsx)(Be,{community:i,nameIsLink:!u,text:s,textLink:n,userInfo:d,onClick:l}),o]}),a&&Object(we.jsx)("div",{className:"user__bottom",children:a})]})]})};let Ze,Qe,Ge,Je=!1,Xe=!1;function et(){Xe||(Xe=!0,re("guests"))}var tt=()=>e=>{var t,s;null===(t=Qe)||void 0===t||t(),null===(s=Ge)||void 0===s||s(),document.cookie.split(";").forEach((t=>{function s(){e(fe()),e(L()),Je=!1}function n(){e(ve(null)),e(L()),Je=!1}try{Ze=JSON.parse(t.replace("USER_DATA=",""))}catch(o){return n(),void et()}if(!Ze.id||"true"!==localStorage.getItem("loggedIn"))return n(),void et();Ge=ie(`users/user${Ze.id}/account`).orderByValue().equalTo(y(Ze.password,Ze.id)).on((t=>{var o;null===(o=Ge)||void 0===o||o(),t?Qe=le({callback:t=>{if(null===t||void 0===t?void 0:t.account){var n;if(t.account.deleted)return void s();e(ve(t)),te(!!(null===(n=t.account.preferences)||void 0===n?void 0:n.darkTheme)),ne(),!Je&&e(L()),Je=!0}else s()},fields:["account","bookmarks","communities","conversations","friendRequests","fullInfo","info","notifications","photos","profilePhotos"],userId:Ze.id}):n()}))}))},st=s(50),nt=s.n(st);function ot(e){let{children:t,className:s}=e;return Object(we.jsx)("div",{className:Object(u.a)(nt.a.container,s),children:t})}var at=s(10),it=s.n(at);function ct(){const e=Object(i.b)(),t=Object(Ie.useHistory)(),s=_e((e=>{var t,s;return null===(t=e.user)||void 0===t||null===(s=t.info)||void 0===s?void 0:s.avatar})),o=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),a=_e((e=>{var t,s;return null===(t=e.user)||void 0===t||null===(s=t.info)||void 0===s?void 0:s.name})),r=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.notifications})),[l,d]=Object(n.useState)(!0),[b,j]=Object(n.useState)(!1),[h,f]=Object(n.useState)(""),[v,p]=Object(n.useState)(!1);return Object(n.useEffect)((()=>{let e=window.pageYOffset;function t(){const t=window.innerWidth>768,s=t?50:10,n=window.pageYOffset-e,o=window.pageYOffset>(t?200:40);function a(t){e=window.pageYOffset,document.documentElement.style.setProperty("--header-offset",t?"":"0px"),d(t)}n>s&&o?a(!1):n<-s&&a(!0)}return window.addEventListener("scroll",t),()=>window.removeEventListener("scroll",t)}),[]),Object(n.useEffect)((()=>{se()&&(document.body.classList.add("disable-transition"),ne(),document.body.scrollHeight,document.body.classList.remove("disable-transition"))}),[]),Object(we.jsx)("header",{className:Object(u.a)(it.a.header,l&&it.a.header_visible,"fixed-item"),children:Object(we.jsx)(ot,{children:Object(we.jsxs)("div",{className:it.a.wrapper,children:[Object(we.jsx)(c.b,{className:it.a.logo,to:o?"/news":"/","aria-label":"Homepage",children:"Social App"}),Object(we.jsxs)("div",{className:it.a.right,children:[Object(we.jsx)(Ve,{className:it.a.searchBar,link:!0,value:h,onChange:e=>f(e.target.value),onSubmit:function(e){e.preventDefault(),t.push(`/search?query=${encodeURIComponent(h)||""}`)}}),void 0===o&&Object(we.jsx)(lt,{}),o&&Object(we.jsxs)(we.Fragment,{children:[Object(we.jsxs)(Se,{className:it.a.user,openState:v,setOpenState:p,Tag:"div",children:[Object(we.jsxs)($e,{className:it.a.user_button,Tag:"button",children:[Object(we.jsx)("p",{className:it.a.user_button_name,children:a}),Object(we.jsx)("img",{className:"avatar__img-small",src:s,alt:"Avatar"}),Object(we.jsx)(m.e,{})]}),Object(we.jsx)(Ee,{className:it.a.user_submenu,children:Object(we.jsxs)("div",{className:it.a.user_submenu_wrapper,children:[Object(we.jsx)(lt,{}),Object(we.jsx)(c.b,{className:it.a.user_submenu_button,to:"/settings",onClick:()=>p(!1),children:"Settings"}),Object(we.jsx)("button",{className:it.a.user_submenu_button,onClick:function(){p(!1),e(fe()),e(tt()),setTimeout((()=>t[t.location.search.includes("from=")?"replace":"push"]("/")),0)},children:"Log out"})]})})]}),Object(we.jsxs)(Se,{className:it.a.notifications,openState:b,setOpenState:j,Tag:"div",children:[Object(we.jsx)($e,{className:it.a.notifications_button,Tag:"button","aria-label":"Notifications",children:Object(we.jsxs)("div",{className:it.a.notifications_button_wrapper,children:[Object(we.jsx)(m.u,{}),r&&Object(we.jsx)("p",{className:it.a.notifications_button_number,children:Object.keys({...r}).length})]})}),Object(we.jsx)(Ee,{className:it.a.notifications_submenu,children:Object(we.jsx)("div",{className:it.a.notifications_submenu_wrapper,children:r?Object(we.jsxs)(we.Fragment,{children:[Object(we.jsx)("button",{className:it.a.notifications_submenu_clear,onClick:function(){ie(`users/user${o}/notifications`).remove().then((()=>e(F("All notifications removed.",m.u))))},children:"Clear all"}),Object.values({...r}).sort(((e,t)=>t.date-e.date)).map((e=>Object(we.jsx)(rt,{notification:e,setSubmenuState:j},e.date)))]}):Object(we.jsx)("p",{className:it.a.notifications_submenu_empty,children:"No notifications."})})})]})]})]})]})})})}function rt(e){let{notification:t,setSubmenuState:s}=e;const o=Object(i.b)(),a=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),[r,l]=Object(n.useState)();return Object(n.useEffect)((()=>le({callback:e=>l(e.info),userId:t.id})),[t.id]),r?Object(we.jsxs)("div",{className:it.a.notifications_submenu_item,children:[Object(we.jsx)(Fe,{size:"small",src:r.avatar,userId:r.id,onClick:()=>s(!1)}),Object(we.jsxs)("p",{className:it.a.notifications_submenu_item_text,children:["You have a new friend request from ",Object(we.jsx)(c.b,{className:it.a.notifications_submenu_item_link,to:"/id"+r.id,onClick:()=>s(!1),children:r.name}),"."]}),Object(we.jsx)("button",{className:it.a.notifications_submenu_item_remove,"aria-label":"Remove notification",onClick:function(e){e.stopPropagation(),ie(`users/user${a}/notifications/${t.type+t.id}`).remove().then((()=>o(F("Notification removed.",m.u))))},children:Object(we.jsx)(m.F,{})})]}):null}function lt(){const e=_e((e=>{var t,s,n;return null===(t=e.user)||void 0===t||null===(s=t.account)||void 0===s||null===(n=s.preferences)||void 0===n?void 0:n.darkTheme})),t=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),[s,o]=Object(n.useState)("true"===se());return Object(n.useEffect)((()=>o(t?!!e:!!se())),[e,t]),Object(we.jsx)("label",{className:Object(u.a)(it.a.changeTheme,s&&it.a.changeTheme_checked),children:Object(we.jsxs)("div",{className:it.a.changeTheme_wrapper,children:[Object(we.jsx)("input",{className:it.a.changeTheme_input,type:"checkbox","aria-label":"Toggle dark theme",checked:s,onChange:function(){if(t){const s=ie(`users/user${t}/account/preferences/darkTheme`);e?s.remove():s.set(!0),o(!!e)}else te(!se()),ne(),o(!!se())}}),Object(we.jsx)("div",{className:it.a.changeTheme_iconContainer,children:Object(we.jsx)(m.i,{style:{width:"1.1em"}})})]})})}var dt=s(17),ut=s.n(dt);function mt(){const e=Object(i.b)(),t=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id}));return t?Object(we.jsxs)("nav",{className:ut.a.container,children:[Object(we.jsxs)(c.b,{className:ut.a.link,to:"/news",children:[Object(we.jsx)(m.s,{className:ut.a.link_icon,style:{width:"1.1em"}}),Object(we.jsx)("p",{className:ut.a.link_text,children:"News"})]}),Object(we.jsxs)(c.b,{className:ut.a.link,to:"/messages",children:[Object(we.jsx)(m.j,{className:ut.a.link_icon}),Object(we.jsx)("p",{className:ut.a.link_text,children:"Messages"})]}),Object(we.jsxs)(c.b,{className:ut.a.link,to:"/friends",children:[Object(we.jsx)(m.O,{className:ut.a.link_icon,style:{width:"1.25em"}}),Object(we.jsx)("p",{className:ut.a.link_text,children:"Friends"})]}),Object(we.jsxs)(c.b,{className:ut.a.link,to:"/id"+t,children:[Object(we.jsx)(m.N,{className:ut.a.link_icon}),Object(we.jsx)("p",{className:ut.a.link_text,children:"Profile"})]}),Object(we.jsxs)("button",{className:ut.a.link,onClick:()=>e(x()),children:[Object(we.jsx)(m.a,{className:ut.a.link_icon}),Object(we.jsx)("p",{className:ut.a.link_text,children:"Other"})]})]}):null}var bt=s(35),jt=s.n(bt);function ht(){const e=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id}));return e?Object(we.jsx)("nav",{className:jt.a.container+" navigation",children:Object(we.jsx)("div",{className:jt.a.wrapper+" navigation__wrapper",children:[{icon:m.N,testId:"nav-profile",text:"My Profile",to:"/id"+e},{icon:m.s,text:"News",to:"/news"},{icon:m.j,testId:"nav-messages",text:"Messages",to:"/messages"},{icon:m.O,text:"Friends",to:"/friends"},{icon:m.S,testId:"nav-communities",text:"Communities",to:"/communities"},{icon:m.b,text:"Bookmarks",to:"/bookmarks"}].map((e=>Object(we.jsxs)(c.b,{className:jt.a.link,to:e.to,children:[Object(we.jsx)(e.icon,{className:jt.a.link_icon}),Object(we.jsx)("p",{children:e.text})]},e.text)))})}):null}var ft=s(36),vt=s.n(ft);function pt(){const[e,t]=Object(n.useState)("scroll-to-top__button");return Object(n.useEffect)((()=>{const e=setInterval((()=>{t(Object(u.a)(vt.a.button,window.pageYOffset<window.innerHeight&&vt.a.button_hidden))}),100);return()=>clearInterval(e)}),[]),Object(we.jsx)("div",{className:vt.a.container,children:Object(we.jsx)(ot,{className:vt.a.pageWidth,children:Object(we.jsx)("button",{className:e,"aria-label":"Scroll to top",onClick:function(){document.body.scrollIntoView({behavior:"smooth",block:"start"})},children:Object(we.jsx)(m.h,{})})})})}var Ot=s(31),xt=s.n(Ot);function _t(){const e=Object(i.b)(),t=_e((e=>e.toast)),s=Object(n.useRef)(""),[o,a]=Object(n.useState)(!1);Object(n.useEffect)((()=>{if(!t)return;let n,o;s.current="0s",a(!1);const i=setTimeout((()=>{s.current="",a(!0),n=setTimeout((()=>{a(!1),o=setTimeout((()=>e(q())),400)}),2500)}),10);return()=>{clearTimeout(i),clearTimeout(n),clearTimeout(o)}}),[e,t]);const c=null===t||void 0===t?void 0:t.icon;return Object(we.jsx)(ot,{className:xt.a.pageWidth,children:Object(we.jsx)("div",{className:Object(u.a)(xt.a.wrapper,o&&xt.a.wrapper_open),style:{transitionDuration:s.current},children:Object(we.jsxs)("div",{className:xt.a.innerWrapper,children:[c&&Object(we.jsx)(c,{className:xt.a.icon}),Object(we.jsx)("p",{className:xt.a.text,children:null===t||void 0===t?void 0:t.msg})]})})})}function gt(e){let{children:t,className:s,modalName:o,testId:a,zoomImg:c}=e;const r=Object(i.b)(),l=_e((e=>e.modal.activeModals)),d=_e((e=>e.modal.currentModal)),u=_e((e=>e.modal.zoom)),m=Object(n.useRef)(l);m.current=l;const b=Object(n.useRef)(null),j=Object(n.useRef)(null),h=Object(n.useCallback)((()=>{r(P(o))}),[r,o]);const v=Object(n.useRef)(!1);const p=Object(n.useCallback)((e=>{"Escape"===e.key&&d===o&&h()}),[h,d,o]);return Object(n.useEffect)((()=>(window.addEventListener("keydown",p),()=>window.removeEventListener("keydown",p))),[p]),Object(n.useEffect)((()=>{if(d!==o)return;let e=document.activeElement;const t=s=>{"Tab"!==s.key||j.current.contains(document.activeElement)||(e=document.activeElement,s.preventDefault(),j.current.querySelector("button").focus(),window.removeEventListener("keydown",t))};return window.addEventListener("keydown",t),()=>{m.current.includes(o)||(e.focus({preventScroll:!0}),setTimeout((()=>document.activeElement.blur()),0)),window.removeEventListener("keydown",t)}}),[l,d,o]),Object(we.jsx)("div",{className:`${s?`${s} `:""}modal-${o} modal${l.includes(o)?" modal--open":""}`,ref:b,onMouseDown:function(e){e.target===j.current&&(v.current=!0)},onMouseUp:function(e){v.current&&e.target===j.current&&h(),v.current=!1},onTransitionEnd:function(e){d||e.target!==b.current||"visibility"!==e.nativeEvent.propertyName||f()},children:Object(we.jsx)("div",{className:"modal__wrapper",ref:j,children:Object(we.jsxs)("div",{className:`modal-${o}__content modal__content`,onClick:e=>e.stopPropagation(),children:[Object(we.jsx)("button",{className:"modal__close primary-button","aria-label":"Close modal",onClick:h,children:"\xd7"}),t,c&&Object(we.jsx)("img",{className:"modal-zoom__img",src:(null===u||void 0===u?void 0:u.img)||"#",alt:(null===u||void 0===u?void 0:u.alt)||""})]})})})}function yt(){const e=Object(i.b)(),t=_e((e=>e.modal.actionConfirm)),s=_e((e=>e.modal.activeModals)),o=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.password})),{formState:{errors:a},handleSubmit:c,register:r,reset:l}=Object(Te.a)(),d=Object(n.useRef)(!1),[u,b]=Object(n.useState)(!1);function j(s){s.password&&N(o)!==s.password?b(!0):(e(P("action-confirm")),null===t||void 0===t||t.callback())}return Object(n.useEffect)((()=>{!d.current&&s.includes("action-confirm")?(d.current=!0,l(),b(!1)):d.current=!1}),[s,l]),(null===t||void 0===t?void 0:t.text)?Object(we.jsxs)(we.Fragment,{children:[Object(we.jsx)("div",{className:"modal-action-confirm__header",children:Object(we.jsx)("h4",{className:"modal-action-confirm__title",children:"Confirm action"})}),Object(we.jsxs)("div",{className:"modal-action-confirm__wrapper",children:[Object(we.jsx)("p",{className:"modal-action-confirm__text",children:t.text+(t.irreversible?" This action is irreversible!":"")}),t.password&&Object(we.jsxs)("form",{className:"primary-form",action:"#",method:"post",autoComplete:"off",onSubmit:c(j),children:[Object(we.jsx)(qe,{id:"modal-action-confirm__form-input",onInput:()=>b(!1),opts:{obj:Me.find((e=>"existingPassword"===e.id)),errors:a,label:!0,labelText:"Enter your password to continue",placeholder:!0,register:r}}),u&&Object(we.jsx)("p",{className:"error-text",children:"Wrong password."})]}),Object(we.jsxs)("div",{className:"modal-action-confirm__buttons",children:[Object(we.jsx)(He,{afterIcon:m.d,preset:"secondary",testId:"action-confirm-yes",text:"Yes",type:"submit",onClick:c(j)}),Object(we.jsx)(He,{afterIcon:m.J,iconStyles:{width:".7em"},preset:"remove",text:"No",onClick:()=>e(P("action-confirm"))})]})]})]}):null}function Nt(){const e=Object(i.b)(),t=_e((e=>e.modal.actionError));return t?Object(we.jsxs)(we.Fragment,{children:[Object(we.jsx)("div",{className:"modal-action-error__header",children:Object(we.jsx)("h4",{className:"modal-action-error__title",children:"Error"})}),Object(we.jsxs)("div",{className:"modal-action-error__wrapper",children:[Object(we.jsx)("p",{className:"modal-action-error__text",children:t}),Object(we.jsx)("div",{className:"modal-action-error__buttons",children:Object(we.jsx)(He,{afterIcon:m.d,text:"OK",onClick:()=>e(P("action-error"))})})]})]}):null}function wt(){const e=Object(i.b)(),t=_e((e=>e.modal.changeAvatarCommunityId)),s=_e((e=>e.modal.currentModal)),o=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),a=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.profilePhotos})),{AsyncButton:c,buttonLoading:r,setButtonLoading:l}=Pe(),{addImgPreview:d,imgPreview:u,setImgPreview:b}=Re(!1),j=Object(n.useRef)(!1),[h,f]=Object(n.useState)();return"change-avatar"===s&&(j.current=!0),j.current?u.length?Object(we.jsxs)(we.Fragment,{children:[Object(we.jsx)(We,{imgPreview:u[0],loadingPercentage:h,removeOnClick:()=>b([])}),Object(we.jsx)(c,{afterIcon:m.d,className:"set-button",preset:"secondary",text:"Set as avatar",onClick:function(){r||(l(),f(0),oe({addToPhotos:!0,callback:s=>{let{link:n}=s;ie(`${t?`communities/community${t}`:`users/user${o}`}/info/avatar`).set(n).then((()=>{e(P("change-avatar")),setTimeout((()=>{l(!1),b([]),f(null)}),400)}))},communityId:t,file:u[0].file,setLoadingPercentage:f,userId:o}))}})]}):Object(we.jsxs)(we.Fragment,{children:[!t&&a&&Object(we.jsx)(He,{afterIcon:m.p,iconStyles:{width:"1.15em"},text:"Choose an existing photo",onClick:()=>e(D("choose-photo"))}),Object(we.jsxs)("label",{className:"modal-change-avatar__upload",htmlFor:"modal-change-avatar__upload-input",children:[Object(we.jsx)(He,{afterIcon:m.M,preset:"secondary",text:"Upload photo",onClick:e=>{var t;return null===(t=e.target.closest("label"))||void 0===t?void 0:t.click()}}),Object(we.jsx)("input",{className:"modal-change-avatar__upload-input",id:"modal-change-avatar__upload-input",type:"file",accept:".jpg, .jpeg, .png",hidden:!0,onChange:d})]})]}):null}function kt(){const e=Object(i.b)(),t=_e((e=>e.modal.currentModal)),s=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),o=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.photos})),a=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.profilePhotos})),c=Object(n.useRef)(!1),[r,l]=Object(n.useState)([]);return Object(n.useEffect)((()=>{const e=[];Object.keys({...a}).forEach((t=>e.push(null===o||void 0===o?void 0:o[t]))),e.includes(void 0)||l(e.sort(((e,t)=>t.date-e.date)))}),[o,a]),"choose-photo"===t&&(c.current=!0),c.current?Object(we.jsxs)("div",{className:"modal-choose-photo__photos",children:[Object(we.jsx)("div",{className:"photos__header",children:Object(we.jsx)("h4",{className:"photos__title",children:`Your photos (${r.length})`})}),Object(we.jsx)("div",{className:"photos__items",children:r.map((t=>Object(we.jsx)("button",{className:"photos__item",onClick:()=>{return n=t.src,J(s,n),e(P("choose-photo")),void e(P("change-avatar"));var n},children:Object(we.jsx)("img",{className:"photos__item-img",src:t.src,alt:""})},t.id)))})]}):null}function It(){const e=Object(i.b)(),t=_e((e=>e.modal.currentModal)),s=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),{formState:{errors:o},handleSubmit:a,register:c,reset:r}=Object(Te.a)(),{AsyncButton:l,buttonLoadingRef:d,setButtonLoading:u}=Pe(),m=Object(n.useRef)(!1);return"create-community"===t&&(m.current=!0),m.current?Object(we.jsxs)("form",{className:"primary-form",action:"#",method:"post",onSubmit:a((function(t){if(!d.current){u(),t=W(t);for(const e in t)t[e]||(t[e]=null);ie("contentData/nextCommunityId").once((n=>{const o={fullInfo:{creationTime:S,description:t.description},info:{avatar:"img/community-default.svg",creatorId:s,id:n,shortDescription:t.shortDescription,title:t.title}};ie().update({["communities/community"+n]:o,"contentData/nextCommunityId":`${parseInt(n,10)+1}`}).then((()=>{e(P("create-community")),setTimeout((()=>{r(),u(!1)}),400)}))}))}})),children:[Me.filter((e=>["title","description","shortDescription"].includes(e.id))).map((e=>Object(we.jsx)(qe,{opts:{obj:e,errors:o,placeholder:!0,register:c}},e.id))),Object(we.jsx)(l,{testId:"create-community-btn",text:"Create community",type:"submit"})]}):null}var Ct=s(90),St=s(85),$t=s(86),Et=s(87),Tt=s(88),Lt=s(91),Pt=s(89);function Rt(){const e=Object(i.b)(),t=_e((e=>e.modal.gallery)),s=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.admin})),o=_e((e=>{var t,s;return null===(t=e.user)||void 0===t||null===(s=t.info)||void 0===s?void 0:s.avatar})),a=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),c=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.profilePhotos})),r=Object(n.useRef)(null),l=Object(n.useRef)(null),[d,u]=Object(n.useState)(),[b,j]=Object(n.useState)();Object(n.useEffect)((()=>{d&&b&&(d.params.navigation.prevEl=r.current,d.params.navigation.nextEl=l.current,d.controller.control=b,b.controller.control=d)}),[d,b]),Object(n.useEffect)((()=>{t&&d&&(d[t.content.length>1?"enable":"disable"](),d.update(),d.slideToLoop(t.initialSlide,0))}),[t,d]);const h=()=>e(P("gallery"));if(!t)return null;return Object(we.jsxs)(we.Fragment,{children:[Object(we.jsxs)(Lt.a,{className:"gallery-swiper__container",autoHeight:!0,keyboard:!0,navigation:{prevEl:r.current,nextEl:l.current},onBeforeInit:e=>{e.params.navigation.prevEl=r.current,e.params.navigation.nextEl=l.current},onSwiper:u,pagination:{type:"fraction"},speed:600,children:[t.content.map((n=>{var i;return Object(we.jsxs)(Pt.a,{className:"gallery-swiper__slide",children:[Object(we.jsx)("div",{className:"modal-gallery__img-container",children:Object(we.jsx)("img",{className:"modal-gallery__img",src:n.src,alt:""})}),Object(we.jsxs)("div",{className:"modal-gallery__info",children:[Object(we.jsx)(Ke,{avatarSize:"small",bottomText:H(n.date),community:!!(null===(i=t.authorInfo)||void 0===i?void 0:i.title),linksOnClick:h,userInfo:t.authorInfo}),Object(we.jsxs)("div",{className:"modal-gallery__info-buttons",children:[t.authorInfo.id===a&&n.src!==o&&(null===c||void 0===c?void 0:c[n.id])&&Object(we.jsx)(He,{beforeIcon:m.N,preset:"secondary",text:"Set as avatar",onClick:()=>{return e=n.src,J(a,e),void h();var e}}),(t.authorInfo.id===a||t.authorInfo.creatorId&&t.authorInfo.creatorId===a||s)&&Object(we.jsx)(He,{beforeIcon:m.K,preset:"remove",text:"Delete photo",onClick:()=>(s=>{const n=t.authorInfo.title,o=(n?"communities/community":"users/user")+t.authorInfo.id;e(D("action-confirm",{actionConfirm:{callback:()=>{ie().update({[`${o}/photos/${s.id}`]:null,[`${o}/profilePhotos/${s.id}`]:null,...t.authorInfo.avatar===s.src&&{[`${o}/info/avatar`]:`img/${n?"community":"user"}-default.svg`}}).then((()=>e(F("Photo deleted.",m.F)))),$.delete(s.src),h()},irreversible:!0,text:"Are you sure you want to delete this photo?"}}))})(n)})]})]})]},n.id)})),Object(we.jsx)("button",{className:"gallery-swiper__button-prev swiper-button-prev",ref:r,children:Object(we.jsx)(m.f,{})}),Object(we.jsx)("button",{className:"gallery-swiper__button-next swiper-button-next",ref:l,children:Object(we.jsx)(m.g,{})})]}),Object(we.jsx)(Lt.a,{className:"gallery-thumbs__container",breakpoints:{768:{slidesPerView:6}},centeredSlides:!0,onSwiper:j,slidesPerView:4,slideToClickedSlide:!0,spaceBetween:10,speed:600,children:t.content.map((e=>Object(we.jsx)(Pt.a,{className:"gallery-thumbs__slide",children:Object(we.jsx)("button",{className:"gallery-thumbs__slide-button",children:Object(we.jsx)("img",{className:"gallery-thumbs__slide-img",src:e.src,alt:""})})},e.id)))})]})}let Dt;function Mt(){const e=Object(i.b)(),{formState:{errors:t},handleSubmit:s,register:o}=Object(Te.a)(),{AsyncButton:a,buttonLoadingRef:c,setButtonLoading:r}=Pe(),[l,d]=Object(n.useState)({});const u={errors:t,placeholder:!0,register:o};return Object(we.jsxs)("form",{className:"primary-form",action:"#",method:"post",noValidate:!0,onChange:()=>r(!1),onSubmit:s((function(t){var s;c.current||(r(),t=W(t),null===(s=Dt)||void 0===s||s(),Dt=ie("users").orderByChild("account/email").equalTo(t.email.toLowerCase()).on((s=>{if(Dt(),!c.current)return;const n=function(e){const t={...l};return e.password!==e.confirmPassword&&(t.wrongConfirmPassword=!0),d(t),t}(t);s&&(d({...n,emailExists:!0}),n.emailExists=!0),Object.values(n).includes(!0)?r(!1):ie("contentData/nextUserId").once((async s=>{t.confirmPassword=null;const n=await ce(),o={account:{email:t.email.toLowerCase(),id:s,password:y(t.password,s),preferences:{darkTheme:!!se()||null},registrationData:{date:S,location:n}},info:{avatar:"img/user-default.svg",gender:t.gender,id:s,lastName:t.lastName,lastSeen:S,name:t.name}};ie().update({["users/user"+s]:o,"contentData/nextUserId":`${parseInt(s,10)+1}`}).then((()=>{e(P("sign-up")),setTimeout((()=>{e(he(o)),e(tt())}),400)}))}))})))})),children:[Object(we.jsx)(qe,{opts:{obj:Me.find((e=>"name"===e.id)),...u}}),Object(we.jsx)(qe,{opts:{obj:Me.find((e=>"lastName"===e.id)),...u}}),Object(we.jsx)(Ae,{register:o}),Object(we.jsx)(qe,{opts:{obj:Me.find((e=>"email"===e.id)),...u},onInput:()=>d({...l,emailExists:!1})}),l.emailExists&&Object(we.jsx)("p",{className:"error-text",children:"This email is already used."}),Me.filter((e=>["password","confirmPassword"].includes(e.id))).map((e=>Object(we.jsx)(qe,{opts:{obj:e,...u},onInput:()=>d({...l,wrongConfirmPassword:!1})},e.id))),l.wrongConfirmPassword&&Object(we.jsx)("p",{className:"error-text",children:"Wrong confirm password."}),Object(we.jsx)(a,{testId:"sign-up-btn",text:"Sign up",type:"submit"})]})}function At(){const e=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id}));return Object(we.jsxs)("div",{children:[Object(we.jsx)(gt,{modalName:"gallery",children:Object(we.jsx)(Rt,{})}),e?Object(we.jsxs)(we.Fragment,{children:[Object(we.jsx)(gt,{modalName:"create-community",children:Object(we.jsx)(It,{})}),Object(we.jsx)(gt,{modalName:"change-avatar",children:Object(we.jsx)(wt,{})}),Object(we.jsx)(gt,{modalName:"choose-photo",children:Object(we.jsx)(kt,{})}),Object(we.jsx)(gt,{modalName:"action-confirm",testId:"action-confirm-modal",children:Object(we.jsx)(yt,{})}),Object(we.jsx)(gt,{modalName:"action-error",children:Object(we.jsx)(Nt,{})}),Object(we.jsx)(gt,{modalName:"zoom",zoomImg:!0})]}):Object(we.jsx)(gt,{modalName:"sign-up",children:Object(we.jsx)(Mt,{})})]})}function qt(){const e=Object(i.b)(),{pathname:t}=Object(Ie.useLocation)(),s=_e((e=>e.modal.currentModal)),o=Object(n.useRef)(null);return o.current=s,Object(n.useEffect)((()=>{o.current&&e(P(o.current))}),[e,t]),null}function Bt(){const e=Object(i.b)(),t=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id}));return Object(n.useEffect)((()=>{if(!t)return;const e="users/user"+t;let s;const n=ie(".info/connected").on((t=>{t&&(s&&Object(g.m)(s),s=ie(e+"/connections").push(),Object(g.o)(s,!0),Object(g.f)(s).remove(),ie(e+"/info/lastSeen").onDisconnect().set(S))}));return()=>{Object(g.m)(s),ie(e+"/info/lastSeen").onDisconnect().cancel(),ie(e+"/info/lastSeen").set(S),n()}}),[e,t]),Object(n.useEffect)((()=>{const t=()=>e(tt());return t(),window.addEventListener("storage",t),()=>window.removeEventListener("storage",t)}),[e]),null}function Ft(e){let{communitiesInfo:t,renderSubscribeButton:s=!0}=e;const n=De(),o=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.admin})),a=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),i=_e((e=>{var t,s;return null===(t=e.user)||void 0===t||null===(s=t.communities)||void 0===s?void 0:s.subscribed}));return Object(we.jsx)("div",{className:"communities-list",children:t.map((e=>Object(we.jsx)("div",{className:"communities-list__item",children:Object(we.jsx)(Ke,{bottomText:G("subscriber",e.subscriberCount||0),childrenBottom:Object(we.jsxs)(we.Fragment,{children:[Object(we.jsx)("p",{className:"communities-list__item-description",children:e.deleted?"This community has been deleted.":e.shortDescription||"No description provided."}),s&&Object(we.jsx)(He,{preset:(null===i||void 0===i?void 0:i["community"+e.id])?"remove":"primary",testId:`community-${(null===i||void 0===i?void 0:i["community"+e.id])?"un":""}subscribe-btn`,text:(null===i||void 0===i?void 0:i["community"+e.id])?"Unsubscribe":"Subscribe",onClick:()=>ee(e.id,n,a,!!(null===i||void 0===i?void 0:i["community"+e.id]))})]}),community:!!e.id,userInfo:e,children:Object(we.jsx)(Ye,{bookmarkType:"community",itemId:e.id,children:!e.deleted&&o&&Object(we.jsx)(He,{text:"Delete community",onClick:()=>{var t;ie(`communities/community${(t=e).id}/fullInfo/banner/src`).once((e=>{V(t.id,e,t.subscriberCount)}))}})})})},e.id)))})}function zt(e){let{button:t,requestDate:s,singleUser:n,users:o}=e;const a=Object(i.b)(),c=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),r=e=>Object(we.jsx)("div",{className:"users-list__item",children:Object(we.jsx)(Ke,{bottomText:s?H(s):K(e),childrenBottom:Object(we.jsxs)(we.Fragment,{children:["bookmarks"===t&&!s&&Object(we.jsx)(He,{text:"Remove from bookmarks",onClick:()=>(e=>ie(`users/user${c}/bookmarks/users/user${e.info.id}`).remove().then((()=>a(F("Item removed from bookmarks.",m.v)))))(e)}),s&&Object(we.jsx)(He,{text:"Accept friend request",onClick:()=>U({reqUserId:e.info.id,userId:c})})]}),userInfo:e.info})},e.info.id);return n?r(n):Object(we.jsx)("div",{className:"users-list",children:o.map((e=>r(e)))})}function Ht(e){let{addToPhotosButton:t,avatar:s,buttonText:o="Post",children:a,community:i,inputPlaceholder:c="Share your thoughts",mobileSubmit:r,uploadCallback:l,userId:d}=e;const u=i?d:null,b=Object(n.useRef)(),[j,h]=Object(n.useState)([]),{formState:{errors:f},handleSubmit:v,register:p,reset:O,setValue:x}=Object(Te.a)(),{AsyncButton:_,buttonLoading:g,setButtonLoading:y}=Pe(),{addImgPreview:N,imgPreview:w,setImgPreview:k}=Re(),{ref:I,...C}=p("msg",{maxLength:{value:5e3,message:"A message cannot contain more than 5000 characters"}});function $(e){var t;if(g)return;const s=document.activeElement===b.current,n=new Array(w.length).fill(0),o=null===(t=e.msg)||void 0===t?void 0:t.trim(),a=[];if(w.length||o){y(),h(n),w.length||c();const e=e=>{let{id:t,index:s}=e;a[s]=t,a.length!==w.length||a.includes(void 0)||c()};w.forEach(((t,s)=>oe({addToPhotos:t.addToPhotos,callback:e,communityId:u,file:t.file,index:s,setLoadingPercentage:(e,t)=>{n[t]=e,h([...n])},userId:d})))}async function c(){const e={images:a,text:o||null},t=()=>{var e;O(),k([]),h([]),y(!1),s&&(null===(e=b.current)||void 0===e||e.focus())};l?(await l(e),t()):ie("contentData/nextPostId").once((s=>{const n={authorId:i?null:d,communityId:u,content:e,date:S,id:s};ie().update({["posts/post"+s]:n,"contentData/nextPostId":`${parseInt(s,10)+1}`}).then(t)}))}}return Object(we.jsxs)("div",{className:"post-msg",children:[Object(we.jsx)(Fe,{community:i,enablePreview:!1,size:"small",src:s,userId:d}),Object(we.jsxs)("form",{className:"post-msg__form",action:"#",method:"post",onSubmit:v($),children:[Object(we.jsxs)("div",{className:"post-msg__form-header",children:[a,Object(we.jsx)("textarea",{className:"post-msg__form-input"+(g?" input--disabled":""),disabled:g,placeholder:c+"...",ref:e=>{I(e),b.current=e},rows:1,onKeyPress:function(e){"Enter"!==e.key||e.shiftKey||(e.preventDefault(),x("msg",e.target.value),v($)())},...C}),r&&Object(we.jsxs)("button",{className:"post-msg__form-mobile-submit"+(g?" post-msg__form-mobile-submit--loading":""),children:[g&&Object(we.jsxs)("div",{className:"post-msg__form-mobile-submit-loading loading-spinner",children:[Object(we.jsx)("div",{}),Object(we.jsx)("div",{}),Object(we.jsx)("div",{}),Object(we.jsx)("div",{})]}),Object(we.jsx)(m.D,{})]})]}),f.msg&&Object(we.jsx)("p",{className:"error-text",children:f.msg.message}),Object(we.jsxs)("div",{className:"post-msg__form-footer",children:[Object(we.jsxs)("div",{className:"post-msg__form-footer-inputs",children:[Object(we.jsxs)("label",{className:"post-msg__form-photo",children:[Object(we.jsx)("input",{className:"post-msg__form-photo-input",disabled:g,type:"file",accept:".jpg, .jpeg, .png",multiple:!0,hidden:!0,onChange:N}),Object(we.jsx)("button",{className:"post-msg__form-photo-button"+(g?" post-msg__form-photo-button--disabled":""),type:"button","aria-label":"Photo",onClick:e=>e.target.closest("label").click(),children:Object(we.jsx)(m.c,{className:"post-msg__form-photo-icon"})})]}),Object(we.jsx)(_,{testId:"post-msg-btn",text:o,type:"submit"})]}),w.length>0&&Object(we.jsx)("div",{className:"upload-previews",children:Object(we.jsx)("div",{className:"upload-previews__wrapper",children:w.map(((e,s)=>Object(we.jsx)(We,{addToPhotosHandler:t?e=>function(e,t){k(w.map(((s,n)=>(n===t&&(s.addToPhotos=e.target.checked),s))))}(e,s):void 0,community:i,imgPreview:e,loadingPercentage:j[s],removeOnClick:()=>k(w.filter((t=>t.result!==e.result)))},s)))})})]})]})]})}Ct.a.use([St.a,$t.a,Et.a,Tt.a]);var Ut=s(51),Yt=s.n(Ut);const Vt=Object(n.createContext)(null);function Wt(e){let{animationClass:t="lazy-animation",autoCheck:s=!0,autoCheckInterval:o=2e3,scrollOffset:a=0,Tag:i="div",...c}=e;const r=Object(n.useCallback)((()=>d(!0)),[]),[l,d]=Object(n.useState)(!1);return Object(we.jsx)(Vt.Provider,{value:{autoCheck:s,autoCheckInterval:o,loadItem:r,scrollOffset:a},children:Object(we.jsx)(i,{...c,className:c.className+(l?"":` ${t}`)})})}function Kt(e){let{alt:t,src:s,...o}=e;const{autoCheck:a,autoCheckInterval:i,loadItem:c,scrollOffset:r}=Object(n.useContext)(Vt),l=Object(n.useRef)(),d=Object(n.useRef)(null),u=Object(n.useRef)(!1),[m,b]=Object(n.useState)({src:"#",alt:""}),j=Object(n.useCallback)((()=>{window.removeEventListener("load",h),window.removeEventListener("resize",h),window.removeEventListener("scroll",h),clearInterval(l.current)}),[]),h=Object(n.useCallback)((()=>{if(!d.current)return;const e=d.current,n=e.getBoundingClientRect().top+window.pageYOffset+r-window.innerHeight;window.pageYOffset>=n&&e.offsetParent&&"hidden"!==getComputedStyle(e).visibility&&(u.current=!0,b({src:s,alt:t||""}),j())}),[t,j,r,s]);return Object(n.useEffect)((()=>(u.current||(h(),window.addEventListener("load",h),window.addEventListener("resize",h),window.addEventListener("scroll",h),a&&(l.current=setInterval(h,i))),j)),[a,i,h,j]),Object(we.jsx)("img",{ref:d,...o,...m,onLoad:c})}function Zt(e){var t;let{author:s,content:o,lazyLoadEnabled:a,linkStopPropagation:r,msgIndex:l,renderReplyToAuthorText:d}=e;const u=Object(i.b)(),m=Object(n.useRef)(null),[b,j]=Object(n.useState)(!1),[h,f]=Object(n.useState)(!1),v=(null===(t=o.images)||void 0===t?void 0:t.map((e=>Object.values({...s.photos}).find((t=>t.id===e)))))||[],p=v.filter((e=>e));function O(e,t){e.preventDefault(),r&&e.stopPropagation(),u(D("gallery",{gallery:{authorInfo:s.info,content:p,initialSlide:p.indexOf(p.find((e=>e.id===t)))}}))}return Object(n.useEffect)((()=>{const e=()=>{var e,t;return!h&&j((null===(e=m.current)||void 0===e?void 0:e.scrollHeight)>(null===(t=m.current)||void 0===t?void 0:t.offsetHeight))};return e(),window.addEventListener("loadFinished",e),window.addEventListener("resize",e),()=>{window.removeEventListener("loadFinished",e),window.removeEventListener("resize",e)}}),[h]),Object(we.jsxs)("div",{className:"user-message",children:[o.text&&Object(we.jsx)(Yt.a,{componentDecorator:(e,t,s)=>Object(we.jsx)("a",{className:"user-message__text-link",href:e,rel:"noreferrer",target:"_blank",onClick:e=>e.stopPropagation(),children:t},s),children:Object(we.jsxs)("div",{className:"user-message__text-container user-message__item",children:[Object(we.jsxs)("p",{className:"user-message__text",ref:m,style:{display:h?"block":""},children:[null===d||void 0===d?void 0:d(),o.text]}),b&&Object(we.jsx)("div",{className:"user-message__text-show-more",role:"button",tabIndex:0,onClick:function(e){e.stopPropagation(),f(!h)},onKeyPress:function(e){["Enter"," "].includes(e.key)&&(e.preventDefault(),e.target.click())},children:h?"Show less":"Show more"})]})}),v.map(((e,t)=>Object(we.jsx)(n.Fragment,{children:e?!a||l<4?Object(we.jsx)(c.b,{className:"user-message__img-container user-message__item",to:"#javascript",onClick:t=>O(t,e.id),children:Object(we.jsx)("img",{className:"user-message__img",src:e.src,alt:""})}):Object(we.jsx)(Wt,{className:"user-message__img-container user-message__item",scrollOffset:-1e3,Tag:c.b,to:"#javascript",onClick:t=>O(t,e.id),children:Object(we.jsx)(Kt,{className:"user-message__img",src:e.src,alt:""})}):Object(we.jsx)("p",{className:"user-message__deleted-photo user-message__item",children:"Deleted photo"})},t)))]})}function Qt(e){let{post:t}=e;const{hash:s}=Object(Ie.useLocation)(),o=_e((e=>{var t,s;return null===(t=e.user)||void 0===t||null===(s=t.info)||void 0===s?void 0:s.avatar})),a=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),i=Object(n.useRef)(null),[c,r]=Object(n.useState)(null),[l,d]=Object(n.useState)(null),u=Object(n.useCallback)((()=>{var e;return null===(e=i.current)||void 0===e?void 0:e.scrollIntoView({behavior:"auto",block:"start"})}),[]);Object(n.useEffect)((()=>"#comments"===s&&setTimeout(u,0)),[s,u]);const m=(e,s)=>n=>{const o=ie().newKey(),i=e?`/${e}/replies`:"";return ie(`posts/post${t.id}/comments${i}/${o}`).set({authorId:a,content:n,date:S,id:o,replyTo:s||null}).then((()=>{r(null),!s&&setTimeout(u,0)}))},b=Object.values({...t.comments}).sort(((e,t)=>t.date-e.date));return Object(we.jsx)("div",{ref:i,className:"post__comments-container",children:Object(we.jsxs)("div",{className:"post__comments",children:[Object(we.jsx)("div",{className:"post__comments-title",children:`Comments (${b.length})`}),Object(we.jsx)("div",{className:"post__comments-wrapper",children:b.map((e=>Object(we.jsx)(Gt,{comment:e,postId:t.id,replyComment:c,selectedReply:l,setReplyComment:r,setSelectedReply:d,uploadCallback:m},e.id)))}),a&&Object(we.jsx)(Ht,{avatar:o,buttonText:"Comment",inputPlaceholder:"Leave a comment",uploadCallback:m(),userId:a})]})})}function Gt(e){let{comment:t,postId:s,replyComment:o,selectedReply:a,setReplyComment:c,setSelectedReply:r,uploadCallback:l}=e;const d=Object(i.b)(),u=De(),b=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.admin})),j=_e((e=>{var t,s;return null===(t=e.user)||void 0===t||null===(s=t.info)||void 0===s?void 0:s.avatar})),h=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),[f,v]=Object(n.useState)(),[p,O]=Object(n.useState)([]),[x,_]=Object(n.useState)([]);function g(e){var t;null===(t=document.querySelector("#"+e))||void 0===t||t.scrollIntoView({behavior:"auto",block:"center"}),r(e),setTimeout((()=>r(null)),0)}Object(n.useEffect)((()=>O(Object.values({...t.replies}))),[t.replies]),Object(n.useEffect)((()=>{const e=le({callback:v,fields:["info","photos"],userId:t.authorId}),s=[],n=[];return p.forEach(((e,t)=>{s.push(le({callback:e=>{n[t]=e,n.length!==p.length||n.includes(void 0)||_([...n])},fields:["info","photos"],userId:e.authorId}))})),()=>{e(),s.forEach((e=>e()))}}),[t.authorId,p]);const y=e=>{var n;let{replies:i,replyTo:r,tempAuthor:v,tempComment:O}=e;return Object(we.jsxs)("div",{className:"post__comment",id:O.id,children:[Object(we.jsx)(Fe,{src:v.info.avatar,userId:v.info.id}),Object(we.jsxs)("div",{className:"post__comment-wrapper"+(O.id===a?" post__comment-wrapper--selected":""),children:[Object(we.jsx)(Be,{text:H(O.date),userInfo:v.info}),Object(we.jsx)(Zt,{author:v,content:O.content,renderReplyToAuthorText:O.replyTo?()=>(e=>{var t;return r&&Object(we.jsxs)("button",{className:"user-message__reply-to",onClick:()=>g(e),children:[Object(we.jsx)("span",{className:"user-message__reply-to-name",children:null===(t=x.find((e=>{var t;return e.info.id===(null===(t=p.find((e=>e.id===O.replyTo)))||void 0===t?void 0:t.authorId)})))||void 0===t?void 0:t.info.name}),", "]})})(O.replyTo):void 0}),Object(we.jsxs)("div",{className:"post__comment-footer",children:[Object(we.jsxs)("button",{className:"post__comment-footer-button",onClick:function(e){var n;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!i&&O.id;return Z({condition:!!(null===(n=O.likes)||void 0===n?void 0:n["user"+h]),contentId:t.id,contentPath:`posts/post${s}/comments/${t.id}${o?`/replies/${o}`:""}`,redirect:u,userId:h,userPath:`comments/post${s}/${o?`reply${o}`:`comment${t.id}`}`})},children:[(null===(n=O.likes)||void 0===n?void 0:n["user"+h])?Object(we.jsx)(m.o,{className:"post__comment-footer-button-icon"}):Object(we.jsx)(m.B,{className:"post__comment-footer-button-icon"}),Object(we.jsx)("p",{className:"post__comment-footer-button-text",children:O.likeCounter||0})]}),Object(we.jsxs)("button",{className:"post__comment-footer-button",onClick:()=>{return e=O,void(h?c({author:x.find((t=>t.info.id===e.authorId))||f,commentId:t.id,reply:e}):u());var e},children:[Object(we.jsx)(m.H,{className:"post__comment-footer-button-icon",style:{width:"1.01em"}}),Object(we.jsx)("p",{className:"post__comment-footer-button-text",children:"reply"})]}),(v.info.id===h||b)&&Object(we.jsxs)("button",{className:"post__comment-footer-delete-button",onClick:()=>{return e=i?"":O.id,void d(D("action-confirm",{actionConfirm:{callback:()=>ie(`posts/post${s}/comments/${t.id}${e?`/replies/${e}`:""}`).remove().then((()=>d(F("Comment deleted.",m.F)))),irreversible:!0,text:"Are you sure you want to delete this comment?"}}));var e},children:[Object(we.jsx)(m.F,{className:"post__comment-footer-delete-button-icon",style:{width:".9em"}}),Object(we.jsx)("p",{className:"post__comment-footer-delete-button-text",children:"Delete"})]})]}),(null===i||void 0===i?void 0:i.length)>0&&Object(we.jsx)("div",{className:"post__comment-replies",children:i}),(null===o||void 0===o?void 0:o.commentId)===t.id&&i&&Object(we.jsx)(Ht,{avatar:j,buttonText:"Reply",inputPlaceholder:"Leave a comment",uploadCallback:l(t.id,o.reply.id),userId:h,children:Object(we.jsxs)("button",{className:"post-msg__form-reply-to",type:"button",onClick:()=>g(o.reply.id),children:[Object(we.jsx)("p",{className:"post-msg__form-reply-to-text",children:`reply to ${o.author.info.name} ${o.author.info.lastName}`}),Object(we.jsx)(m.q,{className:"post-msg__form-reply-to-icon",style:{width:".62em"}})]})})]})]},O.id)};return f?y({tempAuthor:f,tempComment:t,replies:p.map(((e,t)=>x[t]&&y({tempAuthor:x[t],tempComment:e,replyTo:x.find((t=>{var s;return t.info.id===(null===(s=p.find((t=>t.id===e.replyTo)))||void 0===s?void 0:s.authorId)}))})))}):null}function Jt(e){var t,s,a;let{fetchedItems:r,index:l=0,loadingCallback:d,post:u,renderComments:b}=e;const j=Object(i.b)(),h=De(),f=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.admin})),v=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),p=Object(n.useRef)(null),[O,x]=Object(n.useState)(),[_,y]=Object(n.useState)(),[N,w]=Object(n.useState)();Object(n.useEffect)((()=>{if(null===v)return;let e,t,s;const n=()=>{u.shareOrigin?e&&void 0!==t&&s&&(Object(o.unstable_batchedUpdates)((()=>{w(e),y(t),x(s)})),r.current.incrementQty(u.id,d)):e&&(w(e),r.current.incrementQty(u.id,d))},a=le({callback:t=>{e=t,n()},community:!!u.communityId,fields:u.shareOrigin?void 0:["info","photos"],userId:u.authorId||u.communityId});let i;const c=u.shareOrigin?ie("posts/post"+u.shareOrigin).on((e=>{e?(s=e,i=le({callback:e=>{t=e,n()},community:!!e.communityId,fields:["info","photos"],userId:e.authorId||e.communityId})):(t=null,s={deleted:!0},n())})):void 0;return()=>{var e;a(),null===(e=i)||void 0===e||e(),null===c||void 0===c||c()}}),[r,d,u.authorId,u.communityId,u.id,u.shareOrigin,v]);const k=null===(t=u.views)||void 0===t?void 0:t["user"+v];return Object(n.useEffect)((()=>{if(!(null===N||void 0===N?void 0:N.info.id)||!v||k)return;let e;const t=new IntersectionObserver((t=>{let[s]=t;s.isIntersecting?e=setTimeout((()=>{const e=`posts/post${u.id}/`;ie().update({[`${e}viewCounter`]:Object(g.e)(1),[`${e}views/user${v}`]:{date:S,userId:v}})}),5e3):clearInterval(e)}),{threshold:.5});return t.observe(p.current),()=>{t.disconnect(),clearTimeout(e)}}),[u.id,null===N||void 0===N?void 0:N.info.id,k,v]),N?Object(we.jsxs)("article",{className:"post",ref:p,children:[Object(we.jsxs)("div",{className:"post__main",children:[Object(we.jsx)(Ke,{bottomText:H(u.date),bottomTextLink:"/post"+u.id,community:!!u.communityId,userInfo:N.info,children:Object(we.jsx)(Ye,{bookmarkType:"post",itemId:u.id,children:(N.info.id===v||N.info.creatorId&&N.info.creatorId===v||f)&&Object(we.jsx)(He,{testId:"delete-post-btn",text:"Delete post",onClick:function(){j(D("action-confirm",{actionConfirm:{callback:()=>ie("posts/post"+u.id).remove().then((()=>j(F("Post deleted.",m.F)))),irreversible:!0,text:"Are you sure you want to delete this post?"}}))}})})}),O?Object(we.jsx)("div",{className:"post__origin",children:O.deleted?Object(we.jsx)("p",{className:"post__origin-deleted",children:"Shared post deleted"}):Object(we.jsxs)("div",{className:"post__origin-content",children:[Object(we.jsx)(Ke,{bottomText:H(O.date),bottomTextLink:"/post"+O.id,community:!!O.communityId,userInfo:_.info}),Object(we.jsx)(Zt,{author:_,content:O.content||O.content,lazyLoadEnabled:!0,msgIndex:l})]})}):Object(we.jsx)(Zt,{author:N,content:u.content,lazyLoadEnabled:!0,msgIndex:l}),Object(we.jsxs)("div",{className:"post__footer",children:[Object(we.jsxs)("div",{className:"post__footer-left",children:[Object(we.jsxs)("button",{className:"post__footer-button post__footer-item","aria-label":(null===(s=u.likes)||void 0===s?void 0:s["user"+v])?"Dislike":"Like",onClick:()=>{var e;return Z({condition:!!(null===(e=u.likes)||void 0===e?void 0:e["user"+v]),contentId:u.id,contentPath:`posts/post${u.id}`,redirect:h,userId:v,userPath:`posts/post${u.id}`})},children:[(null===(a=u.likes)||void 0===a?void 0:a["user"+v])?Object(we.jsx)(m.o,{className:"post__footer-button-icon","aria-label":"Likes"}):Object(we.jsx)(m.B,{className:"post__footer-button-icon","aria-label":"Likes"}),Object(we.jsx)("p",{className:"post__footer-button-text",children:u.likeCounter||0})]}),Object(we.jsxs)(c.b,{className:"post__footer-button post__footer-item",to:`/post${u.id}#comments`,children:[Object(we.jsx)(m.x,{className:"post__footer-button-icon","aria-label":"Comments"}),Object(we.jsx)("p",{className:"post__footer-button-text",children:Object.keys({...u.comments}).length})]}),Object(we.jsxs)("button",{className:"post__footer-button post__footer-item","aria-label":"Share",onClick:function(){v?ie("contentData/nextPostId").once((e=>{const t={authorId:v,date:S,id:e,shareOrigin:u.shareOrigin||u.id};ie().update({["posts/post"+e]:t,"contentData/nextPostId":`${parseInt(e,10)+1}`,...!(null===O||void 0===O?void 0:O.deleted)&&{[`posts/post${u.shareOrigin||u.id}/shareCounter`]:Object(g.e)(1)}}).then((()=>j(F("Shared to your wall.",m.E))))})):h()},children:[Object(we.jsx)(m.E,{className:"post__footer-button-icon",style:{width:"1.1em"},"aria-label":"Shares"}),Object(we.jsx)("p",{className:"post__footer-button-text",children:u.shareCounter||0})]})]}),Object(we.jsx)("div",{className:"post__footer-right",children:Object(we.jsxs)("div",{className:"post__footer-item",children:[Object(we.jsx)(m.n,{className:"post__footer-button-icon",style:{width:"1.1em"}}),Object(we.jsx)("p",{className:"post__footer-button-text",children:u.viewCounter||0})]})})]})]}),b&&Object(we.jsx)(Qt,{post:u})]}):null}function Xt(){var e;const t=Object(i.b)(),{search:s}=Object(Ie.useLocation)(),o=new URLSearchParams(s).get("tab"),a=De(),r=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.bookmarks})),l=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),d=["communities","users"].find((e=>e===o))||"posts",u=Object(n.useRef)(),[b,j]=Object(n.useState)([]),{fetchedItems:h,finishLoading:f}=Le(),v=Object(n.useCallback)((()=>f("Bookmarks")),[f]);Object(n.useEffect)((()=>{if(void 0===l&&a(),!l)return;const e=Object.values({...null===r||void 0===r?void 0:r[d]}).sort(((e,t)=>t.date-e.date));e.length||(v(),j([]));const t=[],s=[],n=(t,n,o)=>{s[o]=t||{id:n.id,unavailable:!0},s.length!==e.length||s.includes(void 0)||(j([...s]),["users","communities"].includes(d)?v():h.current.setExpected(s.length,v)),!t&&h.current.incrementQty(n.id,v)};return e.forEach(((e,s)=>{["communities","users"].includes(d)?t.push(le({callback:t=>n(t,e,s),community:"communities"===d,fields:"communities"===d?["fullInfo","info"]:["connections","info"],userId:e.id})):t.push(ie("posts/post"+e.id).on((t=>n(t,e,s))))})),()=>t.forEach((e=>e()))}),[d,h,v,a,r,l]),Object(n.useEffect)((()=>u.current=d),[d]);const p=b.filter((e=>!e.unavailable)),O=null===(e=b.filter((e=>e.unavailable)))||void 0===e?void 0:e.length,x=e=>"sidebar__button"+(d===e?" sidebar__button--active":"");return Object(we.jsxs)("section",{className:"bookmarks",children:[Object(we.jsx)("div",{className:"content-width",children:Object(we.jsxs)("div",{className:"bookmarks__wrapper",children:[Object(we.jsxs)("div",{className:"bookmarks__header",children:[Object(we.jsx)("h1",{className:"bookmarks__header-title",children:`${d} bookmarks (${b.length})`}),O>0&&Object(we.jsxs)("p",{className:"bookmarks__header-unavailable",children:[O+" unavailable item(s) are hidden ",Object(we.jsx)("button",{className:"bookmarks__header-unavailable-remove",onClick:function(){const e="communities"===d?"community":d.slice(0,-1);ie().update(b.reduce(((t,s)=>(s.unavailable&&(t[`users/user${l}/bookmarks/${d}/${e+s.id}`]=null),t)),{})).then((()=>t(F("Unavailable bookmarks removed.",m.v))))},children:"(Remove)."})]})]}),Object(we.jsx)("div",{className:"bookmarks__content",children:d===u.current&&("posts"===d?p.map(((e,t)=>Object(we.jsx)(Jt,{fetchedItems:h,index:t,loadingCallback:v,post:e},e.id))):"users"===d?Object(we.jsx)(zt,{button:"bookmarks",users:p}):Object(we.jsx)(Ft,{communitiesInfo:p.map((e=>e.info))}))})]})}),Object(we.jsx)("aside",{className:"sidebar",children:Object(we.jsxs)("div",{className:"sidebar__wrapper",children:[Object(we.jsx)(c.b,{className:x("posts"),to:"/bookmarks",children:`Posts (${Object.keys({...null===r||void 0===r?void 0:r.posts}).length})`}),Object(we.jsx)(c.b,{className:x("users"),to:"?tab=users",children:`Users (${Object.keys({...null===r||void 0===r?void 0:r.users}).length})`}),Object(we.jsx)(c.b,{className:x("communities"),to:"?tab=communities",children:`Communities (${Object.keys({...null===r||void 0===r?void 0:r.communities}).length})`})]})})]})}function es(){const e=Object(i.b)(),t=De(),s=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),[a,c]=Object(n.useState)([]),[r,l]=Object(n.useState)(),[d,u]=Object(n.useState)([]),{finishLoading:m}=Le();return Object(n.useEffect)((()=>{if(null!==s)return ie("communities").on((e=>{m("Communities");const t=Object.values({...e}),n=t.filter((e=>e.info.creatorId!==s));Object(o.unstable_batchedUpdates)((()=>{c(t.filter((e=>e.info.creatorId===s))),l(n.filter((e=>{var t;return!(null===(t=e.subscribers)||void 0===t?void 0:t["user"+s])&&!e.info.deleted}))),u(n.filter((e=>{var t;return null===(t=e.subscribers)||void 0===t?void 0:t["user"+s]})))}))}))}),[m,s]),r?Object(we.jsx)("section",{className:"communities",children:Object(we.jsxs)("div",{className:"content-width",children:[Object(we.jsxs)("div",{className:"communities__header",children:[Object(we.jsx)("h1",{className:"communities__title",children:"Communities"}),Object(we.jsx)(He,{testId:"open-create-community-modal",text:"Create new community",onClick:()=>s?e(D("create-community")):t()})]}),a.length>0&&Object(we.jsxs)("div",{className:"communities__item",children:[Object(we.jsx)("div",{className:"communities__item-header",children:Object(we.jsx)("h2",{className:"communities__item-title",children:`My communities (${a.length})`})}),Object(we.jsx)(Ft,{communitiesInfo:a.map((e=>e.info)),renderSubscribeButton:!1})]}),d.length>0&&Object(we.jsxs)("div",{className:"communities__item",children:[Object(we.jsx)("div",{className:"communities__item-header",children:Object(we.jsx)("h2",{className:"communities__item-title",children:`Subscribed (${d.length})`})}),Object(we.jsx)(Ft,{communitiesInfo:d.map((e=>e.info))})]}),r.length>0&&Object(we.jsxs)("div",{className:"communities__item",children:[Object(we.jsx)("div",{className:"communities__item-header",children:Object(we.jsx)("h2",{className:"communities__item-title",children:`Explore (${r.length})`})}),Object(we.jsx)(Ft,{communitiesInfo:r.map((e=>e.info))})]})]})}):null}function ts(){return Object(n.useEffect)((()=>document.title="404 Not Found | Social App"),[]),Object(we.jsx)("section",{className:"error-404",children:Object(we.jsx)("div",{className:"content-width",children:Object(we.jsxs)("div",{className:"error-404__wrapper",children:[Object(we.jsx)("p",{className:"error-404__number",children:"404"}),Object(we.jsx)("h2",{className:"error-404__title",children:"Not Found"}),Object(we.jsx)("p",{className:"error-404__text",children:"The requested page was not found on our server. It may have been removed."})]})})})}function ss(){var e,t,s,o,a,c;const r=Object(i.b)(),{communityId:l}=Object(Ie.useParams)(),d=De(),u=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.admin})),b=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),j=_e((e=>{var t,s,n;return null===(t=e.user)||void 0===t||null===(s=t.communities)||void 0===s||null===(n=s.subscribed)||void 0===n?void 0:n["community"+l]})),{AsyncButton:h,buttonLoading:f,setButtonLoading:v}=Pe(),{addImgPreview:p,imgPreview:O,setImgPreview:x}=Re(!1),_=Object(n.useRef)([]),[g,y]=Object(n.useState)(),[N,w]=Object(n.useState)(),[k,I]=Object(n.useState)(!1),[C,S]=Object(n.useState)(),[E,T]=Object(n.useState)(!1),{fetchedItems:L,finishLoading:P,loaded:R,setTitle:M}=Le(),A=Object(n.useCallback)((()=>P(g.info.title)),[g,P]);function q(){var e;V(l,null===(e=g.fullInfo.banner)||void 0===e?void 0:e.src,g.info.subscriberCount)}return Object(n.useEffect)((()=>{if(null===b)return;let e,t;const s=le({callback:s=>{if(_.current=[],null===s||void 0===s?void 0:s.profilePhotos){for(const e in s.profilePhotos){var n;(null===(n=s.photos)||void 0===n?void 0:n[e])&&_.current.push(s.photos[e])}_.current.sort(((e,t)=>t.date-e.date))}y(s),s?((t=>{var s;t.info.deleted||(null===(s=e)||void 0===s||s(),e=le({callback:e=>w([e.info]),userId:t.info.creatorId}))})(s),(()=>{var e;null===(e=t)||void 0===e||e(),t=ie("posts").orderByChild("communityId").equalTo(l).on((e=>{const t=Object.values({...e});S(t.sort(((e,t)=>+t.id-+e.id))),L.current.setExpected(t.length)}))})()):P()},community:!0,fields:["fullInfo","info","photos","profilePhotos"],userId:l});return()=>{var n,o;s(),null===(n=e)||void 0===n||n(),null===(o=t)||void 0===o||o()}}),[l,L,P,b]),Object(n.useEffect)((()=>{R.current&&g?M(g.info.title):0===(null===C||void 0===C?void 0:C.length)?A():null===g&&P()}),[g,P,R,A,C,M]),void 0===g?null:g?Object(we.jsxs)("section",{className:"community",children:[Object(we.jsx)("div",{className:"content-width",children:Object(we.jsxs)("div",{className:"community__content",children:[Object(we.jsxs)("div",{className:"community__header",children:[g.info.creatorId!==b&&!u||g.info.deleted?(null===(o=g.fullInfo)||void 0===o?void 0:o.banner)&&Object(we.jsx)("div",{className:"community__banner",children:Object(we.jsx)("img",{className:"community__banner-img",src:null===(a=g.fullInfo)||void 0===a?void 0:a.banner.src,alt:""})}):O[0]?Object(we.jsxs)(we.Fragment,{children:[Object(we.jsx)("div",{className:"community__banner",children:Object(we.jsx)("img",{className:"community__banner-img",src:O[0].result,alt:""})}),Object(we.jsxs)("div",{className:"community__header-buttons",children:[Object(we.jsx)(h,{text:"Confirm banner",onClick:function(){var e;if(f)return;v();const t=null===(e=g.fullInfo.banner)||void 0===e?void 0:e.src;oe({callback:()=>{t&&$.delete(t),v(!1),x([])},communityId:l,createId:!1,file:O[0].file,imgParent:"fullInfo",imgPath:"banner",storagePrefix:"community"+l})}}),!f&&Object(we.jsx)(He,{preset:"secondary",text:"Cancel",onClick:()=>x([])})]})]}):Object(we.jsxs)("label",{className:"community__banner-upload",htmlFor:"community__banner-overlay-input",children:[Object(we.jsxs)("button",{className:"community__banner-button community__banner",onClick:e=>{var t;return null===(t=e.target.closest("label"))||void 0===t?void 0:t.click()},children:[(null===(e=g.fullInfo)||void 0===e?void 0:e.banner)?Object(we.jsx)("img",{className:"community__banner-img",src:null===(t=g.fullInfo)||void 0===t?void 0:t.banner.src,alt:""}):Object(we.jsx)("p",{className:"community__banner-placeholder",children:"No banner"}),Object(we.jsxs)("div",{className:"community__banner-overlay",children:[Object(we.jsx)(m.C,{className:"community__banner-overlay-icon",style:{height:"1.1em"}}),Object(we.jsx)("p",{className:"community__banner-overlay-text",children:((null===(s=g.fullInfo)||void 0===s?void 0:s.banner)?"Change":"Set")+" banner"})]})]}),Object(we.jsx)("input",{className:"community__banner-overlay-input",id:"community__banner-overlay-input",type:"file",accept:".jpg, .jpeg, .png",hidden:!0,onChange:p})]}),Object(we.jsxs)("div",{className:"community__info",children:[Object(we.jsxs)("div",{className:"community__info-content",children:[Object(we.jsx)(ze,{avatar:_.current.find((e=>e.src===g.info.avatar)),userInfo:g.info}),Object(we.jsxs)("div",{className:"community__info-text",children:[Object(we.jsx)(Ue,{className:"community-title",databaseRef:`communities/community${l}/info/title`,disabled:g.info.deleted,field:g.info.title,ownerId:g.info.creatorId,renderInputId:"title"}),Object(we.jsx)("p",{className:"community__info-subscribers",children:G("subscriber",g.info.subscriberCount||0)}),k&&Object(we.jsx)("div",{className:"community__contacts",children:null===N||void 0===N?void 0:N.map((e=>Object(we.jsx)(Ke,{avatarSize:"small",bottomText:"Creator",enableAvatarPreview:!1,userInfo:e},e.id)))})]})]}),Object(we.jsxs)("div",{className:"community__info-buttons",children:[Object(we.jsx)(He,{className:"community-subscribe",preset:j?"remove":"primary",text:j?"Unsubscribe":"Subscribe",onClick:()=>ee(l,d,b,!!j)}),!g.info.deleted&&Object(we.jsx)("button",{className:"community__toggle",onClick:()=>I(!k),children:(k?"Hide":"Show")+" contacts"})]})]}),(b===g.info.creatorId||u)&&Object(we.jsxs)("div",{className:"community__info-footer-buttons",children:[Object(we.jsx)(He,{text:"Change avatar",onClick:()=>r(D("change-avatar",{changeAvatarCommunityId:l}))}),Object(we.jsx)(He,{preset:"remove",text:"Delete community",onClick:q})]})]}),Object(we.jsxs)("div",{className:"community__description",children:[Object(we.jsx)("h3",{className:"community__description-title",children:"Description"}),Object(we.jsxs)("div",{className:"community__description-wrapper",children:[Object(we.jsx)(Ue,{databaseRef:`communities/community${l}/fullInfo/description`,disabled:g.info.deleted,emptyButtonText:"Set description",emptyFieldText:"No description provided.",field:g.info.deleted?"This community has been deleted.":null===(c=g.fullInfo)||void 0===c?void 0:c.description,ownerId:g.info.creatorId,renderInputId:"description"}),E&&Object(we.jsxs)("div",{className:"community__description-short",children:[Object(we.jsx)("h4",{className:"community__description-short-title",children:"Short description:"}),Object(we.jsx)(Ue,{databaseRef:`communities/community${l}/info/shortDescription`,disabled:g.info.deleted,emptyButtonText:"Set short description",emptyFieldText:"No description provided.",field:g.info.deleted?"This community has been deleted.":g.info.shortDescription,ownerId:g.info.creatorId,renderInputId:"shortDescription"})]}),(b===g.info.creatorId||u)&&!g.info.deleted&&Object(we.jsx)("button",{className:"community__toggle",onClick:()=>T(!E),children:(E?"Hide":"Show")+" short description"})]})]}),b===g.info.creatorId&&!g.info.deleted&&Object(we.jsx)(Ht,{addToPhotosButton:!0,avatar:g.info.avatar,community:!!l,userId:l}),!g.info.deleted&&Object(we.jsxs)("div",{className:"community__posts",children:[Object(we.jsx)("div",{className:"community__posts-header",children:Object(we.jsx)("h3",{className:"community__posts-title",children:"Posts"})}),null===C||void 0===C?void 0:C.map(((e,t)=>Object(we.jsx)(Jt,{fetchedItems:L,index:t,loadingCallback:A,post:e},e.id)))]})]})}),!g.info.deleted&&Object(we.jsxs)("aside",{className:"community__sidebar sidebar",children:[Object(we.jsx)("h3",{className:"community__sidebar-title",children:`Contacts (${null===N||void 0===N?void 0:N.length})`}),Object(we.jsx)("div",{className:"community__sidebar-content",children:Object(we.jsx)("div",{className:"community__contacts",children:null===N||void 0===N?void 0:N.map((e=>Object(we.jsx)(Ke,{avatarSize:"small",bottomText:"Creator",userInfo:e},e.id)))})}),(b===g.info.creatorId||u)&&Object(we.jsxs)("div",{className:"community__sidebar-buttons",children:[Object(we.jsx)(He,{text:"Change avatar",onClick:()=>r(D("change-avatar",{changeAvatarCommunityId:l}))}),Object(we.jsx)(He,{preset:"remove",testId:"delete-community-btn",text:"Delete community",onClick:q})]})]})]}):Object(we.jsx)(ts,{})}function ns(){const e=Object(i.b)(),{replace:t}=Object(Ie.useHistory)(),{search:s}=Object(Ie.useLocation)(),a=new URLSearchParams(s).get("interlocutor"),{conversationId:c}=Object(Ie.useParams)(),r=De(),l=_e((e=>e.modal.currentModal)),d=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.conversations})),u=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),b=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.info})),j=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.photos})),[h,f]=Object(n.useState)(null),[v,p]=Object(n.useState)(null),[O,x]=Object(n.useState)(),[_,g]=Object(n.useState)([]),{finishLoading:y,loaded:N}=Le(),w=Object(n.useRef)(),k=Object(n.useRef)(!1);k.current=!!a||!!(null===d||void 0===d?void 0:d["conversation"+c]);const I=Object(n.useRef)([]),C=()=>I.current.forEach((e=>e())),$=Object(n.useCallback)((()=>{window.innerHeight<document.body.offsetHeight&&window.scrollTo(0,document.body.offsetHeight)}),[]);Object(n.useEffect)((()=>(null===h||void 0===h?void 0:h.info.id)&&setTimeout($,0)),[null===h||void 0===h?void 0:h.info.id,$]);const E=Object(n.useCallback)((()=>{f(null),p(null),x([]),!N.current&&y()}),[y,N]);Object(n.useEffect)((()=>{!c&&!a&&E()}),[c,E,a]),Object(n.useEffect)((()=>void 0===u&&r()),[r,u]);const T=Object(n.useCallback)((e=>{u&&(w.current=le({callback:t=>{!N.current&&y("Conversation");const s=`conversations/conversation${e.info.id}/`,n=e.messages.reduce(((e,t)=>(t.read||t.authorId===u||(e[`${s}messages/${t.id}/read`]=S),e)),{}),{lastMessage:a}=e.info;(null===a||void 0===a?void 0:a.content)&&!a.read&&a.authorId!==u&&(n[`${s}info/lastMessage/read`]=S),ie().update(n),Object(o.unstable_batchedUpdates)((()=>{f(e),p(t),x([t,{info:b,photos:j}])}))},fields:["connections","info","photos"],userId:e.info.participants.find((e=>e!==u))}))}),[y,N,u,b,j]),L=Object(n.useCallback)((e=>{const t=Object.values({...d}),s=[];I.current=[];const n=()=>{if(s.length===t.length&&!s.includes(void 0)){C();for(const n of s)if(n.includes(u)&&n.includes(a||(null===v||void 0===v?void 0:v.info.id)))return void e(t[s.indexOf(n)]);e()}};t.forEach(((e,t)=>{I.current.push(ie(`conversations/conversation${e}/info/participants`).on((e=>{s[t]=e,n()})))})),!t.length&&n()}),[null===v||void 0===v?void 0:v.info.id,a,d,u]);Object(n.useEffect)((()=>C),[null===v||void 0===v?void 0:v.info.id,a,d,u]),Object(n.useEffect)((()=>{if(!c&&a&&u){if(u!==a)return L((e=>{e?t("/conversation"+e):T({info:{creationTime:null,id:"0",lastMessage:null,participants:[u,a]},messages:[]})})),w.current;E()}}),[L,E,c,T,t,a,u]),Object(n.useEffect)((()=>{if(!c||!u)return;if(!k.current)return void y();const e=ie("conversations/conversation"+c).on((e=>{var t;null===(t=w.current)||void 0===t||t.call(w),e?(e.messages=Object.values({...e.messages}).sort(((e,t)=>e.date-t.date)),T(e)):E()}));return()=>{var t;e(),null===(t=w.current)||void 0===t||t.call(w)}}),[E,c,T,y,d,u]);function P(e,t){if(_.find((e=>e.id===t.id))){const e=[..._];e.splice(_.indexOf(t),1),g(e)}else if(e.shiftKey){const e=h.messages,s=e.indexOf(t),n=e.indexOf(_[_.length-1]),o=[..._];for(let t=Math.min(n+1,s);t<Math.max(s+1,n);t++)!_.find((s=>s.id===e[t].id))&&o.push(e[t]);g(o)}else g([..._,t])}return Object(n.useEffect)((()=>{const e=e=>{"Escape"!==e.key||l||g([])};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)}),[l]),null===u||!O&&k.current?null:void 0!==u&&v&&O&&k.current?Object(we.jsx)("section",{className:"conversation",children:Object(we.jsx)("div",{className:"content-width",children:Object(we.jsxs)("div",{className:"conversation__wrapper",children:[Object(we.jsx)("div",{className:"conversation__header",children:Object(we.jsxs)("div",{className:"conversation__header-wrapper",children:[Object(we.jsxs)("div",{className:"conversation__header-interlocutor",children:[Object(we.jsx)(Fe,{size:"small",src:v.info.avatar,userId:v.info.id}),Object(we.jsx)(Be,{text:K(v),userInfo:v.info})]}),_.length>0&&Object(we.jsxs)("div",{className:"conversation__header-overlay",children:[Object(we.jsxs)("button",{className:"conversation__header-overlay-qty",onClick:()=>g([]),children:[Object(we.jsx)("span",{className:"conversation__header-overlay-qty-icon",children:"\xd7"}),G("message",_.length)]}),Object(we.jsxs)("div",{className:"conversation__header-overlay-buttons",children:[Object(we.jsx)("button",{className:"conversation__header-overlay-button","aria-label":"Copy messages to clipboard",onClick:function(){navigator.clipboard.writeText([..._].sort(((e,t)=>e.date-t.date)).reduce(((e,t)=>e+((t.content.text||"")+" ")),"").trim()).then((()=>e(F("Text copied to clipboard.",m.w))))},children:Object(we.jsx)(m.w,{})}),Object(we.jsx)("button",{className:"conversation__header-overlay-button","aria-label":"Delete messages",onClick:function(){const t=_.map((e=>e.id)),s=h.messages.filter((e=>!t.includes(e.id)));_.find((e=>e.authorId!==u))?e(D("action-error",{actionError:"You can't delete someone else's messages. Try to select only your own messages and try again."})):e(D("action-confirm",{actionConfirm:{callback:()=>{g([]);const t=`conversations/conversation${c}/`,n={[t+"info/lastMessage"]:s[s.length-1]||{date:h.info.lastMessage.date}};_.forEach((e=>n[`${t}messages/${e.id}`]=null)),ie().update(n).then((()=>e(F(_.length+" message(s) deleted.",m.F))))},irreversible:!0,text:`Are you sure you want to delete ${G("message",_.length)}?`}}))},children:Object(we.jsx)(m.F,{})})]})]})]})}),Object(we.jsx)("div",{className:"conversation__content",children:h.messages.map(((e,t)=>Object(we.jsx)(os,{index:t,message:e,participants:O,previousMessage:h.messages[t-1],selectedMessages:_,selectMessage:P},e.id)))}),Object(we.jsx)("div",{className:"conversation__footer",children:Object(we.jsx)("div",{className:"conversation__footer-wrapper",children:Object(we.jsx)(Ht,{avatar:b.avatar,buttonText:"Message",inputPlaceholder:"Your message",mobileSubmit:!0,uploadCallback:e=>new Promise((s=>{function n(n,o){const i=ie().newKey(),r={authorId:u,content:e,date:S,id:i},l=e=>`users/user${e}/conversations/conversation${n}`,d=`conversations/conversation${n}/`;ie().update(o?{"contentData/nextConversationId":`${parseInt(n,10)+1}`,["conversations/conversation"+n]:{info:{creationTime:S,id:n,lastMessage:r,participants:O.map((e=>e.info.id))},messages:{[i]:r}},[l(u)]:n,[l(a)]:n}:{[d+"info/lastMessage"]:r,[d+"messages/"+i]:r}).then((()=>{(o||c!==n)&&t("/conversation"+n),s(),$()}))}"0"===h.info.id?L((e=>{e?n(e):ie("contentData/nextConversationId").once((e=>n(e,!0)))})):n(h.info.id)})),userId:u})})})]})})}):Object(we.jsx)(ts,{})}function os(e){let{index:t,message:s,participants:n,previousMessage:o,selectedMessages:a,selectMessage:i}=e;const c=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),r=0===t||s.authorId!==o.authorId||s.date>o.date+3e5;return Object(we.jsxs)("button",{className:"conversation__message"+(a.find((e=>e.id===s.id))?" conversation__message--selected":""),onClick:e=>i(e,s),children:[r&&Object(we.jsx)(Fe,{size:"small",src:n.find((e=>e.info.id===s.authorId)).info.avatar,userId:s.authorId,onClick:e=>e.stopPropagation()}),Object(we.jsxs)("div",{className:"conversation__message-wrapper",children:[r&&Object(we.jsx)(Be,{onlyName:!0,text:H(s.date),userInfo:n.find((e=>e.info.id===s.authorId)).info,onClick:e=>e.stopPropagation()}),Object(we.jsx)(Zt,{author:n.find((e=>e.info.id===s.authorId)),content:s.content,linkStopPropagation:!0}),s.authorId===c&&Object(we.jsx)("div",{className:"conversation__message-status",children:s.read?Object(we.jsx)(m.d,{}):Object(we.jsx)(m.D,{})})]})]})}function as(){const{search:e}=Object(Ie.useLocation)(),{ownerId:t}=Object(Ie.useParams)(),s=new URLSearchParams(e).get("tab"),o=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),a=_e((e=>{var t,s;return null===(t=e.user)||void 0===t||null===(s=t.friendRequests)||void 0===s?void 0:s.received})),[i,r]=Object(n.useState)(),[l,d]=Object(n.useState)(!1),u=Object(n.useRef)(""),{fetchedItems:m,finishLoading:b,loaded:j,setTitle:h}=Le(),f=Object(n.useCallback)((()=>b(u.current)),[b]);if(Object(n.useEffect)((()=>{if(null!==o)return le({callback:r,fields:["friends","info"],userId:t||o})}),[m,t,o]),Object(n.useEffect)((()=>{(null===i||void 0===i?void 0:i.info.id)?(u.current=i.info.id===o?"requests"===s?"My friend requests":"My friends":`${i.info.name} ${i.info.lastName}'s friends`,j.current&&h(u.current),l||d(!0),m.current.setExpected(Object.keys("requests"===s?{...a}:{...i.friends}).length,f)):null===i&&(d(!0),b())}),[m,b,i,j,f,s,h,l,a,o]),!l)return null;if(!i)return Object(we.jsx)(ts,{});const v=Object.values({...i.friends}),p=Object.values({...a}),O=i.info.id===o&&"requests"===s;return Object(we.jsxs)("section",{className:"friends",children:[Object(we.jsx)("div",{className:"content-width",children:Object(we.jsxs)("div",{className:"friends__wrapper",children:[Object(we.jsx)("div",{className:"friends__header",children:Object(we.jsx)(c.b,{className:"friends__title",to:"/id"+i.info.id,children:O?`Your friend requests (${p.length})`:`${i.info.id!==o?`${i.info.name}'s`:"Your"} friends (${v.length})`})}),(O?p:v).length>0&&Object(we.jsx)("div",{className:"users-list",children:(O?p:v).map((e=>Object(we.jsx)(is,{fetchedItems:m,friendId:e.userId,friendRequestDate:e.date,loadingCallback:f},e.userId)))})]})}),i.info.id===o&&Object(we.jsx)("aside",{className:"sidebar",children:Object(we.jsxs)("div",{className:"sidebar__wrapper",children:[Object(we.jsx)(c.b,{className:"sidebar__button"+("requests"!==s?" sidebar__button--active":""),to:"/friends",children:`Friends (${v.length})`}),Object(we.jsx)(c.b,{className:"sidebar__button"+("requests"===s?" sidebar__button--active":""),to:"?tab=requests",children:`Friend requests (${p.length})`})]})})]})}function is(e){let{fetchedItems:t,friendId:s,friendRequestDate:o,loadingCallback:a}=e;const[i,c]=Object(n.useState)();return Object(n.useEffect)((()=>le({callback:e=>{c(e),t.current.incrementQty(s,a)},fields:["connections","info"],userId:s})),[t,s,a]),i?Object(we.jsx)(zt,{requestDate:o,singleUser:i}):null}let cs;function rs(){const e=Object(i.b)(),{replace:t}=Object(Ie.useHistory)(),{search:s}=Object(Ie.useLocation)(),o=new URLSearchParams(s).get("from"),a=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),{formState:{errors:c},handleSubmit:r,register:l}=Object(Te.a)(),{AsyncButton:d,buttonLoadingRef:u,setButtonLoading:b}=Pe(),[j,h]=Object(n.useState)(!1);return Object(n.useEffect)((()=>{a?t(o||"/news"):void 0===a&&(document.title="Log in | Social App")}),[o,t,a]),void 0!==a?null:Object(we.jsx)("section",{className:"home",children:Object(we.jsx)("div",{className:"content-width",children:Object(we.jsxs)("div",{className:"home__wrapper",children:[Object(we.jsxs)("div",{className:"home__info",children:[Object(we.jsx)("h1",{className:"home__info-title",children:"Social App"}),Object(we.jsx)("p",{className:"home__info-text",children:"Connect with your friends and communities on Social App."})]}),Object(we.jsxs)("div",{className:"home__content",children:[Object(we.jsxs)("form",{className:"primary-form",action:"#",method:"post",noValidate:!0,onChange:()=>b(!1),onSubmit:r((function(t){var s;u.current||(b(),null===(s=cs)||void 0===s||s(),cs=ie("users").orderByChild("account/email").equalTo(t.email).on((s=>{if(cs(),u.current){if(s){const n=Object.values(s)[0];(null===n||void 0===n?void 0:n.account.email)===t.email&&N(n.account.password)===t.password?(re("users/user"+n.account.id),e(he(n)),e(tt())):h(!0)}else h(!0);b(!1)}})))})),children:[Object(we.jsx)(qe,{autoFocus:!0,id:"home__form-email",onInput:()=>h(!1),opts:{obj:Me.find((e=>"email"===e.id)),errors:c,label:!0,placeholder:!0,register:l}}),Object(we.jsx)(qe,{id:"home__form-password",onInput:()=>h(!1),opts:{obj:Me.find((e=>"existingPassword"===e.id)),errors:c,label:!0,placeholder:!0,register:l}}),j&&Object(we.jsx)("p",{className:"error-text",children:"Wrong email or password."}),Object(we.jsx)(d,{testId:"log-in-btn",text:"Log in",type:"submit"})]}),Object(we.jsx)("button",{className:"home__content-forgot-password",onClick:()=>e(F("Not available.",m.m)),children:"Forgot password?"}),Object(we.jsx)("hr",{className:"home__content-hr"}),Object(we.jsx)(He,{preset:"secondary",testId:"open-sign-up-modal",text:"Sign up",onClick:()=>e(D("sign-up"))})]})]})})})}function ls(){const e=De(),t=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.conversations})),s=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),[o,a]=Object(n.useState)(),{fetchedItems:i,finishLoading:c}=Le(),r=Object(n.useCallback)((()=>c("Messages")),[c]);return Object(n.useEffect)((()=>{if(!s)return;if(!t)return r(),void a([]);const e=Object.values({...t}),n=[],o=[];return e.forEach(((t,s)=>{n[s]=ie(`conversations/conversation${t}/info`).on((t=>{o[s]=t,o.includes(void 0)||o.length!==e.length||(a(o.sort(((e,t)=>t.lastMessage.date-e.lastMessage.date))),i.current.setExpected(e.length,r))}))})),()=>n.forEach((e=>e()))}),[i,r,t,s]),Object(n.useEffect)((()=>void 0===s&&e()),[e,s]),void 0!==s&&o?Object(we.jsx)("section",{className:"messages",children:Object(we.jsx)("div",{className:"content-width",children:Object(we.jsx)("div",{className:"messages__wrapper",children:o.length?o.map((e=>Object(we.jsx)(ds,{conversation:e,fetchedItems:i,loadingCallback:r},e.id))):Object(we.jsx)("p",{className:"no-content",children:"No messages"})})})}):null}function ds(e){var t;let{conversation:s,fetchedItems:o,loadingCallback:a}=e;const i=_e((e=>{var t,s;return null===(t=e.user)||void 0===t||null===(s=t.info)||void 0===s?void 0:s.avatar})),c=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),[r,l]=Object(n.useState)();return Object(n.useEffect)((()=>le({callback:e=>{l(e.info),o.current.incrementQty(e.info.id,a)},userId:s.participants.find((e=>e!==c))})),[s.participants,o,a,c]),r?Object(we.jsx)("div",{className:"messages__item",children:Object(we.jsx)(Ke,{bottomText:s.lastMessage&&H(s.lastMessage.date,!0),childrenBottom:(null===(t=s.lastMessage)||void 0===t?void 0:t.content)?Object(we.jsxs)("div",{className:"messages__item-last-message",children:[!s.lastMessage.read&&Object(we.jsx)(m.y,{className:"messages__item-last-message-unread"}),Object(we.jsx)("img",{className:"avatar__img-small",src:s.lastMessage.authorId===c?i:r.avatar,alt:"Avatar"}),Object(we.jsx)("p",{className:"messages__item-last-message-content",children:s.lastMessage.content.text||"Photo"})]}):Object(we.jsx)("p",{className:"messages__item-no-messages",children:"No messages yet"}),userInfo:r,wrapperLink:"/conversation"+s.id})}):null}function us(){const{replace:e}=Object(Ie.useHistory)(),t=_e((e=>{var t,s;return null===(t=e.user)||void 0===t||null===(s=t.info)||void 0===s?void 0:s.avatar})),s=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),[o,a]=Object(n.useState)([]),{fetchedItems:i,finishLoading:c}=Le(),r=Object(n.useCallback)((()=>c("News")),[c]);return Object(n.useEffect)((()=>{if(void 0===s&&e("/"),s)return ie("posts").on((e=>{const t=Object.values(e);a(t.sort(((e,t)=>+t.id-+e.id))),i.current.setExpected(t.length,r)}))}),[i,r,e,s]),s&&o.length?Object(we.jsx)("section",{className:"news",children:Object(we.jsxs)("div",{className:"content-width",children:[Object(we.jsx)(Ht,{addToPhotosButton:!0,avatar:t,userId:s}),o.map(((e,t)=>Object(we.jsx)(Jt,{fetchedItems:i,index:t,loadingCallback:r,post:e},e.id)))]})}):null}function ms(){const e=Object(i.b)(),{ownerId:t}=Object(Ie.useParams)(),s=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),[o,a]=Object(n.useState)([]),[r,l]=Object(n.useState)();Object(n.useEffect)((()=>{if(null!==s)return le({callback:e=>{const t=[];for(const s in null===e||void 0===e?void 0:e.profilePhotos)(null===e||void 0===e?void 0:e.photos)&&t.push(e.photos[s]);a(t.sort(((e,t)=>t.date-e.date))),l(e)},fields:["info","photos","profilePhotos"],userId:t||s})}),[t,s]);const{finishLoading:d,loaded:u,setTitle:m}=Le();return Object(n.useEffect)((()=>{const e=t!==s&&t?`${null===r||void 0===r?void 0:r.info.name} ${null===r||void 0===r?void 0:r.info.lastName}'s photos`:"My photos";u.current?m(e):r?d(e):null===r&&d()}),[u,t,r,d,s,m]),void 0===r?null:r?Object(we.jsx)("section",{className:"photos",children:Object(we.jsx)("div",{className:"content-width",children:Object(we.jsxs)("div",{className:"photos__wrapper",children:[Object(we.jsx)("div",{className:"photos__header",children:Object(we.jsx)(c.b,{className:"photos__title",to:"/id"+r.info.id,children:`${t!==s&&t?`${r.info.name}'s`:"My"} photos (${o.length})`})}),Object(we.jsx)("div",{className:"photos__items",children:o.map(((t,s)=>Object(we.jsx)(c.b,{className:"photos__item",to:"#javascript",onClick:t=>{e(D("gallery",{gallery:{authorInfo:r.info,content:o,initialSlide:s}})),t.preventDefault()},children:Object(we.jsx)("img",{className:"photos__item-img",src:t.src,alt:""})},t.id)))})]})})}):Object(we.jsx)(ts,{})}function bs(){const{postId:e}=Object(Ie.useParams)(),[t,s]=Object(n.useState)(),{fetchedItems:o,finishLoading:a}=Le(),i=Object(n.useCallback)((()=>a("Post")),[a]);return Object(n.useEffect)((()=>ie("posts/post"+e).on((e=>{e?(s(e),o.current.setExpected(1)):(a(),s(null))}))),[o,a,e]),void 0===t?null:null===t?Object(we.jsx)(ts,{}):Object(we.jsx)("section",{className:"post-page",children:Object(we.jsx)("div",{className:"content-width",children:Object(we.jsx)(Jt,{fetchedItems:o,loadingCallback:i,post:t,renderComments:!0})})})}function js(e){var t,s;let{profileOwner:n,profilePhotos:o}=e;const a=Object(i.b)(),{ownerId:r}=Object(Ie.useParams)(),l=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),d=_e((e=>{var t,s,n;return null===(t=e.user)||void 0===t||null===(s=t.friendRequests)||void 0===s||null===(n=s.received)||void 0===n?void 0:n["user"+r]})),u=_e((e=>{var t,s,n;return null===(t=e.user)||void 0===t||null===(s=t.friendRequests)||void 0===s||null===(n=s.sent)||void 0===n?void 0:n["user"+r]}));function b(){a(D("action-confirm",{actionConfirm:{callback:()=>ie().update({[`users/user${r}/friends/user${l}`]:null,[`users/user${l}/friends/user${r}`]:null}).then((()=>a(F("Friend removed.",m.P)))),text:"Are you sure you want to remove this friend?"}}))}const j=Object.values({...n.friends});return Object(we.jsxs)("div",{className:"profile__left",children:[Object(we.jsx)(ze,{avatar:o.current.find((e=>e.src===n.info.avatar)),userInfo:n.info}),Object(we.jsx)("div",{className:"profile__left-online-status",children:Object(we.jsx)("p",{className:"profile__left-online-status-text",children:K(n)})}),n.info.deleted?(null===(s=n.friends)||void 0===s?void 0:s["user"+l])&&Object(we.jsx)("div",{className:"profile__left-buttons",children:Object(we.jsx)(He,{afterIcon:m.P,iconStyles:{width:"1.25em"},preset:"remove",text:"Remove friend",onClick:b})}):Object(we.jsxs)(we.Fragment,{children:[l&&(r!==l?Object(we.jsxs)("div",{className:"profile__left-buttons",children:[(null===(t=n.friends)||void 0===t?void 0:t["user"+l])?Object(we.jsx)(He,{afterIcon:m.P,iconStyles:{width:"1.25em"},preset:"remove",text:"Remove friend",onClick:b}):d?Object(we.jsx)(He,{afterIcon:m.Q,iconStyles:{width:"1.25em"},text:"Accept friend request",onClick:()=>U({reqUserId:r,userId:l})}):u?Object(we.jsx)(He,{afterIcon:m.R,iconStyles:{width:"1.25em"},preset:"remove",text:"Cancel friend request",onClick:function(){const e=`users/user${r}/`;ie().update({[`${e}friendRequests/received/user${l}`]:null,[`users/user${l}/friendRequests/sent/user${r}`]:null,[e+"fullInfo/followerCount"]:Object(g.e)(-1),[e+"notifications/friendRequest"+l]:null}).then((()=>a(F("Friend request cancelled.",m.R))))}}):Object(we.jsx)(He,{afterIcon:m.Q,iconStyles:{width:"1.25em"},text:"Add friend",onClick:function(){const e=`users/user${r}/`;ie().update({[`${e}friendRequests/received/user${l}`]:{date:S,userId:l},[`users/user${l}/friendRequests/sent/user${r}`]:{date:S,userId:r},[e+"fullInfo/followerCount"]:Object(g.e)(1),[e+"notifications/friendRequest"+l]:{date:S,id:l,type:"friendRequest"}}).then((()=>a(F("Friend request sent.",m.Q))))}}),Object(we.jsx)(He,{afterIcon:m.k,text:"Send message",to:"/conversation?interlocutor="+r})]}):Object(we.jsx)("div",{className:"profile__left-buttons",children:Object(we.jsx)(He,{afterIcon:m.t,iconStyles:{width:".75em"},preset:"secondary",text:"Change avatar",onClick:()=>a(D("change-avatar"))})})),Object(we.jsxs)("div",{className:"profile__left-friends",children:[Object(we.jsx)("div",{className:"profile__left-friends-header",children:Object(we.jsx)(c.b,{className:"profile__left-friends-title",to:`/friends${r!==l?r:""}`,children:`Friends (${j.length})`})}),j.length>0&&Object(we.jsx)("div",{className:"profile__left-friends-items",children:j.map((e=>Object(we.jsx)(hs,{friendId:e.userId},e.userId)))})]})]})]})}function hs(e){let{friendId:t}=e;const[s,o]=Object(n.useState)();return Object(n.useEffect)((()=>le({callback:e=>o(e.info),userId:t})),[t]),s?Object(we.jsxs)("div",{className:"profile__left-friends-item",children:[Object(we.jsx)(Fe,{size:"small",src:s.avatar,userId:t}),Object(we.jsx)(c.b,{className:"profile__left-friends-item-name",to:"/id"+t,children:s.name})]}):null}function fs(){var e,t,s,o;const a=Object(i.b)(),{ownerId:r}=Object(Ie.useParams)(),l=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.admin})),d=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),u=Object(n.useRef)(),m=Object(n.useRef)([]),[b,j]=Object(n.useState)(),[h,f]=Object(n.useState)(),{fetchedItems:v,finishLoading:p,loaded:O,setTitle:x}=Le(),_=Object(n.useCallback)((()=>{p((null===h||void 0===h?void 0:h.info.name)+" "+(null===h||void 0===h?void 0:h.info.lastName))}),[p,null===h||void 0===h?void 0:h.info.lastName,null===h||void 0===h?void 0:h.info.name]),g=Object(n.useCallback)((e=>{if(e){if(document.activeElement.blur(),m.current=[],e.profilePhotos){for(const s in e.profilePhotos){var t;(null===(t=e.photos)||void 0===t?void 0:t[s])&&m.current.push(e.photos[s])}m.current.sort(((e,t)=>t.date-e.date))}u.current=ie("posts").orderByChild("authorId").equalTo(r).on((e=>{const t=Object.values({...e});j(t.sort(((e,t)=>+t.id-+e.id))),v.current.setExpected(t.length)}))}else f(null)}),[v,r]);Object(n.useEffect)((()=>{O.current?x((null===h||void 0===h?void 0:h.info.name)+" "+(null===h||void 0===h?void 0:h.info.lastName)):0===(null===b||void 0===b?void 0:b.length)?_():null===h&&p()}),[p,O,_,r,b,h,x,d]),Object(n.useEffect)((()=>{if(null===d)return;const e=le({callback:e=>{var t;null===(t=u.current)||void 0===t||t.call(u),g(e),f(e)},fields:["connections","friends","fullInfo","info","photos","profilePhotos"],userId:r});return()=>{var t;e(),null===(t=u.current)||void 0===t||t.call(u)}}),[r,g,d]);const y=(e,t)=>e&&Object(we.jsxs)("p",{className:"profile__content-info-middle-item",children:[Object(we.jsx)("span",{className:"profile__content-info-middle-item-title",children:t+": "}),Object(we.jsx)("span",{className:"profile__content-info-middle-item-value",children:e})]}),N=e=>{let{link:t,qty:s,renderZero:n,text:o}=e;const a=t?c.b:"div";if(n||s)return Object(we.jsxs)(a,{className:"profile__content-info-footer-item"+(t?" profile__content-info-footer-button":""),to:t,children:[Object(we.jsx)("p",{className:"profile__content-info-footer-item-number",children:s}),Object(we.jsx)("p",{className:"profile__content-info-footer-item-title",children:o})]})};return void 0===h?null:h?Object(we.jsx)("section",{className:"profile",children:Object(we.jsx)("div",{className:"content-width",children:Object(we.jsxs)("div",{className:"profile__wrapper",children:[Object(we.jsx)(js,{profileOwner:h,profilePhotos:m}),Object(we.jsxs)("div",{className:"profile__content",children:[Object(we.jsxs)("div",{className:"profile__content-info",children:[Object(we.jsxs)("div",{className:"profile__content-info-header",children:[Object(we.jsxs)("div",{className:"profile__content-info-header-container",children:[Object(we.jsx)("h1",{className:"profile__content-info-header-name",children:`${h.info.name} ${h.info.lastName}`}),r!==d&&!h.info.deleted&&Object(we.jsx)(Ye,{bookmarkType:"user",itemId:r,children:l&&Object(we.jsx)(He,{text:"Delete user",onClick:function(){a(D("action-confirm",{actionConfirm:{callback:()=>Y(r),irreversible:!0,password:!0,text:"Are you sure you want to delete this account?"}}))}})})]}),Object(we.jsx)(Ue,{className:"user-status",databaseRef:`users/user${r}/fullInfo/status`,emptyButtonText:"Set status",field:null===(e=h.fullInfo)||void 0===e?void 0:e.status,ownerId:r,renderInputId:"status"})]}),Object(we.jsxs)("div",{className:"profile__content-info-middle",children:[y((()=>{var e;if(!(null===(e=h.fullInfo)||void 0===e?void 0:e.birthday))return;const t=new Date(h.fullInfo.birthday);return`${t.toLocaleString("en-US",{month:"long"})} ${t.getDate()}, ${t.getFullYear()}`})(),"Birthday"),y(null===(t=h.fullInfo)||void 0===t?void 0:t.country,"Country"),y(null===(s=h.fullInfo)||void 0===s?void 0:s.city,"City")]}),Object(we.jsxs)("div",{className:"profile__content-info-footer",children:[N({qty:null===(o=h.fullInfo)||void 0===o?void 0:o.followerCount,text:"followers"}),N({link:`/photos${r!==d?r:""}`,qty:Object.keys({...h.profilePhotos}).length,text:"photos"}),N({qty:null===b||void 0===b?void 0:b.length,renderZero:!0,text:"posts"})]})]}),!h.info.deleted&&Object(we.jsxs)(we.Fragment,{children:[Object(we.jsxs)("div",{className:"profile__content-photos",children:[Object(we.jsx)(c.b,{className:"profile__content-photos-title",to:`/photos${r!==d?r:""}`,children:"Photos: "+Object.keys({...h.profilePhotos}).length}),m.current.length>0&&Object(we.jsx)("div",{className:"profile__content-photos-container",children:m.current.map(((e,t)=>t<4&&Object(we.jsx)(c.b,{className:"profile__content-photos-img-container",to:"#javascript",onClick:e=>{a(D("gallery",{gallery:{authorInfo:h.info,content:m.current,initialSlide:t}})),e.preventDefault()},children:Object(we.jsx)("div",{className:"profile__content-photos-img-inner-container",children:Object(we.jsx)("img",{className:"profile__content-photos-img",src:e.src,alt:""})})},e.id)))})]}),Object(we.jsxs)("div",{className:"profile__content-posts",children:[Object(we.jsx)("div",{className:"profile__content-posts-header",children:Object(we.jsx)("h3",{className:"profile__content-posts-title",children:"Posts"})}),null===b||void 0===b?void 0:b.map(((e,t)=>Object(we.jsx)(Jt,{fetchedItems:v,index:t,loadingCallback:_,post:e},e.id)))]})]})]})]})})}):Object(we.jsx)(ts,{})}function vs(){const{push:e}=Object(Ie.useHistory)(),{finishLoading:t}=Le(),{search:s}=Object(Ie.useLocation)(),o=new URLSearchParams(s).get("query"),a=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),[i,c]=Object(n.useState)(),[r,l]=Object(n.useState)(""),d=Object(n.useCallback)((e=>!o||e.toLowerCase().includes(o.toLowerCase())),[o]);return Object(n.useEffect)((()=>{const e=[];let t=!1;return ie("contentData/nextUserId").once((s=>{if(t)return;const n=parseInt(s,10)-1,o=[],a=[];for(let t=0;t<n;t++)e[t]=le({callback:e=>{o[t]||e.info.deleted||!d(e.info.name)&&!d(e.info.lastName)||a.push(e),o[t]=!0,o.length!==n||o.includes(void 0)||c(a.sort(((e,t)=>+e.info.id-+t.info.id)))},fields:["connections","info"],userId:`${t+1}`})})),()=>{t=!0,e.forEach((e=>e()))}}),[d]),Object(n.useEffect)((()=>{i&&t(o?`Search results for ${o}`:"Search")}),[t,i,o]),Object(n.useEffect)((()=>l(o||"")),[o]),Object(n.useEffect)((()=>{const t=setTimeout((()=>{(o||"")!==r&&e(`?query=${encodeURIComponent(r)||""}`)}),250);return()=>clearTimeout(t)}),[e,o,r]),null===a?null:Object(we.jsx)("section",{className:"search",children:Object(we.jsx)("div",{className:"content-width",children:Object(we.jsxs)("div",{className:"search__wrapper",children:[Object(we.jsxs)("div",{className:"search__header",children:[Object(we.jsx)("h1",{className:"search__title",children:`Search users (${null===i||void 0===i?void 0:i.length})`}),Object(we.jsx)(Ve,{value:r,onChange:e=>l(e.target.value),onSubmit:e=>e.preventDefault()})]}),Object(we.jsx)("div",{className:"search__content",children:(null===i||void 0===i?void 0:i.length)?Object(we.jsx)(zt,{users:i}):Object(we.jsx)("p",{className:"search__no-results",children:"No results."})})]})})})}function ps(){const{search:e}=Object(Ie.useLocation)(),t=new URLSearchParams(e).get("tab"),s=De(),o=_e((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),a=["account","security"].find((e=>e===t))||"information",{finishLoading:i}=Le();if(Object(n.useEffect)((()=>{void 0===o?s():o&&i("Settings")}),[i,s,o]),!o)return null;const r=e=>"sidebar__button"+(a===e?" sidebar__button--active":"");return Object(we.jsxs)("section",{className:"settings",children:[Object(we.jsx)("div",{className:"content-width",children:Object(we.jsxs)("div",{className:"settings__wrapper",children:[Object(we.jsx)("div",{className:"settings__header",children:Object(we.jsxs)("h1",{className:"settings__title",children:["information"===a&&"Main Information","security"===a&&"Security","account"===a&&"Account"]})}),"information"===a&&Object(we.jsx)(Os,{}),"security"===a&&Object(we.jsx)(xs,{}),"account"===a&&Object(we.jsx)(_s,{})]})}),Object(we.jsx)("aside",{className:"sidebar",children:Object(we.jsxs)("div",{className:"sidebar__wrapper",children:[Object(we.jsx)(c.b,{className:r("information"),to:"/settings",children:"Information"}),Object(we.jsx)(c.b,{className:r("security"),to:"?tab=security",children:"Security"}),Object(we.jsx)(c.b,{className:r("account"),to:"?tab=account",children:"Account"})]})})]})}function Os(){const e=Object(i.b)(),t=_e((e=>e.user.fullInfo)),s=_e((e=>e.user.info)),{formState:{errors:n},handleSubmit:o,register:a,reset:c}=Object(Te.a)(),{AsyncButton:r,buttonLoadingRef:l,setButtonLoading:d}=Pe();const u={errors:n,label:!0,register:a};return Object(we.jsxs)("form",{className:"primary-form",action:"#",method:"post",onSubmit:o((function(t){if(l.current)return;d(),t=W(t);for(const e in t)t[e]||(t[e]=null);const n=`users/user${s.id}/`,o=n+"fullInfo/",a=n+"info/";ie().update({[o+"birthday"]:t.birthday,[o+"city"]:t.city,[o+"country"]:t.country,[a+"gender"]:t.gender,[a+"lastName"]:t.lastName,[a+"name"]:t.name}).then((()=>{e(F("Information saved.",m.l)),d(!1),c()}))})),children:[Me.filter((e=>["name","lastName"].includes(e.id))).map((e=>Object(we.jsx)(qe,{opts:{obj:e,defaultValue:s[e.id],...u}},e.id))),Object(we.jsx)(Ae,{register:a,userGender:s.gender}),Me.filter((e=>["birthday","country","city"].includes(e.id))).map((e=>{var s;return Object(we.jsx)(qe,{max:null===(s=e.getMax)||void 0===s?void 0:s.call(e).value,min:e.min,opts:{obj:e,defaultValue:null===t||void 0===t?void 0:t[e.id],...u}},e.id)})),Object(we.jsxs)("div",{className:"settings__buttons",children:[Object(we.jsx)(r,{text:"Save",type:"submit"}),Object(we.jsx)(He,{preset:"secondary",text:"Cancel",onClick:()=>c()})]})]})}function xs(){const e=Object(i.b)(),t=_e((e=>e.user.account)),s=_e((e=>e.user.account.id)),{formState:{errors:o},handleSubmit:a,register:c,reset:r}=Object(Te.a)(),{AsyncButton:l,buttonLoadingRef:d,setButtonLoading:u}=Pe(),b=Object(n.useRef)(),[j,h]=Object(n.useState)(!1);return Object(we.jsxs)("form",{className:"primary-form",action:"#",method:"post",noValidate:!0,onSubmit:a((function(n){var o;d.current||(u(),null===(o=b.current)||void 0===o||o.call(b),b.current=ie("users").orderByChild("account/email").equalTo(n.email.toLowerCase()).on((o=>{if(b.current(),o&&!o["user"+s])return n.email=t.email,u(!1),void h(!0);ie(`users/user${t.id}/account`).update({email:n.email.toLowerCase(),password:y(n.password,s)}).then((()=>{N(t.password)!==n.password&&X({id:s,password:n.password}),e(F("Security data saved.",m.L)),u(!1),r()}))})))})),children:[Object(we.jsx)(qe,{onInput:()=>h(!1),opts:{obj:Me.find((e=>"email"===e.id)),defaultValue:t.email,errors:o,label:!0,register:c}}),j&&Object(we.jsx)("p",{className:"error-text",children:"This email is already used."}),Object(we.jsx)(qe,{opts:{obj:Me.find((e=>"password"===e.id)),defaultValue:N(t.password),errors:o,label:!0,register:c}}),Object(we.jsxs)("div",{className:"settings__buttons",children:[Object(we.jsx)(l,{text:"Save",type:"submit"}),Object(we.jsx)(He,{preset:"secondary",text:"Cancel",onClick:()=>{r(),h(!1)}})]})]})}function _s(){const e=Object(i.b)(),t=_e((e=>e.user.account.id));return Object(we.jsxs)("form",{className:"primary-form",action:"#",method:"post",onSubmit:function(s){s.preventDefault(),e(D("action-confirm",{actionConfirm:{callback:()=>{e(P("action-confirm")),setTimeout((()=>{e(fe()),setTimeout((()=>Y(t)),0)}),400)},irreversible:!0,password:!0,text:"Are you sure you want to delete your account?"}}))},children:[Object(we.jsx)("h3",{className:"primary-form__title",children:"Account removal"}),Object(we.jsx)(He,{preset:"remove",text:"Delete account",type:"submit"})]})}s(82);const gs=()=>document.documentElement.style.setProperty("--page-height",window.innerHeight+"px");function ys(){return window.history.scrollRestoration="manual",Object(we.jsx)(c.a,{children:Object(we.jsx)(i.a,{store:xe,children:Object(we.jsxs)(a.b.Provider,{value:{style:{flexShrink:0}},children:[Object(we.jsx)(qt,{}),Object(we.jsx)(Bt,{}),Object(we.jsx)(ct,{}),Object(we.jsx)("main",{className:d.a.main,children:Object(we.jsxs)(ot,{className:d.a.pageWidth,children:[Object(we.jsx)(ht,{}),Object(we.jsxs)(r.Switch,{loadingScreen:()=>Object(we.jsxs)("div",{className:"loading-screen loading-spinner",children:[Object(we.jsx)("div",{}),Object(we.jsx)("div",{}),Object(we.jsx)("div",{}),Object(we.jsx)("div",{})]}),children:[Object(we.jsx)(r.Route,{path:"/",exact:!0,component:rs}),Object(we.jsx)(r.Route,{path:"/bookmarks",component:Xt,loading:!0}),Object(we.jsx)(r.Route,{path:"/communities",component:es,loading:!0}),Object(we.jsx)(r.Route,{path:"/community:communityId",component:ss,loading:!0}),Object(we.jsx)(r.Route,{path:"/conversation",component:ns,loading:!0}),Object(we.jsx)(r.Route,{path:"/friends",component:as,loading:!0}),Object(we.jsx)(r.Route,{path:"/messages",component:ls,loading:!0}),Object(we.jsx)(r.Route,{path:"/news",component:us,loading:!0}),Object(we.jsx)(r.Route,{path:"/photos",component:ms,loading:!0}),Object(we.jsx)(r.Route,{path:"/search",component:vs,loading:!0}),Object(we.jsx)(r.Route,{path:"/settings",component:ps,loading:!0}),Object(we.jsx)(r.Route,{path:"/conversation:conversationId",component:ns,loading:!0}),Object(we.jsx)(r.Route,{path:"/friends:ownerId",component:as,loading:!0}),Object(we.jsx)(r.Route,{path:"/photos:ownerId",component:ms,loading:!0}),Object(we.jsx)(r.Route,{path:"/post:postId",component:bs,loading:!0}),Object(we.jsx)(r.Route,{path:"/id:ownerId",component:fs,loading:!0}),Object(we.jsx)(r.Route,{path:"/",component:ts})]})]})}),Object(we.jsx)(mt,{}),Object(we.jsx)(pt,{}),Object(we.jsx)(_t,{}),Object(we.jsx)(ke,{}),Object(we.jsx)(At,{})]})})})}gs(),window.addEventListener("resize",gs);var Ns=e=>{e&&e instanceof Function&&s.e(3).then(s.bind(null,92)).then((t=>{let{getCLS:s,getFID:n,getFCP:o,getLCP:a,getTTFB:i}=t;s(e),n(e),o(e),a(e),i(e)}))};Object(o.render)(Object(we.jsx)(n.StrictMode,{children:Object(we.jsx)(ys,{})}),document.getElementById("app")),Ns()}},[[83,1,2]]]);