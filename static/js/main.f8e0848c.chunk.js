(this["webpackJsonpreact-project"]=this["webpackJsonpreact-project"]||[]).push([[0],[,,,,,,,,,,,function(e,t,n){e.exports={notifications_submenu_wrapper:"jsH+a",user_submenu_wrapper:"p8-vI",header:"NXzL8",header_visible:"D19C5",wrapper:"_7R1Vb",logo:"_7bOtT",right:"ZNT+4",changeTheme:"_8YZBL",changeTheme_checked:"fenWx",changeTheme_wrapper:"_9wK7U",changeTheme_iconContainer:"HCGGD",changeTheme_input:"N05lZ",searchBar:"_6lY9N",notifications:"NG2xi",user:"c7q2f",notifications_submenu:"L+7KB",user_submenu:"dSQN1",user_button:"-3m-x",user_button_name:"T-lmu",user_submenu_button:"hCaAB",notifications_button:"Rg669",notifications_button_number:"iVQjb",notifications_button_wrapper:"ud9gz",notifications_submenu_clear:"c84G-",notifications_submenu_item:"+8Ou+",notifications_submenu_item_text:"oniLn",notifications_submenu_item_link:"hV9yn",notifications_submenu_item_remove:"_200d+",notifications_submenu_empty:"W6Ssp"}},,,,,,function(e,t,n){e.exports={container:"BEXqQ",origin_deleted:"UCTte",footer_button:"hR+sU",footer_item:"SxBF6",main:"zxXV2",origin:"QKUrs",origin_content:"lh4Mu",footer:"+HBcE",footer_buttons:"ZWXlg",footer_item_icon:"ifqGH",footer_item_text:"j37qB"}},function(e,t,n){e.exports={preview_header_name:"vDjhQ",preview_wrapper:"wJp8r",img_small:"_6dZ2E",img_medium:"mRdYU",link:"_7vlfO",container:"z7TNN",container_previewLoaded:"c1tlT",preview:"_41DIX",preview_header:"gHV8M",preview_middle:"WdYAR",preview_middle_onlineStatus:"RZcAk",preview_middle_subscribers:"uPgs7",preview_middle_description:"_8y03l",preview_middle_location:"_0dEXY",preview_footer:"TCTC0",preview_footer_item:"Wx83m",preview_footer_item_title:"PEQxP",preview_footer_item_number:"-NM9K",preview_footer_button:"wlS9U"}},,function(e,t,n){e.exports={replyTo_name:"jTFlJ",footer_deleteButton:"sjitO",footer_button:"z0HA3",container:"L1cvI",wrapper:"_4iHKL",wrapper_selected:"nPrqk",replyTo:"jdj+5",footer:"Vyqv2",footer_button_icon:"DSdtw",footer_button_text:"_7IjJ-",replies:"jmMZn","post__comments-form-container":"DRfSb"}},function(e,t,n){e.exports={container:"uCHlz",form:"O212y","error-text":"_5FuhD",header:"rhLRL",input:"oo9+g",input_disabled:"Iz05B",mobileSubmit:"ARDcB",mobileSubmit_loading:"TpmXI",mobileSubmit_loading_animation:"dkFjB",footer:"CMW+h",footer_inputs:"EoDgB",photo_button:"MRCdD","photo_button--disabled":"Eoyry",photo_button_disabled:"mH4yR",button:"i1C1b",uploadPreviews:"VvNoV",uploadPreviews_wrapper:"ugoJ0"}},function(e,t,n){e.exports={container:"sWim0",link:"MYsjU",link_icon:"jcnmp",link_text:"G4H01"}},function(e,t,n){e.exports={header_imgContainer:"EQBrk",container:"PjBTb",header:"R150P",header_remove:"ANnNR",header_img:"AZf+g",header_overlay:"Czumg",header_overlay_loading:"LQM-h",header_overlay_text:"QXEQl",footer:"_63swE",footer_wrapper:"A3K8M",footer_item:"a3rRN",title:"KiM8e",checkbox:"vLjh9",checkbox_input:"_9hq0R",checkbox_text:"Eh2H4"}},,function(e,t,n){e.exports={textContainer:"xBzLo",text_showMore:"YZ3YB",text:"ZVDcO",imgContainer:"_2y-D1",container:"_4X+Cr",item:"_5w1wS",text_link:"Hw8fQ",img:"zm5e0",deletedPhoto:"-TnkJ"}},function(e,t,n){e.exports={footer:"QMvjN",header:"kKOH3",footer_wrapper:"nZ+ft",header_overlay:"CSNBd",header_wrapper:"UQqwD",wrapper:"iJuIY",header_interlocutor:"eW0uD",container:"Yavw+",header_overlay_qty:"_89Unv",header_overlay_qty_icon:"OPAvI",header_overlay_buttons:"C5QNb",header_overlay_button:"z4Ebl",content:"BJIdP"}},,,function(e,t,n){e.exports={title:"pzUmb",item:"++eB6",header:"t7k97",item_header:"axgjN",item_title:"xEVtS",container:"aZ4aU",button:"HNrLM"}},,,,function(e,t,n){e.exports={content:"mLGVb",section:"ZFoiI",contentWidth:"oAvyf",wrapper:"XjH0U",info:"P2wJE",info_title:"-cWno",info_text:"_8cSh7",content_forgot:"pcODT",content_hr:"ga2Xt",content_signup:"gdNWK"}},,,,function(e,t,n){e.exports={button:"_6Ky74",text:"_9dwZx",form_button_primary:"DDnzc",form_button:"hWyI3",icon:"mPaU2",form_buttons:"PDooh"}},function(e,t,n){e.exports={input:"sqNFt",container:"MtmJg",label:"_28gJW",input_password:"NU7-G",password:"tHavk",password_show:"VVqKx"}},,,function(e,t,n){e.exports={container:"fphCP",title:"ikcUq",items:"esQKW",item:"sITBk",input:"JOmFa",text:"qDihD"}},function(e,t,n){e.exports={container:"Dfs75",container_open:"jelgF",wrapper:"_4+LHt",wrapper_open:"bYDRd",link:"He94R",link_icon:"nZXNA"}},function(e,t,n){e.exports={innerWrapper:"_3FqdH",pageWidth:"oLzQT",wrapper:"SiTpB",wrapper_open:"F7MRC",icon:"v6BQ9",text:"_2D0S0"}},function(e,t,n){e.exports={item:"n9ZN-",noMessages:"xgY57",lastMessage_content:"_1u+g8",lastMessage_avatar:"RfIJ-",lastMessage:"rN97X",lastMessage_unread:"V7cny"}},function(e,t,n){e.exports={wrapper:"SVXBO",noResults:"qRAgh",header:"DRZJ9",title:"kHviP",container:"ff3YK",searchBar:"_9K1tT"}},,,function(e,t,n){e.exports={button_hidden:"+HKve",button:"x8+CY",pageWidth:"_3nHVV",container:"MYCOf"}},function(e,t,n){e.exports={header:"JzPlV",container:"_4R-L7",header_unavailable:"Meg+K",header_title:"R9Gjw",header_unavailable_remove:"tbvCX"}},,function(e,t,n){e.exports={button_remove:"yn5Xi",button_secondary:"FLpc+",button_primary:"t3eTK",button:"sRE36",button_loading:"YsMh7",loading:"MWdn7"}},function(e,t,n){e.exports={wrapper:"_0GKre",link:"b7eCA",link_icon:"vNGKn",container:"MAjnn"}},function(e,t,n){e.exports={innerContainer:"mjZ2U",container:"qhjDH",title:"wIquY",wrapper:"_5eT7H"}},function(e,t,n){e.exports={container:"uzJLC",wrapper:"jOVaD",header:"CtSGq",bottom:"TlsjE"}},function(e,t,n){e.exports={wrapper:"fHtFX",number:"EJ1yj",title:"rDxLb",text:"JYSd2"}},function(e,t,n){e.exports={container:"V3l+s",container_selected:"_3xuCH",wrapper:"F5o0h",status:"W6f91"}},function(e,t,n){e.exports={main:"_2WXj-",pageWidth:"KKVsj",loading:"lAhJy"}},function(e,t,n){e.exports={name:"luLW1",container:"ES1Ja",text:"_6c+mO"}},function(e,t,n){e.exports={button:"oQ-n5",img:"_7cS62"}},function(e,t,n){e.exports={item_description:"g5k8p",item:"S5UKu",container:"Qgp1+"}},function(e,t,n){e.exports={container:"_9PJsH",wrapper:"NJT15",icon:"_4ZDTM"}},function(e,t,n){e.exports={input:"ruc5G",form:"_6zzhg",button:"gaWHp"}},function(e,t,n){e.exports={wrapper:"tXikJ",button:"_4aema",button_active:"poKyI"}},function(e,t,n){e.exports={item:"HcyhW",button:"DUGJ-"}},function(e,t,n){e.exports={header:"Sb2Ng",container:"RDrTt",title:"_6DROY"}},,,,,,function(e,t,n){e.exports={noContent:"RQKOt",container:"eTos4"}},,,,,,,,function(e,t,n){e.exports={container:"mM9nZ"}},function(e,t,n){e.exports={form:"Wpd+3"}},function(e,t,n){e.exports={container:"tn98w"}},function(e,t,n){e.exports={container:"V4UwF"}},,function(e,t,n){e.exports={section:"ZdyRK"}},function(e,t,n){e.exports={container:"bBdGr"}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){},function(e,t,n){"use strict";n.r(t);var s=n(2),o=n(34),a=n(0),i=n(6),c=n(8),r=n(16),l=(n(101),n(57)),d=n.n(l),u=n(5),m=n(58),b=n.n(m),j=n(1);function h(e){let{className:t,community:n,nameIsLink:s=!0,onClick:o,onlyName:a,text:i,textLink:r,userInfo:l}=e;const d=s?c.b:"h4",m=r?c.b:"p";return Object(j.jsxs)("div",{className:Object(u.a)(b.a.container,t),children:[Object(j.jsx)(d,{className:Object(u.a)(b.a.name,t&&t+"_name"),to:s?`/${n?"community":"id"}${l.id}`:null,onClick:o,children:l.title||l.name+(a?"":` ${l.lastName}`)}),i&&Object(j.jsx)(m,{className:Object(u.a)(b.a.text,t&&t+"_text"),to:r,children:i})]})}var f=n(35),v=n(30),p=n(13);function O(e,t){let n=0;[...e].forEach((e=>n+=e.charCodeAt(0)));const s=s=>(n+e.length+parseInt(t.toString(),36)%(s+1)**2)%26+(2===s?0:10),o=e=>e.toString(36),a=s(1),i=s(2),c=s(3),r=s(4);let l="";return[...e].forEach(((e,t)=>{l+=String.fromCharCode(e.charCodeAt(0)+a+i+c+r-Math.min(t%60,t%65,t%70))})),l=btoa(l),l[0]+o(a)+o(i)+o(c)+l.slice(1,-2)+o(r)+l.slice(-2)}function x(e){const t=parseInt(e[1],36),n=parseInt(e[2],36),s=parseInt(e[3],36),o=parseInt(e[e.length-3],36),a=e[0]+e.slice(4,-3)+e.slice(-2);let i="";return[...atob(a)].forEach(((e,a)=>{i+=String.fromCharCode(e.charCodeAt(0)-t-n-s-o+Math.min(a%60,a%65,a%70))})),i}var g=n(77),_=n(46);Object(g.a)({apiKey:x("mpipaDQtqfMlLqnhbeCgLaZk5aos7aSibO5j3WYf3Nzr4x/gJiHpXkh/"),authDomain:"social-app-bs.firebaseapp.com",databaseURL:x("slelLu6tbd9cXCzrqGmnadnmqinY5enYJaWlpCjmaBYnJ2MiVSKmZWRkYVMlYKPj0tHfoCIenZ0hXZ0cIJuqqi5qnKpt7gY="),projectId:"social-app-bs",storageBucket:"social-app-bs.appspot.com",messagingSenderId:"129896299882",appId:"1:129896299882:web:7bf515fc32dcf9a735f913"});const y=Object(p.b)(),N=Object(_.c)(),w=Object(p.n)(),k={delete:e=>Object(_.a)(Object(_.d)(N,e)),getDownloadURL:e=>Object(_.b)(e),upload:(e,t,n)=>Object(_.e)(Object(_.d)(N,e),t,n)};var I=n(78),C=n(4);let S;function $(){const e=window.innerWidth-document.body.offsetWidth+"px";S=document.querySelectorAll(".fixed-item"),document.body.style.overflow="hidden",document.body.style.marginRight=e,S.forEach((t=>t.style.paddingRight=e))}function E(){var e;document.body.style.overflow="",document.body.style.marginRight="",null===(e=S)||void 0===e||e.forEach((e=>e.style.paddingRight=""))}const T=Object(v.b)({initialState:{activeModals:[],currentModal:null,gallery:null},name:"modal",reducers:{closeAllModals(e){E(),e.activeModals=[],e.currentModal=null},closeModal(e,t){let{payload:n}=t;e.activeModals.includes(n)&&(e.activeModals.splice(e.activeModals.indexOf(n)),e.currentModal=e.activeModals[e.activeModals.length-1])},openModal(e,t){var n;let{payload:s}=t;$(),e.activeModals.push(s.name),e.currentModal=s.name,e.actionConfirm=s.opts.actionConfirm,e.actionError=s.opts.actionError,e.changeAvatarCommunityId=s.opts.changeAvatarCommunityId,s.opts.gallery&&(e.gallery=s.opts.gallery),(null===(n=s.opts.zoom)||void 0===n?void 0:n.img)&&(e.zoom={img:s.opts.zoom.img,alt:s.opts.zoom.alt||""})}}}),{closeAllModals:L,closeModal:P,openModal:R}=T.actions,M=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return R({name:e,opts:t})};var D=T.reducer;const q=Object(v.b)({initialState:null,name:"toast",reducers:{closeToast:()=>null,openToast:(e,t)=>{let{payload:n}=t;return{icon:n.icon,msg:n.msg}}}}),{closeToast:A,openToast:B}=q.actions,F=(e,t)=>B({icon:t,msg:e});var z=q.reducer;function H(e,t){const n=new Date(e),s=Date.now()+Ne.getState().timeOffset,o=new Date(s),a=(s-e)/1e3,i=a/60,c=i/60,r=n;return a<1?"just now":i<1?`${Q("second",Math.floor(a))} ago`:c<1?`${Q("minute",Math.floor(i))} ago`:c<3&&o.getDate()===n.getDate()?`${Q("hour",Math.floor(c))} ago`:c<24&&o.getDate()===n.getDate()?t?"today":`today at ${r.getHours()}:${r.getMinutes()<10?0:""}${r.getMinutes()}`:c<48&&new Date(s-864e5).getDate()===n.getDate()?t?"yesterday":`yesterday at ${r.getHours()}:${r.getMinutes()<10?0:""}${r.getMinutes()}`:o.getFullYear()===n.getFullYear()?t?`${r.toLocaleString("en-US",{month:"long"})} ${r.getDate()}`:`${r.toLocaleString("en-US",{month:"long"})} ${r.getDate()} at ${r.getHours()}:${r.getMinutes()<10?0:""}${r.getMinutes()}`:t?`${r.toLocaleString("en-US",{month:"long"})} ${r.getDate()}, ${r.getFullYear()}`:`${r.toLocaleString("en-US",{month:"long"})} ${r.getDate()}, ${r.getFullYear()} at ${r.getHours()}:${r.getMinutes()<10?0:""}${r.getMinutes()}`}const U=e=>{let{reqUserId:t,userId:n}=e;const s=`users/user${t}/`,o=`users/user${n}/`;ie().update({[`${s}friendRequests/sent/user${n}`]:null,[`${s}friends/user${n}`]:{friendAddDate:w,userId:n},[`${o}friendRequests/received/user${t}`]:null,[`${o}friends/user${t}`]:{friendAddDate:w,userId:t},[o+"fullInfo/followerCount"]:Object(p.e)(-1),[o+"notifications/friendRequest"+t]:null}).then((()=>Ne.dispatch(F("Friend request accepted.",C.Q))))},Y=e=>{ie("posts").orderByChild("authorId").equalTo(e).once((t=>{const n=`users/user${e}/`,s=n+"fullInfo/",o={[s+"birthday"]:null,[s+"city"]:null,[s+"country"]:null,[s+"status"]:null,[n+"account"]:{deleted:!0,id:e},[n+"bookmarks"]:null,[n+"connections"]:null,[n+"info"]:{avatar:"img/user-deleted.svg",deleted:!0,gender:null,id:e,lastName:"account",lastSeen:null,name:"Deleted"},[n+"profilePhotos"]:null};Object.values({...t}).forEach((e=>o["posts/post"+e.id]=null)),ie().update(o)}))},V=(e,t,n)=>{Ne.dispatch(M("action-confirm",{actionConfirm:{callback:()=>{ie("posts").orderByChild("communityId").equalTo(e).once((s=>{const o=`communities/community${e}/`,a={[o+"fullInfo"]:null,[o+"info"]:{avatar:"img/community-deleted.svg",deleted:!0,id:e,subscriberCount:n||null,title:"Deleted community"},[o+"profilePhotos"]:null};Object.values({...s}).forEach((e=>a["posts/post"+e.id]=null)),ie().update(a).then((()=>Ne.dispatch(F("Community deleted.",C.F)))),t&&k.delete(t)}))},irreversible:!0,password:!0,text:"Are you sure you want to delete this community?"}}))};function W(e){for(const t in e)e[t]=e[t].trim();return e}const K=e=>e.info.deleted?"This user account has been removed":e.connections?"Online":"Last seen "+H(e.info.lastSeen),Z=e=>{let{condition:t,contentId:n,contentPath:s,redirect:o,userId:a,userPath:i}=e;if(!a)return void o();const c=s+"/likeCounter",r=`${s}/likes/user${a}`,l=`users/user${a}/likes/${i}`;t?ie().update({[c]:Object(p.e)(-1),[r]:null,[l]:null}):ie().update({[c]:Object(p.e)(1),[r]:{date:w,userId:a},[l]:{date:w,id:n}})},J=e=>{throw Ne.dispatch(F("Permission denied.",C.r)),e},Q=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"s";return`${t} ${e}${1!==t?n:""}`},X=(e,t)=>{ie(`users/user${e}/info/avatar`).set(t).then((()=>Ne.dispatch(F("Avatar updated.",C.G))))},G=e=>{document.cookie=`USER_DATA=${JSON.stringify(e)||""}; expires=${e?new Date(Date.now()+31536e6):new Date}`},ee=(e,t,n,s)=>{if(!n)return void t();const o="communities/community"+e,a=`${o}/subscribers/user${n}`,i=o+"/info/subscriberCount",c=`users/user${n}/communities/subscribed/community${e}`;s?ie().update({[i]:Object(p.e)(-1),[a]:null,[c]:null}):ie().update({[i]:Object(p.e)(1),[a]:n,[c]:{date:w,id:e}})},te=e=>e?localStorage.setItem("darkTheme","true"):localStorage.removeItem("darkTheme"),ne=()=>localStorage.getItem("darkTheme"),se=()=>{const e=localStorage.getItem("darkTheme"),t=document.querySelector("meta[name=theme-color]");document.documentElement.classList[e?"add":"remove"]("dark"),t&&(t.content=e?"#1773a8":"#22aeff")},oe=async e=>{let{addToPhotos:t,callback:n,communityId:s,createId:o=!0,file:a,imgParent:i,imgPath:c="photos",index:r,setLoadingPercentage:l,storagePrefix:d="",userId:u}=e;const m=o?ie().newKey():c,b=await Object(I.a)(a,{initialQuality:.7,maxWidthOrHeight:3840}),j=b.name.split(".").slice(-1),h=`img/${d?`${d}_`:""}${m}.${j}`,f=k.upload(h,b,{cacheControl:"public, max-age=36000"});f.on("state_changed",(e=>{const t=Math.floor(e.bytesTransferred/e.totalBytes*100);null===l||void 0===l||l(t,r)}),(()=>Ne.dispatch(M("action-error",{actionError:"Failed to load image to our database. Try again."}))),(()=>k.getDownloadURL(f.snapshot.ref).then((e=>new Promise((()=>{const a=s?`communities/community${s}`:`users/user${u}`,l={[`${a}/${i?`${i}/`:""}${c}${o?`/${m}`:""}`]:{date:w,id:o?m:null,src:e},...t&&{[`${a}/profilePhotos/${m}`]:{id:m}}};ie().update(l),null===n||void 0===n||n({id:m,index:r||0,link:e})}))))))},ae=e=>Object(p.l)(y,e);function ie(e){const t=(e,t,n)=>Object(p.g)(e,(e=>t(e.val())),{onlyOnce:n}),n=e=>({equalTo:n=>({on:s=>t(Object(p.k)(e,Object(p.a)(n)),s),once:s=>t(Object(p.k)(e,Object(p.a)(n)),s,!0)})});return{newKey:()=>Object(p.j)(ae()).key,on:n=>t(ae(e),n),once:n=>t(ae(e),n,!0),onDisconnect:()=>Object(p.f)(ae(e)),orderByChild:t=>n(Object(p.k)(ae(e),Object(p.h)(t))),orderByValue:()=>n(Object(p.k)(ae(e),Object(p.i)())),push:()=>Object(p.j)(ae(e)),reconnect(){Object(p.c)(y),Object(p.d)(y)},remove:()=>Object(p.m)(ae(e)).catch(J),set:t=>Object(p.o)(ae(e),t).catch(J),update:t=>Object(p.p)(ae(e),t).catch(J)}}function ce(){const e=x("0tmtNva1dedkZDHxM3Jy767zcHGxIK4tYC0v7x9t7+6uHiuqXl7d3l5cW2kcG+daGtqnZljlmhpZl5laJRkmJ2YnZWYnZo0=");return new Promise((t=>fetch(e).then((e=>e.json())).then((e=>t({city:e.city,country:e.country_name,ip:e.IPv4})))))}function re(e){ce().then((t=>{const n=`ipAddresses/${e}/${t.ip.split(".").join("\u2024")}/`;ie().update({[n+"city"]:t.city,[n+"country"]:t.country,[`${n}visits/${ie().newKey()}`]:w})}))}function le(e){let{callback:t,community:n,fields:s=["info"],userId:o}=e;const a={},i=[],c=s.map((e=>{const t=e.split("/");return t[t.length-1]}));return s.forEach(((e,s)=>{i.push(ie(`${n?"communities/community":"users/user"}${o}/${e}`).on((e=>{a[c[s]]=e,c.map((e=>a[e])).includes(void 0)||t(a.info?{...a}:null)})))})),()=>i.forEach((e=>e()))}const de=Object(v.b)({initialState:!1,name:"hamburger",reducers:{closeHamburger:()=>!1,openHamburger:()=>($(),!0)}});var ue=de.reducer;const{closeHamburger:me,openHamburger:be}=de.actions,je=Object(v.b)({initialState:0,name:"timeOffset",reducers:{setTimeOffset:(e,t)=>{let{payload:n}=t;return n}}});var he=je.reducer;const{setTimeOffset:fe}=je.actions,ve=Object(v.b)({initialState:{account:{id:null}},name:"user",reducers:{logIn(e,t){let{payload:n}=t;return G({id:n.account.id,password:x(n.account.password)}),localStorage.setItem("loggedIn","true"),n},logOut:()=>(G(),localStorage.removeItem("loggedIn"),null),logSync(e,t){let{payload:n}=t;return"true"!==localStorage.getItem("loggedIn")?(G(),null):n}}});var pe=ve.reducer;const{logIn:Oe,logOut:xe,logSync:ge}=ve.actions,_e=Object(f.b)({hamburger:ue,modal:D,timeOffset:he,toast:z,user:pe}),ye=Object(v.a)({devTools:!1,middleware:Object(v.c)({serializableCheck:!1}),reducer:_e});var Ne=ye;const we=i.c;ie(".info/serverTimeOffset").on((e=>ye.dispatch(fe(e))));let ke=Date.now();setInterval((()=>{Math.abs(Date.now()-ke)>6e3&&ie().reconnect(),ke=Date.now()}),5e3);var Ie=n(18),Ce=n.n(Ie);function Se(e){var t,n,o,a,i;let{community:r,enablePreview:l=!0,onClick:d,size:m="medium",src:b,userId:h}=e;const f=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),v=Object(s.useRef)(),p=Object(s.useRef)(),[O,x]=Object(s.useState)(null);function g(){_(),v.current=setTimeout((()=>{p.current=le({callback:x,community:r,fields:r?["fullInfo","info"]:["connections","friends","fullInfo","info","profilePhotos"],userId:h})}),100)}function _(){var e;clearTimeout(v.current),null===(e=p.current)||void 0===e||e.call(p)}Object(s.useEffect)((()=>_),[]);const y=e=>{let{link:t,qty:n,renderZero:s,text:o}=e;const a=t?c.b:"div";if(s||n)return Object(j.jsxs)(a,{className:Object(u.a)(Ce.a.preview_footer_item,t&&Ce.a.preview_footer_button),to:t,onClick:d,children:[Object(j.jsx)("p",{className:Ce.a.preview_footer_item_number,children:n}),Object(j.jsx)("p",{className:Ce.a.preview_footer_item_title,children:o})]})};return Object(j.jsxs)("div",{className:Object(u.a)(Ce.a.container,O&&Ce.a.container_previewLoaded,"avatar"),onMouseEnter:l?g:void 0,onMouseLeave:l?_:void 0,onTouchEnd:l?_:void 0,onTouchStart:l?g:void 0,children:[Object(j.jsx)(c.b,{className:Ce.a.link,to:`/${r?"community":"id"}${h}`,onClick:d,onMouseDown:l?_:void 0,children:Object(j.jsx)("img",{className:Object(u.a)(Ce.a["img_"+m],"avatar__img","avatar__img-"+m),src:b,alt:"Avatar"})}),Object(j.jsx)("div",{className:Object(u.a)(Ce.a.preview,"avatar__preview"),children:l&&O&&Object(j.jsxs)("div",{className:Object(u.a)(Ce.a.preview_wrapper,"avatar__preview-wrapper"),children:[Object(j.jsx)("div",{className:Ce.a.preview_header,children:Object(j.jsx)(c.b,{className:Ce.a.preview_header_name,to:`/${r?"community":"id"}${h}`,children:O.info.title||`${O.info.name} ${O.info.lastName}`})}),Object(j.jsxs)("div",{className:Ce.a.preview_middle,children:[r?Object(j.jsx)("p",{className:Ce.a.preview_middle_subscribers,children:Q("subscriber",O.info.subscriberCount||0)}):Object(j.jsx)("p",{className:Ce.a.preview_middle_onlineStatus,children:K(O)}),Object(j.jsx)("p",{className:Ce.a.preview_middle_description,children:r?null===(t=O.fullInfo)||void 0===t?void 0:t.description:null===(n=O.fullInfo)||void 0===n?void 0:n.status}),Object(j.jsx)("p",{className:Ce.a.preview_middle_location,children:((null===(o=O.fullInfo)||void 0===o?void 0:o.city)?`${O.fullInfo.city}, `:"")+((null===(a=O.fullInfo)||void 0===a?void 0:a.country)?O.fullInfo.country:"")})]}),Object(j.jsxs)("div",{className:Ce.a.preview_footer,children:[y({link:`/friends${h!==f?h:""}`,qty:Object.keys({...O.friends}).length,text:"friends"}),y({qty:null===(i=O.fullInfo)||void 0===i?void 0:i.followerCount,text:"followers"}),y({link:`/photos${h!==f?h:""}`,qty:Object.keys({...O.profilePhotos}).length,text:"photos"})]})]})})]})}var $e=n(59),Ee=n.n($e);function Te(e){let{avatar:t,className:n,userInfo:s}=e;const o=Object(i.b)();return s.avatar.endsWith(".svg")?Object(j.jsx)("div",{className:n||"",children:Object(j.jsx)("img",{className:Ee.a.img,src:s.avatar,alt:"Avatar"})}):Object(j.jsx)(c.b,{className:Object(u.a)(Ee.a.button,n),to:"#javascript",onClick:e=>{o(M("gallery",{gallery:{authorInfo:s,content:[t],initialSlide:0}})),e.preventDefault()},children:Object(j.jsx)("img",{className:Ee.a.img,src:s.avatar,alt:"Avatar"})})}var Le=n(51),Pe=n.n(Le);function Re(e){let{afterIcon:t,ariaLabel:n,background:s,beforeIcon:o,children:a,className:i,href:r,iconStyles:l,loading:d,preset:m="primary",onClick:b,testId:h,to:f,type:v="button"}=e;const p=r?"a":f?c.b:"button",O=e=>e&&Object(j.jsx)(e,{className:Object(u.a)("button__icon",s&&m+"-button__icon",i&&i+"__icon"),size:null===l||void 0===l?void 0:l.size,style:{height:null===l||void 0===l?void 0:l.height,width:null===l||void 0===l?void 0:l.width}});return Object(j.jsxs)(p,{"aria-label":n,className:Object(u.a)("button",Pe.a.button,s&&Pe.a["button_"+m],d&&Pe.a.button_loading,s&&m+"-button",i),href:r,onClick:b,to:f,type:"button"===p?v:null,children:[d&&Object(j.jsx)(Pt,{className:Pe.a.loading}),O(o),a&&Object(j.jsx)("p",{className:Object(u.a)("button__text",s&&m+"-button__text",i&&i+"__text"),children:a}),O(t)]})}var Me=n(15);function De(){const e=Object(s.useContext)(r.LoadingContext),t=Object(s.useRef)({incrementQty(e,t){this.qty.includes(e)||(this.qty.push(e),this.qty.length===this.expectedQty&&t())},setExpected(e,t){this.expectedQty||(this.expectedQty=e,0===this.expectedQty&&(null===t||void 0===t||t()))},qty:[]}),n=Object(s.useRef)(!1),o=Object(s.useCallback)((e=>document.title=e+" | Social App"),[]);return{fetchedItems:t,finishLoading:Object(s.useCallback)((t=>{n.current=!0,e.done(),t&&o(t),window.scrollTo(0,0),setTimeout((()=>window.dispatchEvent(new Event("loadFinished"))),0)}),[e,o]),loaded:n,setTitle:o}}function qe(){const e=Object(s.useRef)(!1),[t,n]=Object(s.useState)(!1),o=Object(s.useCallback)((function(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e.current=t,n(t)}),[]);return{AsyncButton:Object(s.useCallback)((e=>Object(j.jsx)(Re,{...e,background:!0,loading:t})),[t]),buttonLoading:t,buttonLoadingRef:e,setButtonLoading:o}}function Ae(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const[t,n]=Object(s.useState)([]),o=s=>{const o=[...s.target.files];e||(o.length=1);let a=o.length;s.target.value="";const i=[];o.forEach((e=>{let s,o;["jpg","jpeg","png"].includes(e.name.split(".").pop().toLowerCase())||(o=!0,a--);const c={lastModified:e.lastModified,name:e.name,size:e.size,type:e.type};for(const n of t)if(JSON.stringify(n.props)===JSON.stringify(c)){s=!0,a--;break}if(!s||!o){const s=new FileReader;s.onload=()=>{i.push({props:c,file:e,result:s.result}),i.length===a&&n([...t,...i])},s.readAsDataURL(e)}}))};return{addImgPreview:o,imgPreview:t,setImgPreview:n}}function Be(){const{push:e}=Object(Me.useHistory)(),{hash:t,pathname:n,search:o}=Object(Me.useLocation)();return Object(s.useCallback)((()=>e("/?from="+encodeURIComponent(n+o+t))),[t,n,e,o])}r.topbar.config({barColors:{0:"rgba(128, 215, 255, 1)"},className:"loading-bar",shadowBlur:5,shadowColor:"rgba(0, 0, 0, 1)"});var Fe=n(60),ze=n.n(Fe);function He(e){let{communitiesInfo:t,renderSubscribeButton:n=!0}=e;const s=Be(),o=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.admin})),a=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),i=we((e=>{var t,n;return null===(t=e.user)||void 0===t||null===(n=t.communities)||void 0===n?void 0:n.subscribed}));return Object(j.jsx)("div",{className:Object(u.a)(ze.a.container,"communitiesList"),children:t.map((e=>Object(j.jsx)("div",{className:ze.a.item,children:Object(j.jsx)(vn,{bottomText:Q("subscriber",e.subscriberCount||0),childrenBottom:Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("p",{className:ze.a.item_description,children:e.deleted?"This community has been deleted.":e.shortDescription||"No description provided."}),n&&Object(j.jsx)(Re,{background:!0,onClick:()=>ee(e.id,s,a,!!(null===i||void 0===i?void 0:i["community"+e.id])),preset:(null===i||void 0===i?void 0:i["community"+e.id])?"remove":"primary",testId:`community-${(null===i||void 0===i?void 0:i["community"+e.id])?"un":""}subscribe-btn`,children:(null===i||void 0===i?void 0:i["community"+e.id])?"Unsubscribe":"Subscribe"})]}),className:"user",community:!!e.id,userInfo:e,children:Object(j.jsx)(Et,{bookmarkType:"community",itemId:e.id,children:!e.deleted&&o&&Object(j.jsx)(Re,{background:!0,onClick:()=>{var t;ie(`communities/community${(t=e).id}/fullInfo/banner/src`).once((e=>{V(t.id,e,t.subscriberCount)}))},children:"Delete community"})})})},e.id)))})}var Ue=n(79),Ye=n.n(Ue);function Ve(e){let{children:t,className:n}=e;return Object(j.jsx)("div",{className:Object(u.a)(Ye.a.container,n),children:t})}var We=n(24);var Ke=[{id:"name",name:"name",title:"Name",errors:{maxLength:{value:32,message:"A name cannot contain more than 32 characters"},required:"Enter your name"}},{id:"lastName",name:"lastName",title:"Last name",errors:{maxLength:{value:32,message:"A last name cannot contain more than 32 characters"},required:"Enter your last name"}},{id:"birthday",getMax:()=>({message:"A birthday cannot be a date in the future",value:new Date(Date.now()+Ne.getState().timeOffset).toISOString().split("T")[0]}),min:"1900-01-01",name:"birthday",title:"Birthday",type:"date",errors:{min:{value:"1900-01-01",message:"A birthday cannot contain a year less than 1900"}}},{id:"country",name:"country",title:"Country",errors:{maxLength:{value:56,message:"A country cannot contain more than 56 characters"}}},{id:"city",name:"city",title:"City",errors:{maxLength:{value:85,message:"A city cannot contain more than 85 characters"}}},{autoComplete:"off",id:"status",name:"status",title:"Status",errors:{maxLength:{value:80,message:"A status cannot contain more than 80 characters"}}},{id:"email",name:"email",title:"Email",type:"email",errors:{maxLength:{value:320,message:"An email cannot contain more than 320 characters"},pattern:{value:/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/,message:"Enter a correct email address!"},required:"Enter an email address"}},{autoComplete:"new-password",id:"password",name:"password",type:"password",title:"Password",errors:{maxLength:{value:128,message:"A password cannot contain more than 128 characters"},minLength:{value:2,message:"A password must be at least 2 characters long"},pattern:{value:/^[a-zA-Z0-9!"#$%&'()*+,-./:;<=>?@[\\\]^_`{|}~-]*$/,message:"A password can only contain letters (a-z, A-Z), numbers, and symbols !\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~, and cannot contain spaces"},required:"Enter a password"}},{id:"existingPassword",name:"password",type:"password",title:"Password",errors:{maxLength:{value:128,message:"A password cannot contain more than 128 characters"},required:"Enter your password"}},{autoComplete:"new-password",id:"confirmPassword",name:"password",type:"password",title:"Confirm password",errors:{maxLength:{value:128,message:"A password cannot contain more than 128 characters"},required:"Confirm your password"}},{id:"title",name:"title",title:"Title",errors:{maxLength:{value:32,message:"A title cannot contain more than 32 characters"},required:"Enter community title"}},{id:"description",name:"text",title:"Description",errors:{maxLength:{value:256,message:"A description cannot contain more than 256 characters"}}},{id:"shortDescription",name:"text",title:"Short description",errors:{maxLength:{value:100,message:"A short description cannot contain more than 100 characters"}}}],Ze=n(37),Je=n.n(Ze);function Qe(e){let{classes:t,className:n,databaseRef:o,disabled:a,emptyButtonText:c,emptyFieldText:r,field:l,ownerId:d,renderInputId:m}=e;const b=Object(i.b)(),{formState:{errors:h},handleSubmit:f,register:v,reset:p}=Object(We.a)(),O=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),[x,g]=Object(s.useState)(!1);return Object(j.jsx)("div",{className:n||"",children:d!==O||a?Object(j.jsx)("p",{className:Object(u.a)(Je.a.text,null===t||void 0===t?void 0:t.text),children:l||r}):x?Object(j.jsxs)("form",{className:Object(u.a)(Je.a.form,null===t||void 0===t?void 0:t.form),onSubmit:f((e=>{ie(o).set(e[m].trim()||null).then((()=>b(F("Field updated.",C.l)))),g(!1)})),children:[Object(j.jsx)(Ct,{autoFocus:!0,opts:{obj:Ke.find((e=>e.id===m)),defaultValue:l,errors:h,placeholder:!0,register:v}}),Object(j.jsxs)("div",{className:Je.a.form_buttons,children:[Object(j.jsx)(Re,{background:!0,className:Je.a.form_button_primary,type:"submit",children:"Save"}),Object(j.jsx)(Re,{background:!0,className:Je.a.form_button,preset:"secondary",onClick:()=>g(!1),children:"Cancel"})]})]}):Object(j.jsxs)("button",{className:Object(u.a)(Je.a.button,null===t||void 0===t?void 0:t.button),onClick:()=>{g(!0),p()},children:[Object(j.jsx)("div",{className:Je.a.icon,children:Object(j.jsx)(C.l,{size:"1.15em"})}),Object(j.jsx)("p",{className:(null===t||void 0===t?void 0:t.text)||"",children:l||c})]})})}var Xe=n(80),Ge=n.n(Xe);function et(e){let{className:t,...n}=e;return Object(j.jsx)("form",{...n,className:Object(u.a)(Ge.a.form,t)})}var tt=n(41),nt=n.n(tt);function st(e){let{defaultValue:t,register:n}=e;return Object(j.jsxs)("div",{className:nt.a.container,children:[Object(j.jsx)("h4",{className:nt.a.title,children:"Gender"}),Object(j.jsx)("div",{className:nt.a.items,children:["Male","Female"].map((e=>Object(j.jsxs)("label",{className:nt.a.item,children:[Object(j.jsx)("input",{className:nt.a.input,defaultChecked:e.toLowerCase()===(t||"male"),type:"radio",value:e.toLowerCase(),...n("gender")}),Object(j.jsx)("p",{className:nt.a.text,children:e})]},e)))})]})}var ot=n(42),at=n.n(ot);function it(){const e=Object(i.b)(),t=we((e=>e.hamburger)),n=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),o=Object(s.useRef)(null),[a,r]=Object(s.useState)(!0),l=Object(s.useCallback)((()=>{r(!1),e(me())}),[e]);const d=Object(s.useCallback)((e=>{"Escape"===e.key&&t&&l()}),[l,t]);return Object(s.useEffect)((()=>(window.addEventListener("keydown",d),()=>window.removeEventListener("keydown",d))),[d]),n?Object(j.jsx)("div",{className:Object(u.a)(at.a.container,(!a||t)&&at.a.container_open),onClick:l,children:Object(j.jsx)("div",{className:Object(u.a)(at.a.wrapper,t&&at.a.wrapper_open),onClick:e=>e.stopPropagation(),onTransitionEnd:function(e){t||e.target!==o.current||"transform"!==e.nativeEvent.propertyName||(r(!0),E())},ref:o,children:Object(j.jsx)("nav",{children:[{icon:C.S,text:"Communities",to:"/communities"},{icon:C.b,text:"Bookmarks",to:"/bookmarks"},{icon:C.I,text:"Search",to:"/search"}].map((e=>Object(j.jsxs)(c.b,{className:at.a.link,to:e.to,onClick:l,children:[Object(j.jsx)(e.icon,{className:at.a.link_icon}),Object(j.jsx)("p",{children:e.text})]},e.text)))})})}):null}const ct=Object(s.createContext)(null);function rt(e){let{openState:t,setOpenState:n,submenuClass:o="submenu",Tag:a=s.Fragment,...i}=e;const c=Object(s.useRef)(null),[r,l]=Object(s.useState)(!1);return null!=t&&n||([t,n]=[r,l]),Object(j.jsx)(ct.Provider,{value:{buttonRef:c,openState:t,setOpenState:n,submenuClass:o},children:Object(j.jsx)(a,{...i})})}function lt(e){let{Tag:t,...n}=e;const{buttonRef:o,openState:a,setOpenState:i,submenuClass:c}=Object(s.useContext)(ct);return Object(j.jsx)(t,{...n,className:`${n.className} ${c}__button${a?` ${c}__button--open`:""}`,onClick:()=>i(!a),ref:o})}function dt(e){let{Tag:t="div",...n}=e;const{buttonRef:o,openState:a,setOpenState:i,submenuClass:c}=Object(s.useContext)(ct),r=Object(s.useRef)(),l=Object(s.useCallback)((e=>{!o.current||o.current.contains(e.target)||r.current.contains(e.target)||i(!1)}),[o,i]);return Object(s.useEffect)((()=>(window.addEventListener("click",l),()=>window.removeEventListener("click",l))),[l]),Object(j.jsx)(t,{...n,ref:r,className:`${n.className} ${c}__wrapper${a?` ${c}__wrapper--open`:""}`})}let ut,mt,bt,jt=!1,ht=!1;function ft(){ht||(ht=!0,re("guests"))}var vt=()=>e=>{var t,n;null===(t=mt)||void 0===t||t(),null===(n=bt)||void 0===n||n(),document.cookie.split(";").forEach((t=>{function n(){e(xe()),e(L()),jt=!1}function s(){e(ge(null)),e(L()),jt=!1}try{ut=JSON.parse(t.replace("USER_DATA=",""))}catch(o){return s(),void ft()}if(!ut.id||"true"!==localStorage.getItem("loggedIn"))return s(),void ft();bt=ie(`users/user${ut.id}/account`).orderByValue().equalTo(O(ut.password,ut.id)).on((t=>{var o;null===(o=bt)||void 0===o||o(),t?mt=le({callback:t=>{if(null===t||void 0===t?void 0:t.account){var s;if(t.account.deleted)return void n();e(ge(t)),te(!!(null===(s=t.account.preferences)||void 0===s?void 0:s.darkTheme)),se(),!jt&&e(L()),jt=!0}else n()},fields:["account","bookmarks","communities","conversations","friendRequests","fullInfo","info","notifications","photos","profilePhotos"],userId:ut.id}):s()}))}))},pt=n(81),Ot=n.n(pt);function xt(e){let{children:t,className:n}=e;return Object(j.jsx)("div",{className:Object(u.a)(Ot.a.container,n),children:t})}var gt=n(11),_t=n.n(gt);function yt(){const e=Object(i.b)(),t=Object(Me.useHistory)(),n=we((e=>{var t,n;return null===(t=e.user)||void 0===t||null===(n=t.info)||void 0===n?void 0:n.avatar})),o=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),a=we((e=>{var t,n;return null===(t=e.user)||void 0===t||null===(n=t.info)||void 0===n?void 0:n.name})),r=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.notifications})),[l,d]=Object(s.useState)(!0),[m,b]=Object(s.useState)(!1),[h,f]=Object(s.useState)(""),[v,p]=Object(s.useState)(!1);return Object(s.useEffect)((()=>{let e=window.pageYOffset;function t(){const t=window.innerWidth>768,n=t?50:10,s=window.pageYOffset-e,o=window.pageYOffset>(t?200:40);function a(t){e=window.pageYOffset,document.documentElement.style.setProperty("--header-offset",t?"":"0px"),d(t)}s>n&&o?a(!1):s<-n&&a(!0)}return window.addEventListener("scroll",t),()=>window.removeEventListener("scroll",t)}),[]),Object(s.useEffect)((()=>{ne()&&(document.body.classList.add("disable-transition"),se(),document.body.scrollHeight,document.body.classList.remove("disable-transition"))}),[]),Object(j.jsx)("header",{className:Object(u.a)(_t.a.header,l&&_t.a.header_visible,"fixed-item"),children:Object(j.jsx)(xt,{children:Object(j.jsxs)("div",{className:_t.a.wrapper,children:[Object(j.jsx)(c.b,{className:_t.a.logo,to:o?"/news":"/","aria-label":"Homepage",children:"Social App"}),Object(j.jsxs)("div",{className:_t.a.right,children:[Object(j.jsx)(on,{className:_t.a.searchBar,link:!0,value:h,onChange:e=>f(e.target.value),onSubmit:function(e){e.preventDefault(),t.push(`/search?query=${encodeURIComponent(h)||""}`)}}),void 0===o&&Object(j.jsx)(wt,{}),o&&Object(j.jsxs)(j.Fragment,{children:[Object(j.jsxs)(rt,{className:_t.a.user,openState:v,setOpenState:p,Tag:"div",children:[Object(j.jsxs)(lt,{className:_t.a.user_button,Tag:"button",children:[Object(j.jsx)("p",{className:_t.a.user_button_name,children:a}),Object(j.jsx)("img",{className:"avatar__img-small",src:n,alt:"Avatar"}),Object(j.jsx)(C.e,{})]}),Object(j.jsx)(dt,{className:_t.a.user_submenu,children:Object(j.jsxs)("div",{className:_t.a.user_submenu_wrapper,children:[Object(j.jsx)(wt,{}),Object(j.jsx)(Re,{className:_t.a.user_submenu_button,testId:"settings-btn",to:"/settings",onClick:()=>p(!1),children:"Settings"}),Object(j.jsx)(Re,{className:_t.a.user_submenu_button,testId:"log-out-btn",onClick:function(){p(!1),e(xe()),e(vt()),setTimeout((()=>t[t.location.search.includes("from=")?"replace":"push"]("/")),0)},children:"Log out"})]})})]}),Object(j.jsxs)(rt,{className:_t.a.notifications,openState:m,setOpenState:b,Tag:"div",children:[Object(j.jsx)(lt,{className:_t.a.notifications_button,Tag:"button","aria-label":"Notifications",children:Object(j.jsxs)("div",{className:_t.a.notifications_button_wrapper,children:[Object(j.jsx)(C.u,{}),r&&Object(j.jsx)("p",{className:_t.a.notifications_button_number,children:Object.keys({...r}).length})]})}),Object(j.jsx)(dt,{className:_t.a.notifications_submenu,children:Object(j.jsx)("div",{className:_t.a.notifications_submenu_wrapper,children:r?Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("button",{className:_t.a.notifications_submenu_clear,onClick:function(){ie(`users/user${o}/notifications`).remove().then((()=>e(F("All notifications removed.",C.u))))},children:"Clear all"}),Object.values({...r}).sort(((e,t)=>t.date-e.date)).map((e=>Object(j.jsx)(Nt,{notification:e,setSubmenuState:b},e.date)))]}):Object(j.jsx)("p",{className:_t.a.notifications_submenu_empty,children:"No notifications."})})})]})]})]})]})})})}function Nt(e){let{notification:t,setSubmenuState:n}=e;const o=Object(i.b)(),a=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),[r,l]=Object(s.useState)();return Object(s.useEffect)((()=>le({callback:e=>l(e.info),userId:t.id})),[t.id]),r?Object(j.jsxs)("div",{className:_t.a.notifications_submenu_item,children:[Object(j.jsx)(Se,{size:"small",src:r.avatar,userId:r.id,onClick:()=>n(!1)}),Object(j.jsxs)("p",{className:_t.a.notifications_submenu_item_text,children:["You have a new friend request from ",Object(j.jsx)(c.b,{className:_t.a.notifications_submenu_item_link,to:"/id"+r.id,onClick:()=>n(!1),children:r.name}),"."]}),Object(j.jsx)("button",{className:_t.a.notifications_submenu_item_remove,"aria-label":"Remove notification",onClick:function(e){e.stopPropagation(),ie(`users/user${a}/notifications/${t.type+t.id}`).remove().then((()=>o(F("Notification removed.",C.u))))},children:Object(j.jsx)(C.F,{})})]}):null}function wt(){const e=we((e=>{var t,n,s;return null===(t=e.user)||void 0===t||null===(n=t.account)||void 0===n||null===(s=n.preferences)||void 0===s?void 0:s.darkTheme})),t=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),[n,o]=Object(s.useState)("true"===ne());return Object(s.useEffect)((()=>o(t?!!e:!!ne())),[e,t]),Object(j.jsx)("label",{className:Object(u.a)(_t.a.changeTheme,n&&_t.a.changeTheme_checked),children:Object(j.jsxs)("div",{className:_t.a.changeTheme_wrapper,children:[Object(j.jsx)("input",{checked:n,className:_t.a.changeTheme_input,type:"checkbox","aria-label":"Toggle dark theme",onChange:function(){if(t){const n=ie(`users/user${t}/account/preferences/darkTheme`);e?n.remove():n.set(!0),o(!!e)}else te(!ne()),se(),o(!!ne())}}),Object(j.jsx)("div",{className:_t.a.changeTheme_iconContainer,children:Object(j.jsx)(C.i,{style:{width:"1.1em"}})})]})})}var kt=n(38),It=n.n(kt);function Ct(e){let{opts:{defaultValue:t,errors:n,label:o,labelText:a,obj:i,placeholder:c,register:r},...l}=e;const[d,m]=Object(s.useState)(!1);i.getMax&&(i.errors.max=i.getMax());const b={id:i.id,autoCapitalize:["password","email"].includes(i.name)?"off":"on",autoComplete:i.autoComplete||"on",defaultValue:t||"",placeholder:c?i.title:"",spellCheck:!["password","email"].includes(i.name),...l};return Object(j.jsxs)("div",{className:It.a.container,children:[o&&Object(j.jsx)("label",{className:It.a.label,htmlFor:l.id||i.id,children:a||i.title}),["password","existingPassword"].includes(i.id)?Object(j.jsxs)("div",{className:It.a.password,children:[Object(j.jsx)("input",{className:Object(u.a)(It.a.input_password,It.a.input),type:d?"text":"password",...b,...r("password",i.errors)}),Object(j.jsx)("button",{className:It.a.password_show,type:"button","aria-label":"Toggle password visibility",onClick:()=>m(!d),children:d?Object(j.jsx)(C.z,{size:"1.25em"}):Object(j.jsx)(C.A,{size:"1.25em"})})]}):Object(j.jsx)("input",{className:It.a.input,type:i.type||"text",...b,...r(i.id,{...i.errors,validate:e=>{if(i.errors.required&&!e.trim())return i.errors.required}})}),n[i.id]&&Object(j.jsx)("p",{className:"error-text",children:n[i.id].message})]})}var St=n(61),$t=n.n(St);function Et(e){let{bookmarkType:t,children:n,className:s,itemId:o}=e;const a="community"===t?"communities":t+"s",c=Object(i.b)(),r=Be(),l=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),d=we((e=>{var n,s,i,c;return null===(n=e.user)||void 0===n||null===(s=n.bookmarks)||void 0===s||null===(i=s[a])||void 0===i||null===(c=i[t+o])||void 0===c?void 0:c.id}));return Object(j.jsxs)("div",{className:Object(u.a)($t.a.container,s),children:[Object(j.jsx)("div",{className:$t.a.icon,tabIndex:0,children:Object(j.jsx)(C.e,{style:{width:".9em"}})}),Object(j.jsxs)("div",{className:$t.a.wrapper,children:[Object(j.jsx)(Re,{background:!0,onClick:()=>{if(!l)return void r();const e=ie(`users/user${l}/bookmarks/${a}/${t+o}`);d?e.remove().then((()=>c(F("Item removed from bookmarks.",C.v)))):e.set({date:w,id:o}).then((()=>c(F("Item added to bookmarks.",C.v))))},children:(d?"Remove from":"Add to")+" bookmarks"}),n]})]})}var Tt=n(82),Lt=n.n(Tt);function Pt(e){let{className:t}=e;return Object(j.jsxs)("div",{className:Object(u.a)(Lt.a.container,t),children:[Object(j.jsx)("div",{}),Object(j.jsx)("div",{}),Object(j.jsx)("div",{}),Object(j.jsx)("div",{})]})}var Rt=n(22),Mt=n.n(Rt);function Dt(){const e=Object(i.b)(),t=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id}));return t?Object(j.jsxs)("nav",{className:Mt.a.container,children:[Object(j.jsxs)(c.b,{className:Mt.a.link,to:"/news",children:[Object(j.jsx)(C.s,{className:Mt.a.link_icon,style:{width:"1.1em"}}),Object(j.jsx)("p",{className:Mt.a.link_text,children:"News"})]}),Object(j.jsxs)(c.b,{className:Mt.a.link,to:"/messages",children:[Object(j.jsx)(C.j,{className:Mt.a.link_icon}),Object(j.jsx)("p",{className:Mt.a.link_text,children:"Messages"})]}),Object(j.jsxs)(c.b,{className:Mt.a.link,to:"/friends",children:[Object(j.jsx)(C.O,{className:Mt.a.link_icon,style:{width:"1.25em"}}),Object(j.jsx)("p",{className:Mt.a.link_text,children:"Friends"})]}),Object(j.jsxs)(c.b,{className:Mt.a.link,to:"/id"+t,children:[Object(j.jsx)(C.N,{className:Mt.a.link_icon}),Object(j.jsx)("p",{className:Mt.a.link_text,children:"Profile"})]}),Object(j.jsxs)("button",{className:Mt.a.link,onClick:()=>e(be()),children:[Object(j.jsx)(C.a,{className:Mt.a.link_icon}),Object(j.jsx)("p",{className:Mt.a.link_text,children:"Other"})]})]}):null}var qt=n(52),At=n.n(qt);function Bt(){const e=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id}));return e?Object(j.jsx)("nav",{className:At.a.container+" navigation",children:Object(j.jsx)("div",{className:At.a.wrapper+" navigation__wrapper",children:[{icon:C.N,testId:"nav-profile",text:"My Profile",to:"/id"+e},{icon:C.s,text:"News",to:"/news"},{icon:C.j,testId:"nav-messages",text:"Messages",to:"/messages"},{icon:C.O,text:"Friends",to:"/friends"},{icon:C.S,testId:"nav-communities",text:"Communities",to:"/communities"},{icon:C.b,text:"Bookmarks",to:"/bookmarks"}].map((e=>Object(j.jsxs)(c.b,{className:At.a.link,to:e.to,children:[Object(j.jsx)(e.icon,{className:At.a.link_icon}),Object(j.jsx)("p",{children:e.text})]},e.text)))})}):null}var Ft=n(17),zt=n.n(Ft),Ht=n(20),Ut=n.n(Ht);function Yt(e){let{comment:t,postId:n,replyComment:o,selectedReply:a,setReplyComment:c,setSelectedReply:r,uploadCallback:l}=e;const d=Object(i.b)(),m=Be(),b=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.admin})),f=we((e=>{var t,n;return null===(t=e.user)||void 0===t||null===(n=t.info)||void 0===n?void 0:n.avatar})),v=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),[p,O]=Object(s.useState)(),[x,g]=Object(s.useState)([]),[_,y]=Object(s.useState)([]);function N(e){var t;null===(t=document.querySelector("#"+e))||void 0===t||t.scrollIntoView({behavior:"auto",block:"center"}),r(e),setTimeout((()=>r(null)),0)}Object(s.useEffect)((()=>g(Object.values({...t.replies}))),[t.replies]),Object(s.useEffect)((()=>{const e=le({callback:O,fields:["info","photos"],userId:t.authorId}),n=[],s=[];return x.forEach(((e,t)=>{n.push(le({callback:e=>{s[t]=e,s.length!==x.length||s.includes(void 0)||y([...s])},fields:["info","photos"],userId:e.authorId}))})),()=>{e(),n.forEach((e=>e()))}}),[t.authorId,x]);const w=e=>{var s;let{replies:i,replyTo:r,tempAuthor:O,tempComment:g}=e;return Object(j.jsxs)("div",{className:Ut.a.container,id:g.id,children:[Object(j.jsx)(Se,{src:O.info.avatar,userId:O.info.id}),Object(j.jsxs)("div",{className:Object(u.a)(Ut.a.wrapper,g.id===a&&Ut.a.wrapper_selected),children:[Object(j.jsx)(h,{className:"authorInfo",text:H(g.date),userInfo:O.info}),Object(j.jsx)(wn,{author:O,className:"userMessage",content:g.content,renderReplyToAuthorText:g.replyTo?()=>(e=>{var t;return r&&Object(j.jsxs)("button",{className:Ut.a.replyTo,onClick:()=>N(e),children:[Object(j.jsx)("span",{className:Ut.a.replyTo_name,children:null===(t=_.find((e=>{var t;return e.info.id===(null===(t=x.find((e=>e.id===g.replyTo)))||void 0===t?void 0:t.authorId)})))||void 0===t?void 0:t.info.name}),", "]})})(g.replyTo):void 0}),Object(j.jsxs)("div",{className:Ut.a.footer,children:[Object(j.jsxs)("button",{className:Ut.a.footer_button,onClick:function(e){var s;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!i&&g.id;return Z({condition:!!(null===(s=g.likes)||void 0===s?void 0:s["user"+v]),contentId:t.id,contentPath:`posts/post${n}/comments/${t.id}${o?`/replies/${o}`:""}`,redirect:m,userId:v,userPath:`comments/post${n}/${o?`reply${o}`:`comment${t.id}`}`})},children:[(null===(s=g.likes)||void 0===s?void 0:s["user"+v])?Object(j.jsx)(C.o,{className:Ut.a.footer_button_icon}):Object(j.jsx)(C.B,{className:Ut.a.footer_button_icon}),Object(j.jsx)("p",{className:Ut.a.footer_button_text,children:g.likeCounter||0})]}),Object(j.jsxs)("button",{className:Ut.a.footer_button,onClick:()=>{return e=g,void(v?c({author:_.find((t=>t.info.id===e.authorId))||p,commentId:t.id,reply:e}):m());var e},children:[Object(j.jsx)(C.H,{className:Ut.a.footer_button_icon,style:{width:"1.01em"}}),Object(j.jsx)("p",{className:Ut.a.footer_button_text,children:"reply"})]}),(O.info.id===v||b)&&Object(j.jsxs)("button",{className:Ut.a.footer_deleteButton,onClick:()=>{return e=i?"":g.id,void d(M("action-confirm",{actionConfirm:{callback:()=>ie(`posts/post${n}/comments/${t.id}${e?`/replies/${e}`:""}`).remove().then((()=>d(F("Comment deleted.",C.F)))),irreversible:!0,text:"Are you sure you want to delete this comment?"}}));var e},children:[Object(j.jsx)(C.F,{className:Ut.a.footer_button_icon,style:{width:".9em"}}),Object(j.jsx)("p",{className:Ut.a.footer_button_text,children:"Delete"})]})]}),(null===i||void 0===i?void 0:i.length)>0&&Object(j.jsx)("div",{className:Ut.a.replies,children:i}),(null===o||void 0===o?void 0:o.commentId)===t.id&&i&&Object(j.jsx)(Xt,{avatar:f,buttonText:"Reply",inputPlaceholder:"Leave a comment",uploadCallback:l(t.id,o.reply.id),userId:v,children:Object(j.jsxs)("button",{className:"postMsg__form-reply-to",type:"button",onClick:()=>N(o.reply.id),children:[Object(j.jsx)("p",{className:"postMsg__form-reply-to-text",children:`reply to ${o.author.info.name} ${o.author.info.lastName}`}),Object(j.jsx)(C.q,{className:"postMsg__form-reply-to-icon",style:{width:".62em"}})]})})]})]},g.id)};return p?w({tempAuthor:p,tempComment:t,replies:x.map(((e,t)=>_[t]&&w({tempAuthor:_[t],tempComment:e,replyTo:_.find((t=>{var n;return t.info.id===(null===(n=x.find((t=>t.id===e.replyTo)))||void 0===n?void 0:n.authorId)}))})))}):null}var Vt=n(53),Wt=n.n(Vt);function Kt(e){let{post:t}=e;const{hash:n}=Object(Me.useLocation)(),o=we((e=>{var t,n;return null===(t=e.user)||void 0===t||null===(n=t.info)||void 0===n?void 0:n.avatar})),a=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),i=Object(s.useRef)(null),[c,r]=Object(s.useState)(null),[l,d]=Object(s.useState)(null),u=Object(s.useCallback)((()=>{var e;return null===(e=i.current)||void 0===e?void 0:e.scrollIntoView({behavior:"auto",block:"start"})}),[]);Object(s.useEffect)((()=>"#comments"===n&&setTimeout(u,0)),[n,u]);const m=(e,n)=>s=>{const o=ie().newKey(),i=e?`/${e}/replies`:"";return ie(`posts/post${t.id}/comments${i}/${o}`).set({authorId:a,content:s,date:w,id:o,replyTo:n||null}).then((()=>{r(null),!n&&setTimeout(u,0)}))},b=Object.values({...t.comments}).sort(((e,t)=>t.date-e.date));return Object(j.jsx)("div",{ref:i,className:Wt.a.container,children:Object(j.jsxs)("div",{className:Wt.a.innerContainer,children:[Object(j.jsx)("div",{className:Wt.a.title,children:`Comments (${b.length})`}),Object(j.jsx)("div",{className:Wt.a.wrapper,children:b.map((e=>Object(j.jsx)(Yt,{comment:e,postId:t.id,replyComment:c,selectedReply:l,setReplyComment:r,setSelectedReply:d,uploadCallback:m},e.id)))}),a&&Object(j.jsx)(Xt,{avatar:o,buttonText:"Comment",inputPlaceholder:"Leave a comment",uploadCallback:m(),userId:a})]})})}function Zt(e){var t,n,a;let{fetchedItems:r,index:l=0,loadingCallback:d,post:m,renderComments:b}=e;const h=Object(i.b)(),f=Be(),v=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.admin})),O=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),x=Object(s.useRef)(null),[g,_]=Object(s.useState)(),[y,N]=Object(s.useState)(),[k,I]=Object(s.useState)();Object(s.useEffect)((()=>{if(null===O)return;let e,t,n;const s=()=>{m.shareOrigin?e&&void 0!==t&&n&&(Object(o.unstable_batchedUpdates)((()=>{I(e),N(t),_(n)})),r.current.incrementQty(m.id,d)):e&&(I(e),r.current.incrementQty(m.id,d))},a=le({callback:t=>{e=t,s()},community:!!m.communityId,fields:m.shareOrigin?void 0:["info","photos"],userId:m.authorId||m.communityId});let i;const c=m.shareOrigin?ie("posts/post"+m.shareOrigin).on((e=>{e?(n=e,i=le({callback:e=>{t=e,s()},community:!!e.communityId,fields:["info","photos"],userId:e.authorId||e.communityId})):(t=null,n={deleted:!0},s())})):void 0;return()=>{var e;a(),null===(e=i)||void 0===e||e(),null===c||void 0===c||c()}}),[r,d,m.authorId,m.communityId,m.id,m.shareOrigin,O]);const S=null===(t=m.views)||void 0===t?void 0:t["user"+O];return Object(s.useEffect)((()=>{if(!(null===k||void 0===k?void 0:k.info.id)||!O||S)return;let e;const t=new IntersectionObserver((t=>{let[n]=t;n.isIntersecting?e=setTimeout((()=>{const e=`posts/post${m.id}/`;ie().update({[`${e}viewCounter`]:Object(p.e)(1),[`${e}views/user${O}`]:{date:w,userId:O}})}),5e3):clearInterval(e)}),{threshold:.5});return t.observe(x.current),()=>{t.disconnect(),clearTimeout(e)}}),[m.id,null===k||void 0===k?void 0:k.info.id,S,O]),k?Object(j.jsxs)("article",{className:Object(u.a)(zt.a.container,"post"),ref:x,children:[Object(j.jsxs)("div",{className:zt.a.main,children:[Object(j.jsx)(vn,{bottomText:H(m.date),bottomTextLink:"/post"+m.id,community:!!m.communityId,userInfo:k.info,children:Object(j.jsx)(Et,{bookmarkType:"post",itemId:m.id,children:(k.info.id===O||k.info.creatorId&&k.info.creatorId===O||v)&&Object(j.jsx)(Re,{background:!0,testId:"delete-post-btn",onClick:function(){h(M("action-confirm",{actionConfirm:{callback:()=>ie("posts/post"+m.id).remove().then((()=>h(F("Post deleted.",C.F)))),irreversible:!0,text:"Are you sure you want to delete this post?"}}))},children:"Delete post"})})}),g?Object(j.jsx)("div",{className:zt.a.origin,children:g.deleted?Object(j.jsx)("p",{className:zt.a.origin_deleted,children:"Shared post deleted"}):Object(j.jsxs)("div",{className:zt.a.origin_content,children:[Object(j.jsx)(vn,{bottomText:H(g.date),bottomTextLink:"/post"+g.id,community:!!g.communityId,userInfo:y.info}),Object(j.jsx)(wn,{author:y,className:"userMessage",content:g.content||g.content,lazyLoadEnabled:!0,msgIndex:l})]})}):Object(j.jsx)(wn,{author:k,className:"userMessage",content:m.content,lazyLoadEnabled:!0,msgIndex:l}),Object(j.jsxs)("div",{className:zt.a.footer,children:[Object(j.jsxs)("div",{className:zt.a.footer_buttons,children:[Object(j.jsxs)("button",{"aria-label":(null===(n=m.likes)||void 0===n?void 0:n["user"+O])?"Dislike":"Like",className:zt.a.footer_button,onClick:()=>{var e;return Z({condition:!!(null===(e=m.likes)||void 0===e?void 0:e["user"+O]),contentId:m.id,contentPath:`posts/post${m.id}`,redirect:f,userId:O,userPath:`posts/post${m.id}`})},children:[(null===(a=m.likes)||void 0===a?void 0:a["user"+O])?Object(j.jsx)(C.o,{className:zt.a.footer_item_icon,"aria-label":"Likes"}):Object(j.jsx)(C.B,{className:zt.a.footer_item_icon,"aria-label":"Likes"}),Object(j.jsx)("p",{className:zt.a.footer_item_text,children:m.likeCounter||0})]}),Object(j.jsxs)(c.b,{className:zt.a.footer_button,to:`/post${m.id}#comments`,children:[Object(j.jsx)(C.x,{className:zt.a.footer_item_icon,"aria-label":"Comments"}),Object(j.jsx)("p",{className:zt.a.footer_item_text,children:Object.keys({...m.comments}).length})]}),Object(j.jsxs)("button",{className:zt.a.footer_button,"aria-label":"Share",onClick:function(){O?ie("contentData/nextPostId").once((e=>{const t={authorId:O,date:w,id:e,shareOrigin:m.shareOrigin||m.id};ie().update({["posts/post"+e]:t,"contentData/nextPostId":`${parseInt(e,10)+1}`,...!(null===g||void 0===g?void 0:g.deleted)&&{[`posts/post${m.shareOrigin||m.id}/shareCounter`]:Object(p.e)(1)}}).then((()=>h(F("Shared to your wall.",C.E))))})):f()},children:[Object(j.jsx)(C.E,{className:zt.a.footer_item_icon,style:{width:"1.1em"},"aria-label":"Shares"}),Object(j.jsx)("p",{className:zt.a.footer_item_text,children:m.shareCounter||0})]})]}),Object(j.jsxs)("div",{className:zt.a.footer_item,children:[Object(j.jsx)(C.n,{className:zt.a.footer_item_icon,style:{width:"1.1em"}}),Object(j.jsx)("p",{className:zt.a.footer_item_text,children:m.viewCounter||0})]})]})]}),b&&Object(j.jsx)(Kt,{post:m})]}):null}var Jt=n(21),Qt=n.n(Jt);function Xt(e){let{addToPhotosButton:t,avatar:n,buttonText:o="Post",children:a,community:i,inputPlaceholder:c="Share your thoughts",mobileSubmit:r,uploadCallback:l,userId:d}=e;const m=i?d:null,b=Object(s.useRef)(),[h,f]=Object(s.useState)([]),{formState:{errors:v},handleSubmit:p,register:O,reset:x,setValue:g}=Object(We.a)(),{AsyncButton:_,buttonLoading:y,setButtonLoading:N}=qe(),{addImgPreview:k,imgPreview:I,setImgPreview:S}=Ae(),{ref:$,...E}=O("msg",{maxLength:{value:5e3,message:"A message cannot contain more than 5000 characters"}});function T(e){var t;if(y)return;const n=document.activeElement===b.current,s=new Array(I.length).fill(0),o=null===(t=e.msg)||void 0===t?void 0:t.trim(),a=[];if(I.length||o){N(),f(s),I.length||c();const e=e=>{let{id:t,index:n}=e;a[n]=t,a.length!==I.length||a.includes(void 0)||c()};I.forEach(((t,n)=>oe({addToPhotos:t.addToPhotos,callback:e,communityId:m,file:t.file,index:n,setLoadingPercentage:(e,t)=>{s[t]=e,f([...s])},userId:d})))}async function c(){const e={images:a,text:o||null},t=()=>{var e;x(),S([]),f([]),N(!1),n&&(null===(e=b.current)||void 0===e||e.focus())};l?(await l(e),t()):ie("contentData/nextPostId").once((n=>{const s={authorId:i?null:d,communityId:m,content:e,date:w,id:n};ie().update({["posts/post"+n]:s,"contentData/nextPostId":`${parseInt(n,10)+1}`}).then(t)}))}}return Object(j.jsxs)("div",{className:Object(u.a)(Qt.a.container,"postMsg"),children:[Object(j.jsx)(Se,{community:i,enablePreview:!1,size:"small",src:n,userId:d}),Object(j.jsxs)("form",{className:Object(u.a)(Qt.a.form,"postMsg_form"),onSubmit:p(T),children:[Object(j.jsxs)("div",{className:Object(u.a)(Qt.a.header,"postMsg_header"),children:[a,Object(j.jsx)("textarea",{className:Object(u.a)(Qt.a.input,y&&Qt.a.input_disabled),disabled:y,onKeyPress:function(e){"Enter"!==e.key||e.shiftKey||(e.preventDefault(),g("msg",e.target.value),p(T)())},placeholder:c+"...",ref:e=>{$(e),b.current=e},rows:1,...E}),r&&Object(j.jsxs)("button",{className:Object(u.a)(Qt.a.mobileSubmit,y&&Qt.a.mobileSubmit_loading),children:[y&&Object(j.jsx)(Pt,{className:Qt.a.mobileSubmit_loading_animation}),Object(j.jsx)(C.D,{})]})]}),v.msg&&Object(j.jsx)("p",{className:"error-text",children:v.msg.message}),Object(j.jsxs)("div",{className:Object(u.a)(Qt.a.footer,"postMsg_footer"),children:[Object(j.jsxs)("div",{className:Qt.a.footer_inputs,children:[Object(j.jsxs)("label",{className:Object(u.a)(Qt.a.photo,"postMsg_photo"),children:[Object(j.jsx)("input",{className:Qt.a.photo_input,disabled:y,type:"file",accept:".jpg, .jpeg, .png",multiple:!0,hidden:!0,onChange:k}),Object(j.jsx)("button",{"aria-label":"Photo",className:Object(u.a)(Qt.a.photo_button,y&&Qt.a.photo_button_disabled),type:"button",onClick:e=>e.target.closest("label").click(),children:Object(j.jsx)(C.c,{})})]}),Object(j.jsx)(_,{className:Qt.a.button,testId:"postMsg-btn",type:"submit",children:o})]}),I.length>0&&Object(j.jsx)("div",{className:Qt.a.uploadPreviews,children:Object(j.jsx)("div",{className:Qt.a.uploadPreviews_wrapper,children:I.map(((e,n)=>Object(j.jsx)(jn,{addToPhotosHandler:t?e=>function(e,t){S(I.map(((n,s)=>(s===t&&(n.addToPhotos=e.target.checked),n))))}(e,n):void 0,community:i,imgPreview:e,loadingPercentage:h[n],removeOnClick:()=>S(I.filter((t=>t.result!==e.result)))},n)))})})]})]})]})}var Gt=n(48),en=n.n(Gt);function tn(){const[e,t]=Object(s.useState)(en.a.button_hidden);return Object(s.useEffect)((()=>{const e=setInterval((()=>{t(Object(u.a)(en.a.button,window.pageYOffset<window.innerHeight&&en.a.button_hidden))}),100);return()=>clearInterval(e)}),[]),Object(j.jsx)("div",{className:en.a.container,children:Object(j.jsx)(xt,{className:en.a.pageWidth,children:Object(j.jsx)("button",{className:e,"aria-label":"Scroll to top",onClick:function(){document.body.scrollIntoView({behavior:"smooth",block:"start"})},children:Object(j.jsx)(C.h,{})})})})}var nn=n(62),sn=n.n(nn);function on(e){let{className:t,link:n,onChange:s,onSubmit:o,value:a}=e;const i=n?c.b:"button";return Object(j.jsxs)("form",{className:Object(u.a)(sn.a.form,t),onSubmit:o,children:[Object(j.jsx)("input",{className:sn.a.input,name:"search",placeholder:"Search...",type:"text",value:a,onChange:s}),Object(j.jsx)(i,{className:sn.a.button,to:n&&"/search?query="+encodeURIComponent(a),children:Object(j.jsx)(C.I,{})})]})}var an=n(63),cn=n.n(an);function rn(e){let{items:t}=e;const{search:n}=Object(Me.useLocation)(),s=t.find((e=>e.to===n))||t[0];return Object(j.jsx)("aside",{className:"sidebar",children:Object(j.jsx)("div",{className:Object(u.a)(cn.a.wrapper,"sidebar__wrapper"),children:t.map((e=>Object(j.jsx)(c.b,{className:Object(u.a)(cn.a.button,e===s&&cn.a.button_active),to:e.to,children:e.text},e.text)))})})}var ln=n(43),dn=n.n(ln);function un(){const e=Object(i.b)(),t=we((e=>e.toast)),n=Object(s.useRef)(""),[o,a]=Object(s.useState)(!1);Object(s.useEffect)((()=>{if(!t)return;let s,o;n.current="0s",a(!1);const i=setTimeout((()=>{n.current="",a(!0),s=setTimeout((()=>{a(!1),o=setTimeout((()=>e(A())),400)}),2500)}),10);return()=>{clearTimeout(i),clearTimeout(s),clearTimeout(o)}}),[e,t]);const c=null===t||void 0===t?void 0:t.icon;return Object(j.jsx)(xt,{className:dn.a.pageWidth,children:Object(j.jsx)("div",{className:Object(u.a)(dn.a.wrapper,o&&dn.a.wrapper_open),style:{transitionDuration:n.current},children:Object(j.jsxs)("div",{className:dn.a.innerWrapper,children:[c&&Object(j.jsx)(c,{className:dn.a.icon}),Object(j.jsx)("p",{className:dn.a.text,children:null===t||void 0===t?void 0:t.msg})]})})})}var mn=n(23),bn=n.n(mn);function jn(e){let{addToPhotosHandler:t,community:n,imgPreview:s,loadingPercentage:o,removeOnClick:a}=e;const c=Object(i.b)(),r=Number.isInteger(o);return Object(j.jsxs)("div",{className:Object(u.a)(bn.a.container,"upload-preview"),children:[Object(j.jsxs)("div",{className:bn.a.header,children:[!r&&Object(j.jsx)("button",{className:bn.a.header_remove,type:"button","aria-label":"Remove photo",onClick:a,children:"\xd7"}),Object(j.jsxs)("button",{className:bn.a.header_imgContainer,onClick:()=>c(M("zoom",{zoom:{img:s.result,alt:""}})),type:"button",children:[Object(j.jsx)("img",{className:Object(u.a)(bn.a.header_img,"upload-preview__header-img"),src:s.result,alt:""}),r&&Object(j.jsxs)("div",{className:bn.a.header_overlay,children:[Object(j.jsx)("div",{className:bn.a.header_overlay_loading,style:{width:o+"%"}}),Object(j.jsx)("p",{className:bn.a.header_overlay_text,children:o+"%"})]})]})]}),Object(j.jsx)("div",{className:bn.a.footer,children:Object(j.jsxs)("div",{className:bn.a.footer_wrapper,children:[Object(j.jsx)("h4",{className:Object(u.a)(bn.a.title,bn.a.footer_item),children:s.props.name}),t&&Object(j.jsxs)("label",{className:Object(u.a)(bn.a.checkbox,bn.a.footer_item),children:[Object(j.jsx)("input",{className:bn.a.checkbox_input,disabled:r,type:"checkbox",name:"checkbox",onChange:t}),Object(j.jsx)("p",{className:bn.a.checkbox_text,children:`Add to ${n?"community":"my"} photos`})]})]})})]})}var hn=n(54),fn=n.n(hn);function vn(e){let{avatarSize:t="medium",bottomText:n,bottomTextLink:s,children:o,childrenBottom:a,className:i,community:r,enableAvatarPreview:l,linksOnClick:d,userInfo:m,wrapperLink:b}=e;const f=b?c.b:"div";return Object(j.jsxs)("div",{className:Object(u.a)(fn.a.container,i),children:[Object(j.jsx)(Se,{community:r,enablePreview:l,size:t,src:m.avatar,userId:m.id,onClick:d}),Object(j.jsxs)(f,{className:Object(u.a)(fn.a.wrapper,i&&i+"_wrapper"),to:b,children:[Object(j.jsxs)("div",{className:Object(u.a)(fn.a.header,i&&i+"_header"),children:[Object(j.jsx)(h,{className:"authorInfo",community:r,nameIsLink:!b,text:n,textLink:s,userInfo:m,onClick:d}),o]}),a&&Object(j.jsx)("div",{className:Object(u.a)(fn.a.bottom,i&&i+"_bottom"),children:a})]})]})}var pn=n(83),On=n.n(pn);const xn=Object(s.createContext)(null);function gn(e){let{animationClass:t="lazy-animation",autoCheck:n=!0,autoCheckInterval:o=2e3,scrollOffset:a=0,Tag:i="div",...c}=e;const r=Object(s.useCallback)((()=>d(!0)),[]),[l,d]=Object(s.useState)(!1);return Object(j.jsx)(xn.Provider,{value:{autoCheck:n,autoCheckInterval:o,loadItem:r,scrollOffset:a},children:Object(j.jsx)(i,{...c,className:c.className+(l?"":` ${t}`)})})}function _n(e){let{alt:t,src:n,...o}=e;const{autoCheck:a,autoCheckInterval:i,loadItem:c,scrollOffset:r}=Object(s.useContext)(xn),l=Object(s.useRef)(),d=Object(s.useRef)(null),u=Object(s.useRef)(!1),[m,b]=Object(s.useState)({src:"#",alt:""}),h=Object(s.useCallback)((()=>{window.removeEventListener("load",f),window.removeEventListener("resize",f),window.removeEventListener("scroll",f),clearInterval(l.current)}),[]),f=Object(s.useCallback)((()=>{if(!d.current)return;const e=d.current,s=e.getBoundingClientRect().top+window.pageYOffset+r-window.innerHeight;window.pageYOffset>=s&&e.offsetParent&&"hidden"!==getComputedStyle(e).visibility&&(u.current=!0,b({src:n,alt:t||""}),h())}),[t,h,r,n]);return Object(s.useEffect)((()=>(u.current||(f(),window.addEventListener("load",f),window.addEventListener("resize",f),window.addEventListener("scroll",f),a&&(l.current=setInterval(f,i))),h)),[a,i,f,h]),Object(j.jsx)("img",{ref:d,...o,...m,onLoad:c})}var yn=n(25),Nn=n.n(yn);function wn(e){var t;let{author:n,className:o,content:a,lazyLoadEnabled:r,linkStopPropagation:l,msgIndex:d,renderReplyToAuthorText:m}=e;const b=Object(i.b)(),h=Object(s.useRef)(null),[f,v]=Object(s.useState)(!1),[p,O]=Object(s.useState)(!1),x=(null===(t=a.images)||void 0===t?void 0:t.map((e=>Object.values({...n.photos}).find((t=>t.id===e)))))||[],g=x.filter((e=>e));function _(e,t){e.preventDefault(),l&&e.stopPropagation(),b(M("gallery",{gallery:{authorInfo:n.info,content:g,initialSlide:g.indexOf(g.find((e=>e.id===t)))}}))}return Object(s.useEffect)((()=>{const e=()=>{var e,t;return!p&&v((null===(e=h.current)||void 0===e?void 0:e.scrollHeight)>(null===(t=h.current)||void 0===t?void 0:t.offsetHeight))};return e(),window.addEventListener("loadFinished",e),window.addEventListener("resize",e),()=>{window.removeEventListener("loadFinished",e),window.removeEventListener("resize",e)}}),[p]),Object(j.jsxs)("div",{className:Object(u.a)(Nn.a.container,o),children:[a.text&&Object(j.jsx)(On.a,{componentDecorator:(e,t,n)=>Object(j.jsx)("a",{className:Nn.a.text_link,href:e,rel:"noreferrer",target:"_blank",onClick:e=>e.stopPropagation(),children:t},n),children:Object(j.jsxs)("div",{className:Object(u.a)(Nn.a.item,Nn.a.textContainer,o&&o+"_textContainer"),children:[Object(j.jsxs)("p",{className:Object(u.a)(Nn.a.text,o&&o+"_text"),ref:h,style:{display:p?"block":""},children:[null===m||void 0===m?void 0:m(),a.text]}),f&&Object(j.jsx)("div",{className:Object(u.a)(Nn.a.text_showMore,o&&o+"_text_showMore"),role:"button",tabIndex:0,onClick:function(e){e.stopPropagation(),O(!p)},onKeyPress:function(e){["Enter"," "].includes(e.key)&&(e.preventDefault(),e.target.click())},children:p?"Show less":"Show more"})]})}),x.map(((e,t)=>Object(j.jsx)(s.Fragment,{children:e?!r||d<4?Object(j.jsx)(c.b,{className:Object(u.a)(Nn.a.item,Nn.a.imgContainer,o&&o+"_imgContainer"),to:"#javascript",onClick:t=>_(t,e.id),children:Object(j.jsx)("img",{className:Nn.a.img,src:e.src,alt:""})}):Object(j.jsx)(gn,{className:Object(u.a)(Nn.a.item,Nn.a.imgContainer,o&&o+"_imgContainer"),onClick:t=>_(t,e.id),scrollOffset:-1e3,Tag:c.b,to:"#javascript",children:Object(j.jsx)(_n,{className:Nn.a.img,src:e.src,alt:""})}):Object(j.jsx)("p",{className:Object(u.a)(Nn.a.item,Nn.a.deletedPhoto),children:"Deleted photo"})},t)))]})}var kn=n(64),In=n.n(kn);function Cn(e){let{button:t,requestDate:n,singleUser:s,users:o}=e;const a=Object(i.b)(),c=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),r=e=>Object(j.jsx)("div",{className:In.a.item,children:Object(j.jsx)(vn,{bottomText:n?H(n):K(e),childrenBottom:Object(j.jsxs)(j.Fragment,{children:["bookmarks"===t&&!n&&Object(j.jsx)(Re,{background:!0,className:In.a.button,onClick:()=>(e=>ie(`users/user${c}/bookmarks/users/user${e.info.id}`).remove().then((()=>a(F("Item removed from bookmarks.",C.v)))))(e),children:"Remove from bookmarks"}),n&&Object(j.jsx)(Re,{background:!0,className:In.a.button,onClick:()=>U({reqUserId:e.info.id,userId:c}),children:"Accept friend request"})]}),className:"user",userInfo:e.info})},e.info.id);return s?r(s):Object(j.jsx)("div",{className:"usersList",children:o.map((e=>r(e)))})}function Sn(e){let{children:t,className:n,modalName:o,testId:a,zoomImg:c}=e;const r=Object(i.b)(),l=we((e=>e.modal.activeModals)),d=we((e=>e.modal.currentModal)),u=we((e=>e.modal.zoom)),m=Object(s.useRef)(l);m.current=l;const b=Object(s.useRef)(null),h=Object(s.useRef)(null),f=Object(s.useCallback)((()=>{r(P(o))}),[r,o]);const v=Object(s.useRef)(!1);const p=Object(s.useCallback)((e=>{"Escape"===e.key&&d===o&&f()}),[f,d,o]);return Object(s.useEffect)((()=>(window.addEventListener("keydown",p),()=>window.removeEventListener("keydown",p))),[p]),Object(s.useEffect)((()=>{if(d!==o)return;let e=document.activeElement;const t=n=>{"Tab"!==n.key||h.current.contains(document.activeElement)||(e=document.activeElement,n.preventDefault(),h.current.querySelector("button").focus(),window.removeEventListener("keydown",t))};return window.addEventListener("keydown",t),()=>{m.current.includes(o)||(e.focus({preventScroll:!0}),setTimeout((()=>document.activeElement.blur()),0)),window.removeEventListener("keydown",t)}}),[l,d,o]),Object(j.jsx)("div",{className:`${n?`${n} `:""}modal-${o} modal${l.includes(o)?" modal--open":""}`,onMouseDown:function(e){e.target===h.current&&(v.current=!0)},onMouseUp:function(e){v.current&&e.target===h.current&&f(),v.current=!1},onTransitionEnd:function(e){d||e.target!==b.current||"visibility"!==e.nativeEvent.propertyName||E()},ref:b,children:Object(j.jsx)("div",{className:"modal__wrapper",ref:h,children:Object(j.jsxs)("div",{className:`modal-${o}__content modal__content`,onClick:e=>e.stopPropagation(),children:[Object(j.jsx)(Re,{ariaLabel:"Close modal",background:!0,className:"modal__close",onClick:f,children:"\xd7"}),t,c&&Object(j.jsx)("img",{className:"modal-zoom__img",src:(null===u||void 0===u?void 0:u.img)||"#",alt:(null===u||void 0===u?void 0:u.alt)||""})]})})})}function $n(){const e=Object(i.b)(),t=we((e=>e.modal.actionConfirm)),n=we((e=>e.modal.activeModals)),o=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.password})),{formState:{errors:a},handleSubmit:c,register:r,reset:l}=Object(We.a)(),d=Object(s.useRef)(!1),[u,m]=Object(s.useState)(!1);function b(n){n.password&&x(o)!==n.password?m(!0):(e(P("action-confirm")),null===t||void 0===t||t.callback())}return Object(s.useEffect)((()=>{!d.current&&n.includes("action-confirm")?(d.current=!0,l(),m(!1)):d.current=!1}),[n,l]),(null===t||void 0===t?void 0:t.text)?Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("div",{className:"modal-action-confirm__header",children:Object(j.jsx)("h4",{className:"modal-action-confirm__title",children:"Confirm action"})}),Object(j.jsxs)("div",{className:"modal-action-confirm__wrapper",children:[Object(j.jsx)("p",{className:"modal-action-confirm__text",children:t.text+(t.irreversible?" This action is irreversible!":"")}),t.password&&Object(j.jsxs)(et,{autoComplete:"off",onSubmit:c(b),children:[Object(j.jsx)(Ct,{id:"modal-action-confirm__form-input",onInput:()=>m(!1),opts:{obj:Ke.find((e=>"existingPassword"===e.id)),errors:a,label:!0,labelText:"Enter your password to continue",placeholder:!0,register:r}}),u&&Object(j.jsx)("p",{className:"error-text",children:"Wrong password."})]}),Object(j.jsxs)("div",{className:"modal-action-confirm__buttons",children:[Object(j.jsx)(Re,{afterIcon:C.d,background:!0,preset:"secondary",testId:"action-confirm-yes",type:"submit",onClick:c(b),children:"Yes"}),Object(j.jsx)(Re,{afterIcon:C.J,background:!0,iconStyles:{width:".7em"},preset:"remove",onClick:()=>e(P("action-confirm")),children:"No"})]})]})]}):null}function En(){const e=Object(i.b)(),t=we((e=>e.modal.actionError));return t?Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("div",{className:"modal-action-error__header",children:Object(j.jsx)("h4",{className:"modal-action-error__title",children:"Error"})}),Object(j.jsxs)("div",{className:"modal-action-error__wrapper",children:[Object(j.jsx)("p",{className:"modal-action-error__text",children:t}),Object(j.jsx)(Re,{afterIcon:C.d,background:!0,onClick:()=>e(P("action-error")),children:"OK"})]})]}):null}function Tn(){const e=Object(i.b)(),t=we((e=>e.modal.changeAvatarCommunityId)),n=we((e=>e.modal.currentModal)),o=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),a=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.profilePhotos})),{AsyncButton:c,buttonLoading:r,setButtonLoading:l}=qe(),{addImgPreview:d,imgPreview:u,setImgPreview:m}=Ae(!1),b=Object(s.useRef)(!1),[h,f]=Object(s.useState)();return"change-avatar"===n&&(b.current=!0),b.current?Object(j.jsx)("div",{children:u.length?Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(jn,{imgPreview:u[0],loadingPercentage:h,removeOnClick:()=>m([])}),Object(j.jsx)(c,{afterIcon:C.d,className:"set-button",preset:"secondary",onClick:function(){r||(l(),f(0),oe({addToPhotos:!0,callback:n=>{let{link:s}=n;ie(`${t?`communities/community${t}`:`users/user${o}`}/info/avatar`).set(s).then((()=>{e(P("change-avatar")),setTimeout((()=>{l(!1),m([]),f(null)}),400)}))},communityId:t,file:u[0].file,setLoadingPercentage:f,userId:o}))},children:"Set as avatar"})]}):Object(j.jsxs)(j.Fragment,{children:[!t&&a&&Object(j.jsx)(Re,{afterIcon:C.p,background:!0,iconStyles:{width:"1.15em"},onClick:()=>e(M("choose-photo")),children:"Choose an existing photo"}),Object(j.jsxs)("label",{className:"modal-change-avatar__upload",htmlFor:"modal-change-avatar__upload-input",children:[Object(j.jsx)(Re,{afterIcon:C.M,background:!0,preset:"secondary",onClick:e=>{var t;return null===(t=e.target.closest("label"))||void 0===t?void 0:t.click()},children:"Upload photo"}),Object(j.jsx)("input",{className:"modal-change-avatar__upload-input",id:"modal-change-avatar__upload-input",type:"file",accept:".jpg, .jpeg, .png",hidden:!0,onChange:d})]})]})}):null}function Ln(){const e=Object(i.b)(),t=we((e=>e.modal.currentModal)),n=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),o=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.photos})),a=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.profilePhotos})),c=Object(s.useRef)(!1),[r,l]=Object(s.useState)([]);return Object(s.useEffect)((()=>{const e=[];Object.keys({...a}).forEach((t=>e.push(null===o||void 0===o?void 0:o[t]))),e.includes(void 0)||l(e.sort(((e,t)=>t.date-e.date)))}),[o,a]),"choose-photo"===t&&(c.current=!0),c.current?Object(j.jsxs)("div",{className:"modal-choose-photo__photos",children:[Object(j.jsx)("div",{className:"photos__header",children:Object(j.jsx)("h4",{className:"photos__title",children:`Your photos (${r.length})`})}),Object(j.jsx)("div",{className:"photos__items",children:r.map((t=>Object(j.jsx)("button",{className:"photos__item",onClick:()=>{return s=t.src,X(n,s),e(P("choose-photo")),void e(P("change-avatar"));var s},children:Object(j.jsx)("img",{className:"photos__item-img",src:t.src,alt:""})},t.id)))})]}):null}function Pn(){const e=Object(i.b)(),t=we((e=>e.modal.currentModal)),n=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),{formState:{errors:o},handleSubmit:a,register:c,reset:r}=Object(We.a)(),{AsyncButton:l,buttonLoadingRef:d,setButtonLoading:u}=qe(),m=Object(s.useRef)(!1);return"create-community"===t&&(m.current=!0),m.current?Object(j.jsxs)(et,{onSubmit:a((function(t){if(!d.current){u(),t=W(t);for(const e in t)t[e]||(t[e]=null);ie("contentData/nextCommunityId").once((s=>{const o={fullInfo:{creationTime:w,description:t.description},info:{avatar:"img/community-default.svg",creatorId:n,id:s,shortDescription:t.shortDescription,title:t.title}};ie().update({["communities/community"+s]:o,"contentData/nextCommunityId":`${parseInt(s,10)+1}`}).then((()=>{e(P("create-community")),setTimeout((()=>{r(),u(!1)}),400)}))}))}})),children:[Ke.filter((e=>["title","description","shortDescription"].includes(e.id))).map((e=>Object(j.jsx)(Ct,{opts:{obj:e,errors:o,placeholder:!0,register:c}},e.id))),Object(j.jsx)(l,{testId:"create-community-btn",type:"submit",children:"Create community"})]}):null}var Rn=n(124),Mn=n(119),Dn=n(120),qn=n(121),An=n(122),Bn=n(125),Fn=n(123);function zn(){const e=Object(i.b)(),t=we((e=>e.modal.gallery)),n=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.admin})),o=we((e=>{var t,n;return null===(t=e.user)||void 0===t||null===(n=t.info)||void 0===n?void 0:n.avatar})),a=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),c=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.profilePhotos})),r=Object(s.useRef)(null),l=Object(s.useRef)(null),[d,u]=Object(s.useState)(),[m,b]=Object(s.useState)();Object(s.useEffect)((()=>{d&&m&&(d.params.navigation.prevEl=r.current,d.params.navigation.nextEl=l.current,d.controller.control=m,m.controller.control=d)}),[d,m]),Object(s.useEffect)((()=>{t&&d&&(d[t.content.length>1?"enable":"disable"](),d.update(),d.slideToLoop(t.initialSlide,0))}),[t,d]);const h=()=>e(P("gallery"));if(!t)return null;return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsxs)(Bn.a,{className:"gallery-swiper__container",autoHeight:!0,keyboard:!0,navigation:{prevEl:r.current,nextEl:l.current},onBeforeInit:e=>{e.params.navigation.prevEl=r.current,e.params.navigation.nextEl=l.current},onSwiper:u,pagination:{type:"fraction"},speed:600,children:[t.content.map((s=>{var i;return Object(j.jsxs)(Fn.a,{className:"gallery-swiper__slide",children:[Object(j.jsx)("div",{className:"modal-gallery__img-container",children:Object(j.jsx)("img",{className:"modal-gallery__img",src:s.src,alt:""})}),Object(j.jsxs)("div",{className:"modal-gallery__info",children:[Object(j.jsx)(vn,{avatarSize:"small",bottomText:H(s.date),className:"user",community:!!(null===(i=t.authorInfo)||void 0===i?void 0:i.title),linksOnClick:h,userInfo:t.authorInfo}),Object(j.jsxs)("div",{className:"modal-gallery__info-buttons",children:[t.authorInfo.id===a&&s.src!==o&&(null===c||void 0===c?void 0:c[s.id])&&Object(j.jsx)(Re,{background:!0,beforeIcon:C.N,preset:"secondary",onClick:()=>{return e=s.src,X(a,e),void h();var e},children:"Set as avatar"}),(t.authorInfo.id===a||t.authorInfo.creatorId&&t.authorInfo.creatorId===a||n)&&Object(j.jsx)(Re,{background:!0,beforeIcon:C.K,preset:"remove",onClick:()=>(n=>{const s=t.authorInfo.title,o=(s?"communities/community":"users/user")+t.authorInfo.id;e(M("action-confirm",{actionConfirm:{callback:()=>{ie().update({[`${o}/photos/${n.id}`]:null,[`${o}/profilePhotos/${n.id}`]:null,...t.authorInfo.avatar===n.src&&{[`${o}/info/avatar`]:`img/${s?"community":"user"}-default.svg`}}).then((()=>e(F("Photo deleted.",C.F)))),k.delete(n.src),h()},irreversible:!0,text:"Are you sure you want to delete this photo?"}}))})(s),children:"Delete photo"})]})]})]},s.id)})),Object(j.jsx)("button",{className:"gallery-swiper__button-prev swiper-button-prev",ref:r,children:Object(j.jsx)(C.f,{})}),Object(j.jsx)("button",{className:"gallery-swiper__button-next swiper-button-next",ref:l,children:Object(j.jsx)(C.g,{})})]}),Object(j.jsx)(Bn.a,{breakpoints:{768:{slidesPerView:6}},centeredSlides:!0,className:"gallery-thumbs__container",onSwiper:b,slidesPerView:4,slideToClickedSlide:!0,spaceBetween:10,speed:600,children:t.content.map((e=>Object(j.jsx)(Fn.a,{className:"gallery-thumbs__slide",children:Object(j.jsx)("button",{className:"gallery-thumbs__slide-button",children:Object(j.jsx)("img",{className:"gallery-thumbs__slide-img",src:e.src,alt:""})})},e.id)))})]})}let Hn;function Un(){const e=Object(i.b)(),{formState:{errors:t},handleSubmit:n,register:o}=Object(We.a)(),{AsyncButton:a,buttonLoadingRef:c,setButtonLoading:r}=qe(),[l,d]=Object(s.useState)({});const u={errors:t,placeholder:!0,register:o};return Object(j.jsxs)(et,{noValidate:!0,onChange:()=>r(!1),onSubmit:n((function(t){var n;c.current||(r(),t=W(t),null===(n=Hn)||void 0===n||n(),Hn=ie("users").orderByChild("account/email").equalTo(t.email.toLowerCase()).on((n=>{if(Hn(),!c.current)return;const s=function(e){const t={...l};return e.password!==e.confirmPassword&&(t.wrongConfirmPassword=!0),d(t),t}(t);n&&(d({...s,emailExists:!0}),s.emailExists=!0),Object.values(s).includes(!0)?r(!1):ie("contentData/nextUserId").once((async n=>{t.confirmPassword=null;const s=await ce(),o={account:{email:t.email.toLowerCase(),id:n,password:O(t.password,n),preferences:{darkTheme:!!ne()||null},registrationData:{date:w,location:s}},info:{avatar:"img/user-default.svg",gender:t.gender,id:n,lastName:t.lastName,lastSeen:w,name:t.name}};ie().update({["users/user"+n]:o,"contentData/nextUserId":`${parseInt(n,10)+1}`}).then((()=>{e(P("sign-up")),setTimeout((()=>{e(Oe(o)),e(vt())}),400)}))}))})))})),children:[Object(j.jsx)(Ct,{opts:{obj:Ke.find((e=>"name"===e.id)),...u}}),Object(j.jsx)(Ct,{opts:{obj:Ke.find((e=>"lastName"===e.id)),...u}}),Object(j.jsx)(st,{register:o}),Object(j.jsx)(Ct,{onInput:()=>d({...l,emailExists:!1}),opts:{obj:Ke.find((e=>"email"===e.id)),...u}}),l.emailExists&&Object(j.jsx)("p",{className:"error-text",children:"This email is already used."}),Ke.filter((e=>["password","confirmPassword"].includes(e.id))).map((e=>Object(j.jsx)(Ct,{onInput:()=>d({...l,wrongConfirmPassword:!1}),opts:{obj:e,...u}},e.id))),l.wrongConfirmPassword&&Object(j.jsx)("p",{className:"error-text",children:"Wrong confirm password."}),Object(j.jsx)(a,{testId:"sign-up-btn",type:"submit",children:"Sign up"})]})}function Yn(){const e=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id}));return Object(j.jsxs)("div",{children:[Object(j.jsx)(Sn,{modalName:"gallery",children:Object(j.jsx)(zn,{})}),e?Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(Sn,{modalName:"create-community",children:Object(j.jsx)(Pn,{})}),Object(j.jsx)(Sn,{modalName:"change-avatar",children:Object(j.jsx)(Tn,{})}),Object(j.jsx)(Sn,{modalName:"choose-photo",children:Object(j.jsx)(Ln,{})}),Object(j.jsx)(Sn,{modalName:"action-confirm",testId:"action-confirm-modal",children:Object(j.jsx)($n,{})}),Object(j.jsx)(Sn,{modalName:"action-error",children:Object(j.jsx)(En,{})}),Object(j.jsx)(Sn,{modalName:"zoom",zoomImg:!0})]}):Object(j.jsx)(Sn,{modalName:"sign-up",children:Object(j.jsx)(Un,{})})]})}function Vn(){const e=Object(i.b)(),{pathname:t}=Object(Me.useLocation)(),n=we((e=>e.modal.currentModal)),o=Object(s.useRef)(null);return o.current=n,Object(s.useEffect)((()=>{o.current&&e(P(o.current))}),[e,t]),null}function Wn(){const e=Object(i.b)(),t=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id}));return Object(s.useEffect)((()=>{if(!t)return;const e="users/user"+t;let n;const s=ie(".info/connected").on((t=>{t&&(n&&Object(p.m)(n),n=ie(e+"/connections").push(),Object(p.o)(n,!0),Object(p.f)(n).remove(),ie(e+"/info/lastSeen").onDisconnect().set(w))}));return()=>{Object(p.m)(n),ie(e+"/info/lastSeen").onDisconnect().cancel(),ie(e+"/info/lastSeen").set(w),s()}}),[e,t]),Object(s.useEffect)((()=>{const t=()=>e(vt());return t(),window.addEventListener("storage",t),()=>window.removeEventListener("storage",t)}),[e]),null}Rn.a.use([Mn.a,Dn.a,qn.a,An.a]);var Kn=n(49),Zn=n.n(Kn);function Jn(){var e;const t=Object(i.b)(),{search:n}=Object(Me.useLocation)(),o=new URLSearchParams(n).get("tab"),a=Be(),c=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.bookmarks})),r=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),l=["communities","users"].find((e=>e===o))||"posts",d=Object(s.useRef)(),[u,m]=Object(s.useState)([]),{fetchedItems:b,finishLoading:h}=De(),f=Object(s.useCallback)((()=>h("Bookmarks")),[h]);Object(s.useEffect)((()=>{if(void 0===r&&a(),!r)return;const e=Object.values({...null===c||void 0===c?void 0:c[l]}).sort(((e,t)=>t.date-e.date));e.length||(f(),m([]));const t=[],n=[],s=(t,s,o)=>{n[o]=t||{id:s.id,unavailable:!0},n.length!==e.length||n.includes(void 0)||(m([...n]),["users","communities"].includes(l)?f():b.current.setExpected(n.length,f)),!t&&b.current.incrementQty(s.id,f)};return e.forEach(((e,n)=>{["communities","users"].includes(l)?t.push(le({callback:t=>s(t,e,n),community:"communities"===l,fields:"communities"===l?["fullInfo","info"]:["connections","info"],userId:e.id})):t.push(ie("posts/post"+e.id).on((t=>s(t,e,n))))})),()=>t.forEach((e=>e()))}),[l,b,f,a,c,r]),Object(s.useEffect)((()=>d.current=l),[l]);const v=u.filter((e=>!e.unavailable)),p=null===(e=u.filter((e=>e.unavailable)))||void 0===e?void 0:e.length;return Object(j.jsxs)("section",{className:Zn.a.container,children:[Object(j.jsxs)(Ve,{children:[Object(j.jsxs)("div",{className:Zn.a.header,children:[Object(j.jsx)("h1",{className:Zn.a.header_title,children:`${l} bookmarks (${u.length})`}),p>0&&Object(j.jsxs)("p",{className:Zn.a.header_unavailable,children:[p+" unavailable item(s) are hidden ",Object(j.jsx)("button",{className:Zn.a.header_unavailable_remove,onClick:function(){const e="communities"===l?"community":l.slice(0,-1);ie().update(u.reduce(((t,n)=>(n.unavailable&&(t[`users/user${r}/bookmarks/${l}/${e+n.id}`]=null),t)),{})).then((()=>t(F("Unavailable bookmarks removed.",C.v))))},children:"(Remove)."})]})]}),l===d.current&&("posts"===l?v.map(((e,t)=>Object(j.jsx)(Zt,{fetchedItems:b,index:t,loadingCallback:f,post:e},e.id))):"users"===l?Object(j.jsx)(Cn,{button:"bookmarks",users:v}):Object(j.jsx)(He,{communitiesInfo:v.map((e=>e.info))}))]}),Object(j.jsx)(rn,{items:[{text:`Posts (${Object.keys({...null===c||void 0===c?void 0:c.posts}).length})`,to:"/bookmarks"},{text:`Users (${Object.keys({...null===c||void 0===c?void 0:c.users}).length})`,to:"?tab=users"},{text:`Communities (${Object.keys({...null===c||void 0===c?void 0:c.communities}).length})`,to:"?tab=communities"}]})]})}var Qn=n(29),Xn=n.n(Qn);function Gn(){const e=Object(i.b)(),t=Be(),n=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),[a,c]=Object(s.useState)([]),[r,l]=Object(s.useState)(),[d,u]=Object(s.useState)([]),{finishLoading:m}=De();return Object(s.useEffect)((()=>{if(null!==n)return ie("communities").on((e=>{m("Communities");const t=Object.values({...e}),s=t.filter((e=>e.info.creatorId!==n));Object(o.unstable_batchedUpdates)((()=>{c(t.filter((e=>e.info.creatorId===n))),l(s.filter((e=>{var t;return!(null===(t=e.subscribers)||void 0===t?void 0:t["user"+n])&&!e.info.deleted}))),u(s.filter((e=>{var t;return null===(t=e.subscribers)||void 0===t?void 0:t["user"+n]})))}))}))}),[m,n]),r?Object(j.jsx)("section",{className:Xn.a.container,children:Object(j.jsxs)(Ve,{children:[Object(j.jsxs)("div",{className:Xn.a.header,children:[Object(j.jsx)("h1",{className:Xn.a.title,children:"Communities"}),Object(j.jsx)(Re,{background:!0,className:Xn.a.button,testId:"open-create-community-modal",onClick:()=>n?e(M("create-community")):t(),children:"Create new community"})]}),a.length>0&&Object(j.jsxs)("div",{className:Xn.a.item,children:[Object(j.jsx)("div",{className:Xn.a.item_header,children:Object(j.jsx)("h2",{className:Xn.a.item_title,children:`My communities (${a.length})`})}),Object(j.jsx)(He,{communitiesInfo:a.map((e=>e.info)),renderSubscribeButton:!1})]}),d.length>0&&Object(j.jsxs)("div",{className:Xn.a.item,children:[Object(j.jsx)("div",{className:Xn.a.item_header,children:Object(j.jsx)("h2",{className:Xn.a.item_title,children:`Subscribed (${d.length})`})}),Object(j.jsx)(He,{communitiesInfo:d.map((e=>e.info))})]}),r.length>0&&Object(j.jsxs)("div",{className:Xn.a.item,children:[Object(j.jsx)("div",{className:Xn.a.item_header,children:Object(j.jsx)("h2",{className:Xn.a.item_title,children:`Explore (${r.length})`})}),Object(j.jsx)(He,{communitiesInfo:r.map((e=>e.info))})]})]})}):null}var es=n(55),ts=n.n(es);function ns(){return Object(s.useEffect)((()=>document.title="404 Not Found | Social App"),[]),Object(j.jsx)("section",{children:Object(j.jsx)(Ve,{children:Object(j.jsxs)("div",{className:ts.a.wrapper,children:[Object(j.jsx)("p",{className:ts.a.number,children:"404"}),Object(j.jsx)("h2",{className:ts.a.title,children:"Not Found"}),Object(j.jsx)("p",{className:ts.a.text,children:"The requested page was not found on our server. It may have been removed."})]})})})}function ss(){var e,t,n,o,a,c;const r=Object(i.b)(),{communityId:l}=Object(Me.useParams)(),d=Be(),u=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.admin})),m=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),b=we((e=>{var t,n,s;return null===(t=e.user)||void 0===t||null===(n=t.communities)||void 0===n||null===(s=n.subscribed)||void 0===s?void 0:s["community"+l]})),{AsyncButton:h,buttonLoading:f,setButtonLoading:v}=qe(),{addImgPreview:p,imgPreview:O,setImgPreview:x}=Ae(!1),g=Object(s.useRef)([]),[_,y]=Object(s.useState)(),[N,w]=Object(s.useState)(),[I,S]=Object(s.useState)(!1),[$,E]=Object(s.useState)(),[T,L]=Object(s.useState)(!1),{fetchedItems:P,finishLoading:R,loaded:D,setTitle:q}=De(),A=Object(s.useCallback)((()=>R(_.info.title)),[_,R]);function B(){var e;V(l,null===(e=_.fullInfo.banner)||void 0===e?void 0:e.src,_.info.subscriberCount)}return Object(s.useEffect)((()=>{if(null===m)return;let e,t;const n=le({callback:n=>{if(g.current=[],null===n||void 0===n?void 0:n.profilePhotos){for(const e in n.profilePhotos){var s;(null===(s=n.photos)||void 0===s?void 0:s[e])&&g.current.push(n.photos[e])}g.current.sort(((e,t)=>t.date-e.date))}y(n),n?((t=>{var n;t.info.deleted||(null===(n=e)||void 0===n||n(),e=le({callback:e=>w([e.info]),userId:t.info.creatorId}))})(n),(()=>{var e;null===(e=t)||void 0===e||e(),t=ie("posts").orderByChild("communityId").equalTo(l).on((e=>{const t=Object.values({...e});E(t.sort(((e,t)=>+t.id-+e.id))),P.current.setExpected(t.length)}))})()):R()},community:!0,fields:["fullInfo","info","photos","profilePhotos"],userId:l});return()=>{var s,o;n(),null===(s=e)||void 0===s||s(),null===(o=t)||void 0===o||o()}}),[l,P,R,m]),Object(s.useEffect)((()=>{D.current&&_?q(_.info.title):0===(null===$||void 0===$?void 0:$.length)?A():null===_&&R()}),[_,R,D,A,$,q]),void 0===_?null:_?Object(j.jsxs)("section",{className:"community",children:[Object(j.jsx)(Ve,{children:Object(j.jsxs)("div",{className:"community__content",children:[Object(j.jsxs)("div",{className:"community__header",children:[_.info.creatorId!==m&&!u||_.info.deleted?(null===(o=_.fullInfo)||void 0===o?void 0:o.banner)&&Object(j.jsx)("div",{className:"community__banner",children:Object(j.jsx)("img",{className:"community__banner-img",src:null===(a=_.fullInfo)||void 0===a?void 0:a.banner.src,alt:""})}):O[0]?Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("div",{className:"community__banner",children:Object(j.jsx)("img",{className:"community__banner-img",src:O[0].result,alt:""})}),Object(j.jsxs)("div",{className:"community__header-buttons",children:[Object(j.jsx)(h,{onClick:function(){var e;if(f)return;v();const t=null===(e=_.fullInfo.banner)||void 0===e?void 0:e.src;oe({callback:()=>{t&&k.delete(t),v(!1),x([])},communityId:l,createId:!1,file:O[0].file,imgParent:"fullInfo",imgPath:"banner",storagePrefix:"community"+l})},children:"Confirm banner"}),!f&&Object(j.jsx)(Re,{background:!0,preset:"secondary",onClick:()=>x([]),children:"Cancel"})]})]}):Object(j.jsxs)("label",{className:"community__banner-upload",htmlFor:"community__banner-overlay-input",children:[Object(j.jsxs)("button",{className:"community__banner-button community__banner",onClick:e=>{var t;return null===(t=e.target.closest("label"))||void 0===t?void 0:t.click()},children:[(null===(e=_.fullInfo)||void 0===e?void 0:e.banner)?Object(j.jsx)("img",{className:"community__banner-img",src:null===(t=_.fullInfo)||void 0===t?void 0:t.banner.src,alt:""}):Object(j.jsx)("p",{className:"community__banner-placeholder",children:"No banner"}),Object(j.jsxs)("div",{className:"community__banner-overlay",children:[Object(j.jsx)(C.C,{className:"community__banner-overlay-icon",style:{height:"1.1em"}}),Object(j.jsx)("p",{className:"community__banner-overlay-text",children:((null===(n=_.fullInfo)||void 0===n?void 0:n.banner)?"Change":"Set")+" banner"})]})]}),Object(j.jsx)("input",{className:"community__banner-overlay-input",id:"community__banner-overlay-input",type:"file",accept:".jpg, .jpeg, .png",hidden:!0,onChange:p})]}),Object(j.jsxs)("div",{className:"community__info",children:[Object(j.jsxs)("div",{className:"community__info-content",children:[Object(j.jsx)(Te,{avatar:g.current.find((e=>e.src===_.info.avatar)),className:"avatar-gallery",userInfo:_.info}),Object(j.jsxs)("div",{className:"community__info-text",children:[Object(j.jsx)(Qe,{classes:{form:"community-title__form",text:"community-title__text"},className:"community-title",databaseRef:`communities/community${l}/info/title`,disabled:_.info.deleted,field:_.info.title,ownerId:_.info.creatorId,renderInputId:"title"}),Object(j.jsx)("p",{className:"community__info-subscribers",children:Q("subscriber",_.info.subscriberCount||0)}),I&&Object(j.jsx)("div",{className:"community__contacts",children:null===N||void 0===N?void 0:N.map((e=>Object(j.jsx)(vn,{avatarSize:"small",bottomText:"Creator",className:"user",enableAvatarPreview:!1,userInfo:e},e.id)))})]})]}),Object(j.jsxs)("div",{className:"community__info-buttons",children:[Object(j.jsx)(Re,{background:!0,className:"community-subscribe",preset:b?"remove":"primary",onClick:()=>ee(l,d,m,!!b),children:b?"Unsubscribe":"Subscribe"}),!_.info.deleted&&Object(j.jsx)("button",{className:"community__toggle",onClick:()=>S(!I),children:(I?"Hide":"Show")+" contacts"})]})]}),(m===_.info.creatorId||u)&&Object(j.jsxs)("div",{className:"community__info-footer-buttons",children:[Object(j.jsx)(Re,{background:!0,onClick:()=>r(M("change-avatar",{changeAvatarCommunityId:l})),children:"Change avatar"}),Object(j.jsx)(Re,{background:!0,preset:"remove",onClick:B,children:"Delete community"})]})]}),Object(j.jsxs)("div",{className:"community__description",children:[Object(j.jsx)("h3",{className:"community__description-title",children:"Description"}),Object(j.jsxs)("div",{className:"community__description-wrapper",children:[Object(j.jsx)(Qe,{classes:{text:"community__description-wrapper-text"},databaseRef:`communities/community${l}/fullInfo/description`,disabled:_.info.deleted,emptyButtonText:"Set description",emptyFieldText:"No description provided.",field:_.info.deleted?"This community has been deleted.":null===(c=_.fullInfo)||void 0===c?void 0:c.description,ownerId:_.info.creatorId,renderInputId:"description"}),T&&Object(j.jsxs)("div",{className:"community__description-short",children:[Object(j.jsx)("h4",{className:"community__description-short-title",children:"Short description:"}),Object(j.jsx)(Qe,{classes:{text:"community__description-wrapper-text"},databaseRef:`communities/community${l}/info/shortDescription`,disabled:_.info.deleted,emptyButtonText:"Set short description",emptyFieldText:"No description provided.",field:_.info.deleted?"This community has been deleted.":_.info.shortDescription,ownerId:_.info.creatorId,renderInputId:"shortDescription"})]}),(m===_.info.creatorId||u)&&!_.info.deleted&&Object(j.jsx)("button",{className:"community__toggle",onClick:()=>L(!T),children:(T?"Hide":"Show")+" short description"})]})]}),m===_.info.creatorId&&!_.info.deleted&&Object(j.jsx)(Xt,{addToPhotosButton:!0,avatar:_.info.avatar,community:!!l,userId:l}),!_.info.deleted&&Object(j.jsxs)("div",{className:"community__posts",children:[Object(j.jsx)("div",{className:"community__posts-header",children:Object(j.jsx)("h3",{className:"community__posts-title",children:"Posts"})}),null===$||void 0===$?void 0:$.map(((e,t)=>Object(j.jsx)(Zt,{fetchedItems:P,index:t,loadingCallback:A,post:e},e.id)))]})]})}),!_.info.deleted&&Object(j.jsxs)("aside",{className:"community__sidebar sidebar",children:[Object(j.jsx)("h3",{className:"community__sidebar-title",children:`Contacts (${null===N||void 0===N?void 0:N.length})`}),Object(j.jsx)("div",{className:"community__sidebar-content",children:Object(j.jsx)("div",{className:"community__contacts",children:null===N||void 0===N?void 0:N.map((e=>Object(j.jsx)(vn,{avatarSize:"small",bottomText:"Creator",className:"user",userInfo:e},e.id)))})}),(m===_.info.creatorId||u)&&Object(j.jsxs)("div",{className:"community__sidebar-buttons",children:[Object(j.jsx)(Re,{background:!0,onClick:()=>r(M("change-avatar",{changeAvatarCommunityId:l})),children:"Change avatar"}),Object(j.jsx)(Re,{background:!0,preset:"remove",testId:"delete-community-btn",onClick:B,children:"Delete community"})]})]})]}):Object(j.jsx)(ns,{})}var os=n(26),as=n.n(os),is=n(56),cs=n.n(is);function rs(e){let{index:t,message:n,participants:s,previousMessage:o,selectedMessages:a,selectMessage:i}=e;const c=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),r=0===t||n.authorId!==o.authorId||n.date>o.date+3e5,l=e=>e.stopPropagation();return Object(j.jsxs)("button",{className:Object(u.a)(cs.a.container,a.find((e=>e.id===n.id))&&cs.a.container_selected),onClick:e=>i(e,n),children:[r&&Object(j.jsx)(Se,{onClick:l,size:"small",src:s.find((e=>e.info.id===n.authorId)).info.avatar,userId:n.authorId}),Object(j.jsxs)("div",{className:cs.a.wrapper,children:[r&&Object(j.jsx)(h,{className:"authorInfo",onClick:l,onlyName:!0,text:H(n.date),userInfo:s.find((e=>e.info.id===n.authorId)).info}),Object(j.jsx)(wn,{author:s.find((e=>e.info.id===n.authorId)),className:"userMessage",content:n.content,linkStopPropagation:!0}),n.authorId===c&&Object(j.jsx)("div",{className:cs.a.status,children:n.read?Object(j.jsx)(C.d,{}):Object(j.jsx)(C.D,{})})]})]})}function ls(){const e=Object(i.b)(),{replace:t}=Object(Me.useHistory)(),{search:n}=Object(Me.useLocation)(),a=new URLSearchParams(n).get("interlocutor"),{conversationId:c}=Object(Me.useParams)(),r=Be(),l=we((e=>e.modal.currentModal)),d=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.conversations})),u=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),m=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.info})),b=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.photos})),[f,v]=Object(s.useState)(null),[p,O]=Object(s.useState)(null),[x,g]=Object(s.useState)(),[_,y]=Object(s.useState)([]),{finishLoading:N,loaded:k}=De(),I=Object(s.useRef)(),S=Object(s.useRef)(!1);S.current=!!a||!!(null===d||void 0===d?void 0:d["conversation"+c]);const $=Object(s.useRef)([]),E=()=>$.current.forEach((e=>e())),T=Object(s.useCallback)((()=>{window.innerHeight<document.body.offsetHeight&&window.scrollTo(0,document.body.offsetHeight)}),[]);Object(s.useEffect)((()=>(null===f||void 0===f?void 0:f.info.id)&&setTimeout(T,0)),[null===f||void 0===f?void 0:f.info.id,T]);const L=Object(s.useCallback)((()=>{v(null),O(null),g([]),!k.current&&N()}),[N,k]);Object(s.useEffect)((()=>{!c&&!a&&L()}),[c,L,a]),Object(s.useEffect)((()=>void 0===u&&r()),[r,u]);const P=Object(s.useCallback)((e=>{u&&(I.current=le({callback:t=>{!k.current&&N("Conversation");const n=`conversations/conversation${e.info.id}/`,s=e.messages.reduce(((e,t)=>(t.read||t.authorId===u||(e[`${n}messages/${t.id}/read`]=w),e)),{}),{lastMessage:a}=e.info;(null===a||void 0===a?void 0:a.content)&&!a.read&&a.authorId!==u&&(s[`${n}info/lastMessage/read`]=w),ie().update(s),Object(o.unstable_batchedUpdates)((()=>{v(e),O(t),g([t,{info:m,photos:b}])}))},fields:["connections","info","photos"],userId:e.info.participants.find((e=>e!==u))}))}),[N,k,u,m,b]),R=Object(s.useCallback)((e=>{const t=Object.values({...d}),n=[];$.current=[];const s=()=>{if(n.length===t.length&&!n.includes(void 0)){E();for(const s of n)if(s.includes(u)&&s.includes(a||(null===p||void 0===p?void 0:p.info.id)))return void e(t[n.indexOf(s)]);e()}};t.forEach(((e,t)=>{$.current.push(ie(`conversations/conversation${e}/info/participants`).on((e=>{n[t]=e,s()})))})),!t.length&&s()}),[null===p||void 0===p?void 0:p.info.id,a,d,u]);Object(s.useEffect)((()=>E),[null===p||void 0===p?void 0:p.info.id,a,d,u]),Object(s.useEffect)((()=>{if(!c&&a&&u){if(u!==a)return R((e=>{e?t("/conversation"+e):P({info:{creationTime:null,id:"0",lastMessage:null,participants:[u,a]},messages:[]})})),I.current;L()}}),[R,L,c,P,t,a,u]),Object(s.useEffect)((()=>{if(!c||!u)return;if(!S.current)return void N();const e=ie("conversations/conversation"+c).on((e=>{var t;null===(t=I.current)||void 0===t||t.call(I),e?(e.messages=Object.values({...e.messages}).sort(((e,t)=>e.date-t.date)),P(e)):L()}));return()=>{var t;e(),null===(t=I.current)||void 0===t||t.call(I)}}),[L,c,P,N,d,u]);function D(e,t){if(_.find((e=>e.id===t.id))){const e=[..._];e.splice(_.indexOf(t),1),y(e)}else if(e.shiftKey){const e=f.messages,n=e.indexOf(t),s=e.indexOf(_[_.length-1]),o=[..._];for(let t=Math.min(s+1,n);t<Math.max(n+1,s);t++)!_.find((n=>n.id===e[t].id))&&o.push(e[t]);y(o)}else y([..._,t])}return Object(s.useEffect)((()=>{const e=e=>{"Escape"!==e.key||l||y([])};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)}),[l]),null===u||!x&&S.current?null:void 0!==u&&p&&x&&S.current?Object(j.jsx)("section",{className:as.a.container,children:Object(j.jsx)(Ve,{children:Object(j.jsxs)("div",{className:as.a.wrapper,children:[Object(j.jsx)("div",{className:as.a.header,children:Object(j.jsxs)("div",{className:as.a.header_wrapper,children:[Object(j.jsxs)("div",{className:as.a.header_interlocutor,children:[Object(j.jsx)(Se,{size:"small",src:p.info.avatar,userId:p.info.id}),Object(j.jsx)(h,{className:"authorInfo",text:K(p),userInfo:p.info})]}),_.length>0&&Object(j.jsxs)("div",{className:as.a.header_overlay,children:[Object(j.jsxs)("button",{className:as.a.header_overlay_qty,onClick:()=>y([]),children:[Object(j.jsx)("span",{className:as.a.header_overlay_qty_icon,children:"\xd7"}),Q("message",_.length)]}),Object(j.jsxs)("div",{className:as.a.header_overlay_buttons,children:[Object(j.jsx)(Re,{afterIcon:C.w,className:as.a.header_overlay_button,ariaLabel:"Copy messages to clipboard",onClick:function(){navigator.clipboard.writeText([..._].sort(((e,t)=>e.date-t.date)).reduce(((e,t)=>e+((t.content.text||"")+" ")),"").trim()).then((()=>e(F("Text copied to clipboard.",C.w))))}}),Object(j.jsx)(Re,{afterIcon:C.F,className:as.a.header_overlay_button,ariaLabel:"Delete messages",onClick:function(){const t=_.map((e=>e.id)),n=f.messages.filter((e=>!t.includes(e.id)));_.find((e=>e.authorId!==u))?e(M("action-error",{actionError:"You can't delete someone else's messages. Try to select only your own messages and try again."})):e(M("action-confirm",{actionConfirm:{callback:()=>{y([]);const t=`conversations/conversation${c}/`,s={[t+"info/lastMessage"]:n[n.length-1]||{date:f.info.lastMessage.date}};_.forEach((e=>s[`${t}messages/${e.id}`]=null)),ie().update(s).then((()=>e(F(_.length+" message(s) deleted.",C.F))))},irreversible:!0,text:`Are you sure you want to delete ${Q("message",_.length)}?`}}))}})]})]})]})}),Object(j.jsx)("div",{className:as.a.content,children:f.messages.map(((e,t)=>Object(j.jsx)(rs,{index:t,message:e,participants:x,previousMessage:f.messages[t-1],selectedMessages:_,selectMessage:D},e.id)))}),Object(j.jsx)("div",{className:as.a.footer,children:Object(j.jsx)("div",{className:as.a.footer_wrapper,children:Object(j.jsx)(Xt,{avatar:m.avatar,buttonText:"Message",inputPlaceholder:"Your message",mobileSubmit:!0,uploadCallback:e=>new Promise((n=>{function s(s,o){const i=ie().newKey(),r={authorId:u,content:e,date:w,id:i},l=e=>`users/user${e}/conversations/conversation${s}`,d=`conversations/conversation${s}/`;ie().update(o?{"contentData/nextConversationId":`${parseInt(s,10)+1}`,["conversations/conversation"+s]:{info:{creationTime:w,id:s,lastMessage:r,participants:x.map((e=>e.info.id))},messages:{[i]:r}},[l(u)]:s,[l(a)]:s}:{[d+"info/lastMessage"]:r,[d+"messages/"+i]:r}).then((()=>{(o||c!==s)&&t("/conversation"+s),n(),T()}))}"0"===f.info.id?R((e=>{e?s(e):ie("contentData/nextConversationId").once((e=>s(e,!0)))})):s(f.info.id)})),userId:u})})})]})})}):Object(j.jsx)(ns,{})}function ds(e){let{fetchedItems:t,friendId:n,friendRequestDate:o,loadingCallback:a}=e;const[i,c]=Object(s.useState)();return Object(s.useEffect)((()=>le({callback:e=>{c(e),t.current.incrementQty(n,a)},fields:["connections","info"],userId:n})),[t,n,a]),i?Object(j.jsx)(Cn,{requestDate:o,singleUser:i}):null}var us=n(65),ms=n.n(us);function bs(){const{search:e}=Object(Me.useLocation)(),{ownerId:t}=Object(Me.useParams)(),n=new URLSearchParams(e).get("tab"),o=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),a=we((e=>{var t,n;return null===(t=e.user)||void 0===t||null===(n=t.friendRequests)||void 0===n?void 0:n.received})),[i,r]=Object(s.useState)(),[l,d]=Object(s.useState)(!1),u=Object(s.useRef)(""),{fetchedItems:m,finishLoading:b,loaded:h,setTitle:f}=De(),v=Object(s.useCallback)((()=>b(u.current)),[b]);if(Object(s.useEffect)((()=>{if(null!==o)return le({callback:r,fields:["friends","info"],userId:t||o})}),[m,t,o]),Object(s.useEffect)((()=>{(null===i||void 0===i?void 0:i.info.id)?(u.current=i.info.id===o?"requests"===n?"My friend requests":"My friends":`${i.info.name} ${i.info.lastName}'s friends`,h.current&&f(u.current),l||d(!0),m.current.setExpected(Object.keys("requests"===n?{...a}:{...i.friends}).length,v)):null===i&&(d(!0),b())}),[m,b,i,h,v,n,f,l,a,o]),!l)return null;if(!i)return Object(j.jsx)(ns,{});const p=Object.values({...i.friends}),O=Object.values({...a}),x=i.info.id===o&&"requests"===n;return Object(j.jsxs)("section",{className:ms.a.container,children:[Object(j.jsxs)(Ve,{children:[Object(j.jsx)("div",{className:ms.a.header,children:Object(j.jsx)(c.b,{className:ms.a.title,to:"/id"+i.info.id,children:x?`Your friend requests (${O.length})`:`${i.info.id!==o?`${i.info.name}'s`:"Your"} friends (${p.length})`})}),(x?O:p).length>0&&Object(j.jsx)("div",{className:"usersList",children:(x?O:p).map((e=>Object(j.jsx)(ds,{fetchedItems:m,friendId:e.userId,friendRequestDate:e.date,loadingCallback:v},e.userId)))})]}),i.info.id===o&&Object(j.jsx)(rn,{items:[{text:`Friends (${p.length})`,to:"/friends"},{text:`Friend requests (${O.length})`,to:"?tab=requests"}]})]})}var js=n(33),hs=n.n(js);let fs;function vs(){const e=Object(i.b)(),{replace:t}=Object(Me.useHistory)(),{search:n}=Object(Me.useLocation)(),o=new URLSearchParams(n).get("from"),a=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),{formState:{errors:c},handleSubmit:r,register:l}=Object(We.a)(),{AsyncButton:d,buttonLoadingRef:u,setButtonLoading:m}=qe(),[b,h]=Object(s.useState)(!1);if(Object(s.useEffect)((()=>{a?t(o||"/news"):void 0===a&&(document.title="Log in | Social App")}),[o,t,a]),void 0!==a)return null;const f={errors:c,label:!0,placeholder:!0,register:l};return Object(j.jsx)("section",{className:hs.a.section,children:Object(j.jsx)(Ve,{className:hs.a.contentWidth,children:Object(j.jsxs)("div",{className:hs.a.wrapper,children:[Object(j.jsxs)("div",{className:hs.a.info,children:[Object(j.jsx)("h1",{className:hs.a.info_title,children:"Social App"}),Object(j.jsx)("p",{className:hs.a.info_text,children:"Connect with your friends and communities on Social App."})]}),Object(j.jsxs)("div",{className:hs.a.content,children:[Object(j.jsxs)(et,{noValidate:!0,onChange:()=>m(!1),onSubmit:r((function(t){var n;u.current||(m(),null===(n=fs)||void 0===n||n(),fs=ie("users").orderByChild("account/email").equalTo(t.email).on((n=>{if(fs(),u.current){if(n){const s=Object.values(n)[0];(null===s||void 0===s?void 0:s.account.email)===t.email&&x(s.account.password)===t.password?(re("users/user"+s.account.id),e(Oe(s)),e(vt())):h(!0)}else h(!0);m(!1)}})))})),children:[Object(j.jsx)(Ct,{autoFocus:!0,id:"index-email",onInput:()=>h(!1),opts:{obj:Ke.find((e=>"email"===e.id)),...f}}),Object(j.jsx)(Ct,{id:"index-password",onInput:()=>h(!1),opts:{obj:Ke.find((e=>"existingPassword"===e.id)),...f}}),b&&Object(j.jsx)("p",{className:"error-text",children:"Wrong email or password."}),Object(j.jsx)(d,{testId:"log-in-btn",type:"submit",children:"Log in"})]}),Object(j.jsx)(Re,{className:hs.a.content_forgot,onClick:()=>e(F("Not available.",C.m)),children:"Forgot password?"}),Object(j.jsx)("hr",{className:hs.a.content_hr}),Object(j.jsx)(Re,{background:!0,className:hs.a.content_signup,preset:"secondary",testId:"index-signup",onClick:()=>e(M("sign-up")),children:"Sign up"})]})]})})})}var ps=n(71),Os=n.n(ps),xs=n(44),gs=n.n(xs);function _s(e){var t;let{conversation:n,fetchedItems:o,loadingCallback:a}=e;const i=we((e=>{var t,n;return null===(t=e.user)||void 0===t||null===(n=t.info)||void 0===n?void 0:n.avatar})),c=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),[r,l]=Object(s.useState)();return Object(s.useEffect)((()=>le({callback:e=>{l(e.info),o.current.incrementQty(e.info.id,a)},userId:n.participants.find((e=>e!==c))})),[n.participants,o,a,c]),r?Object(j.jsx)("div",{className:gs.a.item,children:Object(j.jsx)(vn,{bottomText:n.lastMessage&&H(n.lastMessage.date,!0),childrenBottom:(null===(t=n.lastMessage)||void 0===t?void 0:t.content)?Object(j.jsxs)("div",{className:gs.a.lastMessage,children:[!n.lastMessage.read&&Object(j.jsx)(C.y,{className:gs.a.lastMessage_unread}),Object(j.jsx)("img",{className:gs.a.lastMessage_avatar,src:n.lastMessage.authorId===c?i:r.avatar,alt:"Avatar"}),Object(j.jsx)("p",{className:gs.a.lastMessage_content,children:n.lastMessage.content.text||"Photo"})]}):Object(j.jsx)("p",{className:gs.a.noMessages,children:"No messages yet"}),className:"user",userInfo:r,wrapperLink:"/conversation"+n.id})}):null}function ys(){const e=Be(),t=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.conversations})),n=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),[o,a]=Object(s.useState)(),{fetchedItems:i,finishLoading:c}=De(),r=Object(s.useCallback)((()=>c("Messages")),[c]);return Object(s.useEffect)((()=>{if(!n)return;if(!t)return r(),void a([]);const e=Object.values({...t}),s=[],o=[];return e.forEach(((t,n)=>{s[n]=ie(`conversations/conversation${t}/info`).on((t=>{o[n]=t,o.includes(void 0)||o.length!==e.length||(a(o.sort(((e,t)=>t.lastMessage.date-e.lastMessage.date))),i.current.setExpected(e.length,r))}))})),()=>s.forEach((e=>e()))}),[i,r,t,n]),Object(s.useEffect)((()=>void 0===n&&e()),[e,n]),void 0!==n&&o?Object(j.jsx)("section",{className:Os.a.container,children:Object(j.jsx)(Ve,{children:o.length?o.map((e=>Object(j.jsx)(_s,{conversation:e,fetchedItems:i,loadingCallback:r},e.id))):Object(j.jsx)("p",{className:Os.a.noContent,children:"No messages"})})}):null}var Ns=n(84),ws=n.n(Ns);function ks(){const{replace:e}=Object(Me.useHistory)(),t=we((e=>{var t,n;return null===(t=e.user)||void 0===t||null===(n=t.info)||void 0===n?void 0:n.avatar})),n=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),[o,a]=Object(s.useState)([]),{fetchedItems:i,finishLoading:c}=De(),r=Object(s.useCallback)((()=>c("News")),[c]);return Object(s.useEffect)((()=>{if(void 0===n&&e("/"),n)return ie("posts").on((e=>{const t=Object.values(e);a(t.sort(((e,t)=>+t.id-+e.id))),i.current.setExpected(t.length,r)}))}),[i,r,e,n]),n&&o.length?Object(j.jsx)("section",{className:ws.a.section,children:Object(j.jsxs)(Ve,{children:[Object(j.jsx)(Xt,{addToPhotosButton:!0,avatar:t,userId:n}),o.map(((e,t)=>Object(j.jsx)(Zt,{fetchedItems:i,index:t,loadingCallback:r,post:e},e.id)))]})}):null}function Is(){const e=Object(i.b)(),{ownerId:t}=Object(Me.useParams)(),n=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),[o,a]=Object(s.useState)([]),[r,l]=Object(s.useState)();Object(s.useEffect)((()=>{if(null!==n)return le({callback:e=>{const t=[];for(const n in null===e||void 0===e?void 0:e.profilePhotos)(null===e||void 0===e?void 0:e.photos)&&t.push(e.photos[n]);a(t.sort(((e,t)=>t.date-e.date))),l(e)},fields:["info","photos","profilePhotos"],userId:t||n})}),[t,n]);const{finishLoading:d,loaded:u,setTitle:m}=De();return Object(s.useEffect)((()=>{const e=t!==n&&t?`${null===r||void 0===r?void 0:r.info.name} ${null===r||void 0===r?void 0:r.info.lastName}'s photos`:"My photos";u.current?m(e):r?d(e):null===r&&d()}),[u,t,r,d,n,m]),void 0===r?null:r?Object(j.jsx)("section",{className:"photos",children:Object(j.jsx)(Ve,{children:Object(j.jsxs)("div",{className:"photos__wrapper",children:[Object(j.jsx)("div",{className:"photos__header",children:Object(j.jsx)(c.b,{className:"photos__title",to:"/id"+r.info.id,children:`${t!==n&&t?`${r.info.name}'s`:"My"} photos (${o.length})`})}),Object(j.jsx)("div",{className:"photos__items",children:o.map(((t,n)=>Object(j.jsx)(c.b,{className:"photos__item",onClick:t=>{e(M("gallery",{gallery:{authorInfo:r.info,content:o,initialSlide:n}})),t.preventDefault()},to:"#javascript",children:Object(j.jsx)("img",{className:"photos__item-img",src:t.src,alt:""})},t.id)))})]})})}):Object(j.jsx)(ns,{})}var Cs=n(85),Ss=n.n(Cs);function $s(){const{postId:e}=Object(Me.useParams)(),[t,n]=Object(s.useState)(),{fetchedItems:o,finishLoading:a}=De(),i=Object(s.useCallback)((()=>a("Post")),[a]);return Object(s.useEffect)((()=>ie("posts/post"+e).on((e=>{e?(n(e),o.current.setExpected(1)):(a(),n(null))}))),[o,a,e]),void 0===t?null:null===t?Object(j.jsx)(ns,{}):Object(j.jsx)("section",{className:Ss.a.container,children:Object(j.jsx)(Ve,{children:Object(j.jsx)(Zt,{fetchedItems:o,loadingCallback:i,post:t,renderComments:!0})})})}function Es(e){var t,n;let{profileOwner:s,profilePhotos:o}=e;const a=Object(i.b)(),{ownerId:r}=Object(Me.useParams)(),l=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),d=we((e=>{var t,n,s;return null===(t=e.user)||void 0===t||null===(n=t.friendRequests)||void 0===n||null===(s=n.received)||void 0===s?void 0:s["user"+r]})),u=we((e=>{var t,n,s;return null===(t=e.user)||void 0===t||null===(n=t.friendRequests)||void 0===n||null===(s=n.sent)||void 0===s?void 0:s["user"+r]}));function m(){a(M("action-confirm",{actionConfirm:{callback:()=>ie().update({[`users/user${r}/friends/user${l}`]:null,[`users/user${l}/friends/user${r}`]:null}).then((()=>a(F("Friend removed.",C.P)))),text:"Are you sure you want to remove this friend?"}}))}const b=Object.values({...s.friends});return Object(j.jsxs)("div",{className:"profile__left",children:[Object(j.jsx)(Te,{avatar:o.current.find((e=>e.src===s.info.avatar)),className:"avatar-gallery",userInfo:s.info}),Object(j.jsx)("div",{className:"profile__left-online-status",children:Object(j.jsx)("p",{className:"profile__left-online-status-text",children:K(s)})}),s.info.deleted?(null===(n=s.friends)||void 0===n?void 0:n["user"+l])&&Object(j.jsx)("div",{className:"profile__left-buttons",children:Object(j.jsx)(Re,{afterIcon:C.P,background:!0,iconStyles:{width:"1.25em"},preset:"remove",onClick:m,children:"Remove friend"})}):Object(j.jsxs)(j.Fragment,{children:[l&&(r!==l?Object(j.jsxs)("div",{className:"profile__left-buttons",children:[(null===(t=s.friends)||void 0===t?void 0:t["user"+l])?Object(j.jsx)(Re,{afterIcon:C.P,background:!0,iconStyles:{width:"1.25em"},preset:"remove",onClick:m,children:"Remove friend"}):d?Object(j.jsx)(Re,{afterIcon:C.Q,background:!0,iconStyles:{width:"1.25em"},onClick:()=>U({reqUserId:r,userId:l}),children:"Accept friend request"}):u?Object(j.jsx)(Re,{afterIcon:C.R,background:!0,iconStyles:{width:"1.25em"},preset:"remove",onClick:function(){const e=`users/user${r}/`;ie().update({[`${e}friendRequests/received/user${l}`]:null,[`users/user${l}/friendRequests/sent/user${r}`]:null,[e+"fullInfo/followerCount"]:Object(p.e)(-1),[e+"notifications/friendRequest"+l]:null}).then((()=>a(F("Friend request cancelled.",C.R))))},children:"Cancel friend request"}):Object(j.jsx)(Re,{afterIcon:C.Q,background:!0,iconStyles:{width:"1.25em"},onClick:function(){const e=`users/user${r}/`;ie().update({[`${e}friendRequests/received/user${l}`]:{date:w,userId:l},[`users/user${l}/friendRequests/sent/user${r}`]:{date:w,userId:r},[e+"fullInfo/followerCount"]:Object(p.e)(1),[e+"notifications/friendRequest"+l]:{date:w,id:l,type:"friendRequest"}}).then((()=>a(F("Friend request sent.",C.Q))))},children:"Add friend"}),Object(j.jsx)(Re,{afterIcon:C.k,background:!0,to:"/conversation?interlocutor="+r,children:"Send message"})]}):Object(j.jsx)("div",{className:"profile__left-buttons",children:Object(j.jsx)(Re,{afterIcon:C.t,background:!0,iconStyles:{width:".75em"},preset:"secondary",onClick:()=>a(M("change-avatar")),children:"Change avatar"})})),Object(j.jsxs)("div",{className:"profile__left-friends",children:[Object(j.jsx)("div",{className:"profile__left-friends-header",children:Object(j.jsx)(c.b,{className:"profile__left-friends-title",to:`/friends${r!==l?r:""}`,children:`Friends (${b.length})`})}),b.length>0&&Object(j.jsx)("div",{className:"profile__left-friends-items",children:b.map((e=>Object(j.jsx)(Ts,{friendId:e.userId},e.userId)))})]})]})]})}function Ts(e){let{friendId:t}=e;const[n,o]=Object(s.useState)();return Object(s.useEffect)((()=>le({callback:e=>o(e.info),userId:t})),[t]),n?Object(j.jsxs)("div",{className:"profile__left-friends-item",children:[Object(j.jsx)(Se,{size:"small",src:n.avatar,userId:t}),Object(j.jsx)(c.b,{className:"profile__left-friends-item-name",to:"/id"+t,children:n.name})]}):null}function Ls(){var e,t,n,o;const a=Object(i.b)(),{ownerId:r}=Object(Me.useParams)(),l=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.admin})),d=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),u=Object(s.useRef)(),m=Object(s.useRef)([]),[b,h]=Object(s.useState)(),[f,v]=Object(s.useState)(),{fetchedItems:p,finishLoading:O,loaded:x,setTitle:g}=De(),_=Object(s.useCallback)((()=>{O((null===f||void 0===f?void 0:f.info.name)+" "+(null===f||void 0===f?void 0:f.info.lastName))}),[O,null===f||void 0===f?void 0:f.info.lastName,null===f||void 0===f?void 0:f.info.name]),y=Object(s.useCallback)((e=>{if(e){if(document.activeElement.blur(),m.current=[],e.profilePhotos){for(const n in e.profilePhotos){var t;(null===(t=e.photos)||void 0===t?void 0:t[n])&&m.current.push(e.photos[n])}m.current.sort(((e,t)=>t.date-e.date))}u.current=ie("posts").orderByChild("authorId").equalTo(r).on((e=>{const t=Object.values({...e});h(t.sort(((e,t)=>+t.id-+e.id))),p.current.setExpected(t.length)}))}else v(null)}),[p,r]);Object(s.useEffect)((()=>{x.current?g((null===f||void 0===f?void 0:f.info.name)+" "+(null===f||void 0===f?void 0:f.info.lastName)):0===(null===b||void 0===b?void 0:b.length)?_():null===f&&O()}),[O,x,_,r,b,f,g,d]),Object(s.useEffect)((()=>{if(null===d)return;const e=le({callback:e=>{var t;null===(t=u.current)||void 0===t||t.call(u),y(e),v(e)},fields:["connections","friends","fullInfo","info","photos","profilePhotos"],userId:r});return()=>{var t;e(),null===(t=u.current)||void 0===t||t.call(u)}}),[r,y,d]);const N=(e,t)=>e&&Object(j.jsxs)("p",{className:"profile__content-info-middle-item",children:[Object(j.jsx)("span",{className:"profile__content-info-middle-item-title",children:t+": "}),Object(j.jsx)("span",{className:"profile__content-info-middle-item-value",children:e})]}),w=e=>{let{link:t,qty:n,renderZero:s,text:o}=e;const a=t?c.b:"div";if(s||n)return Object(j.jsxs)(a,{className:"profile__content-info-footer-item"+(t?" profile__content-info-footer-button":""),to:t,children:[Object(j.jsx)("p",{className:"profile__content-info-footer-item-number",children:n}),Object(j.jsx)("p",{className:"profile__content-info-footer-item-title",children:o})]})};return void 0===f?null:f?Object(j.jsx)("section",{className:"profile",children:Object(j.jsx)(Ve,{children:Object(j.jsxs)("div",{className:"profile__wrapper",children:[Object(j.jsx)(Es,{profileOwner:f,profilePhotos:m}),Object(j.jsxs)("div",{className:"profile__content",children:[Object(j.jsxs)("div",{className:"profile__content-info",children:[Object(j.jsxs)("div",{className:"profile__content-info-header",children:[Object(j.jsxs)("div",{className:"profile__content-info-header-container",children:[Object(j.jsx)("h1",{className:"profile__content-info-header-name",children:`${f.info.name} ${f.info.lastName}`}),r!==d&&!f.info.deleted&&Object(j.jsx)(Et,{bookmarkType:"user",className:"interaction-submenu",itemId:r,children:l&&Object(j.jsx)(Re,{background:!0,onClick:function(){a(M("action-confirm",{actionConfirm:{callback:()=>Y(r),irreversible:!0,password:!0,text:"Are you sure you want to delete this account?"}}))},children:"Delete user"})})]}),Object(j.jsx)(Qe,{classes:{button:"user-status__button",form:"user-status__form"},className:"user-status",databaseRef:`users/user${r}/fullInfo/status`,emptyButtonText:"Set status",field:null===(e=f.fullInfo)||void 0===e?void 0:e.status,ownerId:r,renderInputId:"status"})]}),Object(j.jsxs)("div",{className:"profile__content-info-middle",children:[N((()=>{var e;if(!(null===(e=f.fullInfo)||void 0===e?void 0:e.birthday))return;const t=new Date(f.fullInfo.birthday);return`${t.toLocaleString("en-US",{month:"long"})} ${t.getDate()}, ${t.getFullYear()}`})(),"Birthday"),N(null===(t=f.fullInfo)||void 0===t?void 0:t.country,"Country"),N(null===(n=f.fullInfo)||void 0===n?void 0:n.city,"City")]}),Object(j.jsxs)("div",{className:"profile__content-info-footer",children:[w({qty:null===(o=f.fullInfo)||void 0===o?void 0:o.followerCount,text:"followers"}),w({link:`/photos${r!==d?r:""}`,qty:Object.keys({...f.profilePhotos}).length,text:"photos"}),w({qty:null===b||void 0===b?void 0:b.length,renderZero:!0,text:"posts"})]})]}),!f.info.deleted&&Object(j.jsxs)(j.Fragment,{children:[Object(j.jsxs)("div",{className:"profile__content-photos",children:[Object(j.jsx)(c.b,{className:"profile__content-photos-title",to:`/photos${r!==d?r:""}`,children:"Photos: "+Object.keys({...f.profilePhotos}).length}),m.current.length>0&&Object(j.jsx)("div",{className:"profile__content-photos-container",children:m.current.map(((e,t)=>t<4&&Object(j.jsx)(c.b,{className:"profile__content-photos-img-container",onClick:e=>{a(M("gallery",{gallery:{authorInfo:f.info,content:m.current,initialSlide:t}})),e.preventDefault()},to:"#javascript",children:Object(j.jsx)("div",{className:"profile__content-photos-img-inner-container",children:Object(j.jsx)("img",{className:"profile__content-photos-img",src:e.src,alt:""})})},e.id)))})]}),Object(j.jsxs)("div",{className:"profile__content-posts",children:[Object(j.jsx)("div",{className:"profile__content-posts-header",children:Object(j.jsx)("h3",{className:"profile__content-posts-title",children:"Posts"})}),null===b||void 0===b?void 0:b.map(((e,t)=>Object(j.jsx)(Zt,{fetchedItems:p,index:t,loadingCallback:_,post:e},e.id)))]})]})]})]})})}):Object(j.jsx)(ns,{})}var Ps=n(45),Rs=n.n(Ps);function Ms(){const{push:e}=Object(Me.useHistory)(),{finishLoading:t}=De(),{search:n}=Object(Me.useLocation)(),o=new URLSearchParams(n).get("query"),a=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),[i,c]=Object(s.useState)(),[r,l]=Object(s.useState)(""),d=Object(s.useCallback)((e=>!o||e.toLowerCase().includes(o.toLowerCase())),[o]);return Object(s.useEffect)((()=>{const e=[];let t=!1;return ie("contentData/nextUserId").once((n=>{if(t)return;const s=parseInt(n,10)-1,o=[],a=[];for(let t=0;t<s;t++)e[t]=le({callback:e=>{o[t]||e.info.deleted||!d(e.info.name)&&!d(e.info.lastName)||a.push(e),o[t]=!0,o.length!==s||o.includes(void 0)||c(a.sort(((e,t)=>+e.info.id-+t.info.id)))},fields:["connections","info"],userId:`${t+1}`})})),()=>{t=!0,e.forEach((e=>e()))}}),[d]),Object(s.useEffect)((()=>{i&&t(o?`Search results for ${o}`:"Search")}),[t,i,o]),Object(s.useEffect)((()=>l(o||"")),[o]),Object(s.useEffect)((()=>{const t=setTimeout((()=>{(o||"")!==r&&e(`?query=${encodeURIComponent(r)||""}`)}),250);return()=>clearTimeout(t)}),[e,o,r]),null===a?null:Object(j.jsx)("section",{className:Rs.a.container,children:Object(j.jsx)(Ve,{children:Object(j.jsxs)("div",{className:Rs.a.wrapper,children:[Object(j.jsxs)("div",{className:Rs.a.header,children:[Object(j.jsx)("h1",{className:Rs.a.title,children:`Search users (${null===i||void 0===i?void 0:i.length})`}),Object(j.jsx)(on,{className:Rs.a.searchBar,value:r,onChange:e=>l(e.target.value),onSubmit:e=>e.preventDefault()})]}),(null===i||void 0===i?void 0:i.length)?Object(j.jsx)(Cn,{users:i}):Object(j.jsx)("p",{className:Rs.a.noResults,children:"No results."})]})})})}function Ds(){const{search:e}=Object(Me.useLocation)(),t=new URLSearchParams(e).get("tab"),n=Be(),o=we((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),a=["account","security"].find((e=>e===t))||"information",{finishLoading:i}=De();return Object(s.useEffect)((()=>{void 0===o?n():o&&i("Settings")}),[i,n,o]),o?Object(j.jsxs)("section",{className:"settings",children:[Object(j.jsx)(Ve,{children:Object(j.jsxs)("div",{className:"settings__wrapper",children:[Object(j.jsx)("div",{className:"settings__header",children:Object(j.jsxs)("h1",{className:"settings__title",children:["information"===a&&"Main Information","security"===a&&"Security","account"===a&&"Account"]})}),"information"===a&&Object(j.jsx)(qs,{}),"security"===a&&Object(j.jsx)(As,{}),"account"===a&&Object(j.jsx)(Bs,{})]})}),Object(j.jsx)(rn,{items:[{text:"Information",to:"/settings"},{testId:"settings-security-btn",text:"Security",to:"?tab=security"},{testId:"settings-account-btn",text:"Account",to:"?tab=account"}]})]}):null}function qs(){const e=Object(i.b)(),t=we((e=>e.user.fullInfo)),n=we((e=>e.user.info)),{formState:{errors:s},handleSubmit:o,register:a,reset:c}=Object(We.a)(),{AsyncButton:r,buttonLoadingRef:l,setButtonLoading:d}=qe();const u={errors:s,label:!0,register:a};return Object(j.jsxs)(et,{onSubmit:o((function(t){if(l.current)return;d(),t=W(t);for(const e in t)t[e]||(t[e]=null);const s=`users/user${n.id}/`,o=s+"fullInfo/",a=s+"info/";ie().update({[o+"birthday"]:t.birthday,[o+"city"]:t.city,[o+"country"]:t.country,[a+"gender"]:t.gender,[a+"lastName"]:t.lastName,[a+"name"]:t.name}).then((()=>{e(F("Information saved.",C.l)),d(!1),c()}))})),children:[Ke.filter((e=>["name","lastName"].includes(e.id))).map((e=>Object(j.jsx)(Ct,{opts:{obj:e,defaultValue:n[e.id],...u}},e.id))),Object(j.jsx)(st,{defaultValue:n.gender,register:a}),Ke.filter((e=>["birthday","country","city"].includes(e.id))).map((e=>{var n;return Object(j.jsx)(Ct,{max:null===(n=e.getMax)||void 0===n?void 0:n.call(e).value,min:e.min,opts:{obj:e,defaultValue:null===t||void 0===t?void 0:t[e.id],...u}},e.id)})),Object(j.jsxs)("div",{className:"settings__buttons",children:[Object(j.jsx)(r,{type:"submit",children:"Save"}),Object(j.jsx)(Re,{background:!0,preset:"secondary",onClick:()=>c(),children:"Cancel"})]})]})}function As(){const e=Object(i.b)(),t=we((e=>e.user.account)),n=we((e=>e.user.account.id)),{formState:{errors:o},handleSubmit:a,register:c,reset:r}=Object(We.a)(),{AsyncButton:l,buttonLoadingRef:d,setButtonLoading:u}=qe(),m=Object(s.useRef)(),[b,h]=Object(s.useState)(!1);return Object(j.jsxs)(et,{noValidate:!0,onSubmit:a((function(s){var o;d.current||(u(),null===(o=m.current)||void 0===o||o.call(m),m.current=ie("users").orderByChild("account/email").equalTo(s.email.toLowerCase()).on((o=>{if(m.current(),o&&!o["user"+n])return s.email=t.email,u(!1),void h(!0);ie(`users/user${t.id}/account`).update({email:s.email.toLowerCase(),password:O(s.password,n)}).then((()=>{x(t.password)!==s.password&&G({id:n,password:s.password}),e(F("Security data saved.",C.L)),u(!1),r()}))})))})),children:[Object(j.jsx)(Ct,{onInput:()=>h(!1),opts:{obj:Ke.find((e=>"email"===e.id)),defaultValue:t.email,errors:o,label:!0,register:c}}),b&&Object(j.jsx)("p",{className:"error-text",children:"This email is already used."}),Object(j.jsx)(Ct,{opts:{obj:Ke.find((e=>"password"===e.id)),defaultValue:x(t.password),errors:o,label:!0,register:c}}),Object(j.jsxs)("div",{className:"settings__buttons",children:[Object(j.jsx)(l,{type:"submit",children:"Save"}),Object(j.jsx)(Re,{background:!0,onClick:()=>{r(),h(!1)},preset:"secondary",children:"Cancel"})]})]})}function Bs(){const e=Object(i.b)(),t=we((e=>e.user.account.id));return Object(j.jsxs)(et,{onSubmit:function(n){n.preventDefault(),e(M("action-confirm",{actionConfirm:{callback:()=>{e(P("action-confirm")),setTimeout((()=>{e(xe()),setTimeout((()=>Y(t)),0)}),400)},irreversible:!0,password:!0,text:"Are you sure you want to delete your account?"}}))},children:[Object(j.jsx)("h3",{className:"settings__form-title",children:"Account removal"}),Object(j.jsx)(Re,{background:!0,preset:"remove",type:"submit",children:"Delete account"})]})}n(116);const Fs=()=>document.documentElement.style.setProperty("--page-height",window.innerHeight+"px");function zs(){return window.history.scrollRestoration="manual",Object(j.jsx)(c.a,{children:Object(j.jsx)(i.a,{store:Ne,children:Object(j.jsxs)(a.b.Provider,{value:{style:{flexShrink:0}},children:[Object(j.jsx)(Vn,{}),Object(j.jsx)(Wn,{}),Object(j.jsx)(yt,{}),Object(j.jsx)("main",{className:d.a.main,children:Object(j.jsxs)(xt,{className:d.a.pageWidth,children:[Object(j.jsx)(Bt,{}),Object(j.jsxs)(r.Switch,{loadingScreen:()=>Object(j.jsx)(Pt,{className:d.a.loading}),children:[Object(j.jsx)(r.Route,{path:"/",exact:!0,component:vs}),Object(j.jsx)(r.Route,{path:"/bookmarks",component:Jn,loading:!0}),Object(j.jsx)(r.Route,{path:"/communities",component:Gn,loading:!0}),Object(j.jsx)(r.Route,{path:"/community:communityId",component:ss,loading:!0}),Object(j.jsx)(r.Route,{path:"/conversation",component:ls,loading:!0}),Object(j.jsx)(r.Route,{path:"/friends",component:bs,loading:!0}),Object(j.jsx)(r.Route,{path:"/messages",component:ys,loading:!0}),Object(j.jsx)(r.Route,{path:"/news",component:ks,loading:!0}),Object(j.jsx)(r.Route,{path:"/photos",component:Is,loading:!0}),Object(j.jsx)(r.Route,{path:"/search",component:Ms,loading:!0}),Object(j.jsx)(r.Route,{path:"/settings",component:Ds,loading:!0}),Object(j.jsx)(r.Route,{path:"/conversation:conversationId",component:ls,loading:!0}),Object(j.jsx)(r.Route,{path:"/friends:ownerId",component:bs,loading:!0}),Object(j.jsx)(r.Route,{path:"/photos:ownerId",component:Is,loading:!0}),Object(j.jsx)(r.Route,{path:"/post:postId",component:$s,loading:!0}),Object(j.jsx)(r.Route,{path:"/id:ownerId",component:Ls,loading:!0}),Object(j.jsx)(r.Route,{path:"/",component:ns})]})]})}),Object(j.jsx)(Dt,{}),Object(j.jsx)(tn,{}),Object(j.jsx)(un,{}),Object(j.jsx)(it,{}),Object(j.jsx)(Yn,{})]})})})}Fs(),window.addEventListener("resize",Fs);var Hs=e=>{e&&e instanceof Function&&n.e(3).then(n.bind(null,126)).then((t=>{let{getCLS:n,getFID:s,getFCP:o,getLCP:a,getTTFB:i}=t;n(e),s(e),o(e),a(e),i(e)}))};Object(o.render)(Object(j.jsx)(s.StrictMode,{children:Object(j.jsx)(zs,{})}),document.getElementById("app")),Hs()}],[[117,1,2]]]);