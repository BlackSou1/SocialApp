(this["webpackJsonpreact-project"]=this["webpackJsonpreact-project"]||[]).push([[0],{49:function(e,t,s){},53:function(e,t,s){"use strict";s.r(t);var a=s(1),n=s(19),o=s(4),c=s(2),r=s(12);s(48),s(49);const i=(e,t={})=>({type:"OPEN_MODAL",name:e,opts:t}),l=e=>({type:"CLOSE_MODAL",name:e});var d=s(26),m=s(34);let u;function j(){const e=window.innerWidth-document.body.offsetWidth+"px";u=document.querySelectorAll(".fixed-item"),document.body.style.overflow="hidden",document.body.style.marginRight=e,u.forEach((t=>t.style.paddingRight=e))}function b(){document.body.style.overflow="",document.body.style.marginRight="",u.forEach((e=>e.style.paddingRight=""))}var f=(e=!1,t)=>{switch(t.type){case"OPEN_HAMBURGER":return j(),!0;case"CLOSE_HAMBURGER":return!1;default:return e}};const h={activeModals:[],currentModal:null,gallery:{content:[]},modals:{},zoom:{}};var p=(e=h,t)=>{var s;const a={...e,actionConfirm:{...e.actionConfirm},activeModals:[...e.activeModals],modals:{...e.modals},zoom:{...e.zoom}};switch(t.type){case"OPEN_MODAL":return j(),a.modals[t.name]=!0,a.activeModals.push(t.name),a.currentModal=t.name,a.actionConfirm=t.opts.actionConfirm,a.actionError=t.opts.actionError,t.opts.gallery&&(a.gallery=t.opts.gallery),(null===(s=t.opts.zoom)||void 0===s?void 0:s.img)&&(a.zoom.img=t.opts.zoom.img,a.zoom.alt=t.opts.zoom.alt||""),a;case"CLOSE_MODAL":return a.modals[t.name]=!1,a.activeModals.includes(t.name)&&(a.activeModals.splice(a.activeModals.indexOf(t.name)),a.currentModal=a.activeModals[a.activeModals.length-1]),a;default:return e}};const v={account:{id:null},info:{avatar:"",gender:"",id:"",lastName:"",lastSeen:0,name:""}};var O=(e=v,t)=>{const s=localStorage.getItem("loggedIn");let a;switch(t.type){case"LOG_IN":return a={id:t.user.account.id,password:t.user.account.password},document.cookie=`USER_DATA=${JSON.stringify(a)}; expires=${new Date(Date.now()+31536e6)}`,localStorage.setItem("loggedIn","true"),t.user;case"LOG_OUT":return document.cookie=`USER_DATA=; expires=${new Date}`,localStorage.removeItem("loggedIn"),null;case"LOG_SYNC":return s?t.user:(document.cookie=`USER_DATA=; expires=${new Date}`,null);default:return e}};const _=Object(d.b)({user:O,hamburger:f,modal:p}),x=Object(d.c)(_,Object(d.a)(m.a)),g=o.c;var N=x,y=s(0);function w({children:e,className:t,contentClassName:s,modalName:n,zoomImg:c}){const r=Object(o.b)(),i=g((e=>e.modal)),d=Object(a.useRef)(null),m=Object(a.useRef)(null),u=Object(a.useCallback)((()=>{r(l(n))}),[r,n]);const j=Object(a.useCallback)((e=>{"Escape"===e.key&&i.currentModal===n&&u()}),[u,i.currentModal,n]);Object(a.useEffect)((()=>(window.addEventListener("keydown",j),()=>window.removeEventListener("keydown",j))),[j]);const f=Object(a.useRef)(!1);return Object(y.jsx)("div",{className:i.modals[n]?t+" modal--open":t,ref:d,onMouseDown:function(e){e.target===m.current&&(f.current=!0)},onMouseUp:function(e){f.current&&e.target===m.current&&u(),f.current=!1},onTransitionEnd:function(e){null==i.currentModal&&e.target===d.current&&b()},children:Object(y.jsx)("div",{className:"modal__wrapper",ref:m,children:Object(y.jsxs)("div",{className:s,onClick:e=>e.stopPropagation(),children:[Object(y.jsx)("button",{className:"modal__close","aria-label":"Close modal",onClick:u,children:"\xd7"}),e,c&&Object(y.jsx)("img",{className:"modal-zoom__img",src:i.zoom.img||"#",alt:i.zoom.alt||""})]})})})}var k=s(14),I=s(11);var C=[{id:"name",name:"name",title:"Name",errors:{maxLength:{value:32,message:"A name cannot contain more than 32 characters"},required:"Enter your name"}},{id:"lastName",name:"lastName",title:"Last name",errors:{maxLength:{value:32,message:"A last name cannot contain more than 32 characters"},required:"Enter your last name"}},{id:"country",name:"country",title:"Country",errors:{maxLength:{value:56,message:"A country cannot contain more than 56 characters"}}},{id:"city",name:"city",title:"City",errors:{maxLength:{value:85,message:"A city cannot contain more than 85 characters"}}},{id:"email",name:"email",title:"Email",errors:{maxLength:{value:320,message:"An email cannot contain more than 320 characters"},pattern:{value:/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/,message:"Enter a correct email address!"},required:"Enter an email address"}},{id:"password",name:"password",type:"password",title:"Password",errors:{maxLength:{value:128,message:"A password cannot contain more than 128 characters"},minLength:{value:2,message:"A password must be at least 2 characters long"},pattern:{value:/^[a-zA-Z0-9!"#$%&'()*+,-./:;<=>?@[\\\]^_`{|}~-]*$/,message:"A password can only contain letters (a-z, A-Z), numbers, and symbols !\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~, and cannot contain spaces"},required:"Enter a password"}},{id:"existingPassword",name:"password",type:"password",title:"Password",errors:{maxLength:{value:128,message:"A password cannot contain more than 128 characters"},required:"Enter your password"}},{id:"confirmPassword",name:"password",type:"password",title:"Confirm password",errors:{maxLength:{value:128,message:"A password cannot contain more than 128 characters"},required:"Confirm your password"}},{autoComplete:"off",id:"status",name:"status",title:"Status",errors:{maxLength:{value:80,message:"A status cannot contain more than 80 characters"}}},{id:"title",name:"title",title:"Title",errors:{maxLength:{value:32,message:"A title cannot contain more than 32 characters"},required:"Enter community title"}},{id:"description",name:"text",title:"Description",errors:{maxLength:{value:256,message:"A description cannot contain more than 256 characters"}}},{id:"shortDescription",name:"text",title:"Short description",errors:{maxLength:{value:100,message:"A short description cannot contain more than 100 characters"}}}],D=s(24);s(51),s(54);D.a.initializeApp({apiKey:"AIzaSyBiW6i54kOJNamqNFqxO6ZB78uSGIbRqEM",authDomain:"social-app-bs.firebaseapp.com",databaseURL:"https://social-app-bs-default-rtdb.europe-west1.firebasedatabase.app",projectId:"social-app-bs",storageBucket:"social-app-bs.appspot.com",messagingSenderId:"129896299882",appId:"1:129896299882:web:7bf515fc32dcf9a735f913"});const S=D.a.database(),$=D.a.database.ServerValue.TIMESTAMP,E=D.a.storage(),P=({register:e,userGender:t})=>Object(y.jsxs)("div",{className:"gender",children:[Object(y.jsx)("h4",{className:"gender__title",children:"Gender"}),Object(y.jsx)("div",{className:"gender__items",children:["Male","Female"].map((s=>Object(y.jsxs)("label",{className:"gender__item",children:[Object(y.jsx)("input",{className:"gender__input",defaultChecked:s.toLowerCase()===(t||"male"),type:"radio",value:s.toLowerCase(),...e("gender")}),Object(y.jsx)("p",{className:"gender__text",children:s})]},s)))})]});var R=({opts:{defaultValue:e,errors:t,label:s,labelText:n,obj:o,placeholder:c,register:r},...i})=>{const[l,d]=Object(a.useState)(!1);return Object(y.jsxs)("div",{className:"primary-form__item",children:[s&&Object(y.jsx)("label",{className:"primary-form__label",htmlFor:i.id||o.id,children:n||o.title}),["password","existingPassword"].includes(o.id)?Object(y.jsxs)("div",{className:"primary-form__password",children:[Object(y.jsx)("input",{className:"primary-form__input-password primary-form__input",id:o.id,autoCapitalize:"off",autoComplete:"on",defaultValue:e,placeholder:c?o.title:"",spellCheck:!1,type:l?"text":"password",...i,...r("password",o.errors)}),Object(y.jsx)("button",{className:"primary-form__password-show",type:"button","aria-label":"Toggle password visibility",onClick:()=>d(!l),children:Object(y.jsx)("i",{className:l?"far fa-eye":"far fa-eye-slash"})})]}):Object(y.jsx)("input",{className:"primary-form__input",id:o.id,autoCapitalize:["confirmPassword","email"].includes(o.id)?"off":"on",autoComplete:o.autoComplete||"on",defaultValue:e,placeholder:c?o.title:"",spellCheck:!["confirmPassword","email"].includes(o.id),type:o.type||"text",...i,...r(o.id,o.errors)}),t[o.id]&&Object(y.jsx)("p",{className:"error-text",children:t[o.id].message})]})};function T(e=!0){const[t,s]=Object(a.useState)([]);return{addImgPreview:a=>{const n=[...a.target.files];e||(n.length=1);let o=n.length;a.target.value="";const c=[];n.forEach((e=>{let a,n;["jpg","jpeg","png"].includes(e.name.split(".").pop().toLowerCase())||(n=!0,o--);const r={lastModified:e.lastModified,name:e.name,size:e.size,type:e.type};for(const s of t)if(JSON.stringify(s.props)===JSON.stringify(r)){a=!0,o--;break}if(!a||!n){const a=new FileReader;a.onload=()=>{c.push({props:r,file:e,result:a.result}),c.length===o&&s([...t,...c])},a.readAsDataURL(e)}}))},imgPreview:t,setImgPreview:s}}function L(e,t,s="s"){return`${t} ${e}${1!==t?s:""}`}function A(e,t){const s=new Date(e),a=Date.now()+1e3,n=new Date(a),o=(a-e)/1e3,c=o/60,r=c/60,i=s;return c<1?`${L("second",Math.floor(o))} ago`:r<1?`${L("minute",Math.floor(c))} ago`:r<3&&n.getDate()===s.getDate()?`${L("hour",Math.floor(r))} ago`:r<24&&n.getDate()===s.getDate()?t?"today":`today at ${i.getHours()}:${i.getMinutes()<10?0:""}${i.getMinutes()}`:r<48&&new Date(a-864e5).getDate()===s.getDate()?t?"yesterday":`yesterday at ${i.getHours()}:${i.getMinutes()<10?0:""}${i.getMinutes()}`:n.getFullYear()===s.getFullYear()?t?`${i.toLocaleString("en-US",{month:"long"})} ${i.getDate()}`:`${i.toLocaleString("en-US",{month:"long"})} ${i.getDate()} at ${i.getHours()}:${i.getMinutes()<10?0:""}${i.getMinutes()}`:t?`${i.toLocaleString("en-US",{month:"long"})} ${i.getDate()} ${i.getFullYear()}`:`${i.toLocaleString("en-US",{month:"long"})} ${i.getDate()} ${i.getFullYear()} at ${i.getHours()}:${i.getMinutes()<10?0:""}${i.getMinutes()}`}function M(e,t){if(e)return(e=e.trim()).length>t&&(e=e.slice(0,t)),e}function q(e){for(const t in e)e[t]=M(e[t]);return e}const F=({reqUserID:e,userID:t})=>{S.ref(`users/user${e}/friendRequests/sent/user${t}`).remove(),S.ref(`users/user${t}/friendRequests/received/user${e}`).remove(),S.ref(`users/user${e}/friends/user${t}`).set({friendAddDate:$,userID:t}),S.ref(`users/user${t}/friends/user${e}`).set({friendAddDate:$,userID:e})},U=({posts:e,userID:t})=>{S.ref("users/user"+t).update({account:{deleted:!0,id:t},bookmarks:null,connections:null,info:{avatar:"img/user-deleted.svg",deleted:!0,id:t,lastName:"account",name:"Deleted"},photos:null,profilePhotos:null}),e.map((e=>S.ref("posts/post"+e.id).remove()))},H=e=>e.info.deleted?"This user account has been removed":e.connections?"Online":"Last seen "+A(e.info.lastSeen),z=({condition:e,contentID:t,contentRef:s,history:a,userID:n,userRef:o})=>{if(!n)return void a.push("/");const c=S.ref(s),r=S.ref(o);e?(c.remove(),r.remove()):(c.set({date:$,userID:n}),r.set({commentID:t}))},B=({callback:e,communityID:t,e:s,imgPreview:a,inputText:n,setImgPreview:o,userID:c})=>{if("keypress"===s.type&&("Enter"!==s.key||s.shiftKey))return;const r=M(n.current,5e3),i=a,l=[];if(s.preventDefault(),s.target.closest("form").reset(),n.current=null,o([]),i.length||r){i.length||d();const e=({id:e,index:t})=>{l[t]=e,l.length!==i.length||l.includes(void 0)||d()};i.forEach(((s,a)=>Y({addToPhotos:s.addToPhotos,callback:e,communityID:t,file:s.file,index:a,userID:c})))}function d(){const t=l.map((e=>({type:"img",value:e})));r&&t.unshift({type:"text",value:r}),e(t)}},G=(e,t,s,a)=>{if(!s)return void t.push("/");const n=`communities/community${e}/subscribers/user${s}`;a?S.ref(n).remove():S.ref(n).set({date:$,userID:s})},Y=({addToPhotos:e,callback:t,communityID:s,createID:a=!0,file:n,imgPath:o="photos",index:c,storagePrefix:r="",userID:l})=>{const d=a?S.ref().push().key:o,m=E.ref("img/"+(r?r+"_":"")+d).put(n);m.on("state_changed",(()=>0),(()=>N.dispatch(i("action-error",{actionError:"Failed to load image to our database. Try again."}))),(()=>m.snapshot.ref.getDownloadURL().then((n=>new Promise((()=>{const r=s?"communities/community"+s:"/users/user"+l;S.ref(`${r}/${o}${a?"/"+d:""}`).set({date:$,id:a?d:null,src:n}),e&&S.ref(`${r}/profilePhotos/${d}`).set({id:d}),null===t||void 0===t||t({id:d,index:c,link:n})}))))))};function V({addToPhotosHandler:e,imgPreview:t,removeOnClick:s}){const a=Object(o.b)();return Object(y.jsxs)("div",{className:"upload-preview",children:[Object(y.jsxs)("div",{className:"upload-preview__header",children:[Object(y.jsx)("button",{className:"upload-preview__header-remove",type:"button",onClick:s,children:"\xd7"}),Object(y.jsx)("button",{className:"upload-preview__header-img-container",type:"button",onClick:()=>a(i("zoom",{zoom:{img:t.result,alt:""}})),children:Object(y.jsx)("img",{className:"upload-preview__header-img",src:t.result,alt:""})})]}),Object(y.jsx)("div",{className:"upload-preview__footer",children:Object(y.jsxs)("div",{className:"upload-preview__footer-wrapper",children:[Object(y.jsx)("h4",{className:"upload-preview__title upload-preview__footer-item",children:t.props.name}),e&&Object(y.jsxs)("label",{className:"upload-preview__checkbox upload-preview__footer-item",children:[Object(y.jsx)("input",{className:"upload-preview__checkbox-input",type:"checkbox",name:"checkbox",onChange:e}),Object(y.jsx)("p",{className:"upload-preview__checkbox-text",children:"Add to my photos"})]})]})})]})}const Q=({avatar:e,owner:t})=>{const s=Object(o.b)();return["img/community-default.svg","img/community-deleted.svg","img/user-default.svg","img/user-deleted.svg"].includes(t.info.avatar)?Object(y.jsx)("div",{className:"avatar-gallery-btn--default",children:Object(y.jsx)("img",{className:"avatar-gallery-btn__img",src:t.info.avatar,alt:"Avatar"})}):Object(y.jsx)(c.b,{className:"avatar-gallery-btn",to:"#javascript",onClick:a=>{s(i("gallery",{gallery:{author:t,content:[e],initialSlide:0}})),a.preventDefault()},children:Object(y.jsx)("img",{className:"avatar-gallery-btn__img",src:t.info.avatar,alt:"Avatar"})})},J=({afterIconClass:e,beforeIconClass:t,className:s="",href:a,preset:n="primary",onClick:o,text:r,to:i,type:l="submit"})=>{const d=e=>e&&Object(y.jsx)("i",{className:(s&&s+"__icon ")+n+"-button__icon button__icon "+e}),m=a?"a":i?c.b:"button";return Object(y.jsxs)(m,{className:(s&&s+" ")+n+"-button button",href:a,to:i,type:"button"===m?l:null,onClick:o,children:[d(t),Object(y.jsx)("p",{className:(s&&s+"__text ")+n+"-button__text button__text",children:r}),d(e)]})},K=({className:e,databaseRef:t,emptyButtonText:s,emptyFieldText:n,field:o,ownerID:c,renderInputId:r})=>{const{formState:{errors:i},handleSubmit:l,register:d,reset:m}=Object(k.a)(),u=g((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),[j,b]=Object(a.useState)(!1);return Object(y.jsx)("div",{className:(e?e+" ":"")+"editable-field",children:c===u?j?Object(y.jsxs)("form",{className:(e?e+"__form ":"")+"editable-field__form",action:"#",method:"post",onSubmit:l((function(e){S.ref(t).set(e[r].trim()||null),b(!1)})),children:[Object(y.jsx)(R,{autoFocus:!0,opts:{obj:C.find((e=>e.id===r)),defaultValue:o,errors:i,placeholder:!0,register:d}}),Object(y.jsxs)("div",{className:(e?e+"__form-buttons ":"")+"editable-field__form-buttons",children:[Object(y.jsx)(J,{text:"Save"}),Object(y.jsx)(J,{preset:"secondary",text:"Cancel",type:"button",onClick:()=>b(!1)})]})]}):Object(y.jsxs)("button",{className:(e?e+"__button ":"")+"editable-field__button",onClick:()=>{b(!0),m()},children:[Object(y.jsx)("i",{className:(e?e+"__icon ":"")+"editable-field__icon fas fa-edit"}),Object(y.jsx)("p",{className:(e?e+"__text ":"")+"editable-field__text",children:o||s})]}):Object(y.jsx)("p",{className:(e?e+"__text ":"")+"editable-field__text",children:o||n})})},W=({addImgPreview:e})=>Object(y.jsxs)("label",{className:"form-photo",htmlFor:"form-photo__input",children:[Object(y.jsx)("button",{className:"form-photo__button",type:"button",onClick:e=>e.target.closest("label").click(),"aria-label":"Photo",children:Object(y.jsx)("i",{className:"form-photo__icon fas fa-camera"})}),Object(y.jsx)("input",{className:"form-photo__input",id:"form-photo__input",type:"file",accept:".jpg, .jpeg, .png",multiple:!0,hidden:!0,onChange:e})]}),Z=({bookmarkedItems:e,bookmarkRef:t,children:s,itemID:a})=>{const n=Object(I.useHistory)(),o=g((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id}));return Object(y.jsxs)("div",{className:"interaction-submenu",children:[Object(y.jsx)("div",{className:"interaction-submenu__icon",tabIndex:0,children:Object(y.jsx)("i",{className:"fas fa-chevron-down"})}),Object(y.jsxs)("div",{className:"interaction-submenu__wrapper",children:[Object(y.jsx)(J,{text:((null===e||void 0===e?void 0:e[a])?"Remove from":"Add to")+" bookmarks",onClick:()=>(({bmID:e,bmRef:t,history:s,userBmItems:a,userID:n})=>{if(!n)return void s.push("/");const o=S.ref(`users/user${n}/bookmarks/${t}/${e}`);(null===a||void 0===a?void 0:a[e])?o.remove():o.set({date:$,id:e})})({bmID:a,bmRef:t,history:n,userBmItems:e,userID:o})}),s]})]})},X=({avatar:e,communityID:t,userID:s})=>{const{addImgPreview:n,imgPreview:o,setImgPreview:r}=T(),i=Object(a.useRef)();function l(e){B({callback:e=>{S.ref("contentData/nextPostID").once("value",(a=>{const n={authorID:s||null,communityID:t||null,content:e,date:$,id:a.val(),shares:0};S.ref("posts/post"+a.val()).set(n),S.ref("contentData/nextPostID").set(`${parseInt(a.val(),10)+1}`)}))},communityID:t,e:e,imgPreview:o,inputText:i,setImgPreview:r,userID:s})}return Object(y.jsxs)("div",{className:"post-publish",children:[Object(y.jsx)(c.b,{className:"post-publish__avatar",to:t?"/community"+t:"/id"+s,children:Object(y.jsx)("img",{className:"post-publish__avatar-img",src:e,alt:"Avatar"})}),Object(y.jsxs)("form",{className:"post-publish__form",action:"#",method:"post",onSubmit:l,children:[Object(y.jsx)("textarea",{className:"post-publish__form-input",placeholder:"Share your thoughts...",maxLength:5e3,onKeyPress:l,onChange:e=>i.current=e.target.value}),Object(y.jsxs)("div",{className:"post-publish__form-footer",children:[Object(y.jsxs)("div",{className:"post-publish__form-footer-inputs",children:[Object(y.jsx)(W,{addImgPreview:n}),Object(y.jsx)(J,{text:"Post"})]}),Object(y.jsx)("div",{className:"upload-previews",children:o.map(((e,t)=>Object(y.jsx)(V,{addToPhotosHandler:e=>(({e:e,i:t,imgPreview:s,setImgPreview:a})=>{a(s.map(((s,a)=>(a===t&&(s.addToPhotos=e.target.checked),s))))})({e:e,i:t,imgPreview:o,setImgPreview:r}),imgPreview:e,removeOnClick:()=>r(o.filter((t=>t.result!==e.result)))},t)))})]})]})]})},ee=({id:e="search-bar",onChange:t,onSubmit:s,value:a})=>Object(y.jsxs)("form",{className:"search-bar",action:"#",method:"post",onSubmit:s,children:[Object(y.jsx)("input",{className:"search-bar__input primary-form__input",id:e,type:"text",name:"search",placeholder:"Search...",value:a,onChange:t}),Object(y.jsx)("label",{className:"search-bar__label",htmlFor:e,children:Object(y.jsx)("i",{className:"search-bar__icon fas fa-search"})})]});function te(){const e=Object(o.b)(),t=g((e=>e.modal.actionConfirm)),s=g((e=>e.modal.activeModals)),n=g((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.password})),{formState:{errors:c},handleSubmit:r,register:i,reset:d}=Object(k.a)(),m=Object(a.useRef)(!1),[u,j]=Object(a.useState)(!1);function b(s){s.password&&n!==s.password?j(!0):(e(l("action-confirm")),null===t||void 0===t||t.callback())}return Object(a.useEffect)((()=>{!m.current&&s.includes("action-confirm")?(m.current=!0,j(!1),d()):m.current=!1}),[s,d]),Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)("div",{className:"modal-action-confirm__header",children:Object(y.jsx)("h4",{className:"modal-action-confirm__title",children:"Confirm action"})}),Object(y.jsxs)("div",{className:"modal-action-confirm__wrapper",children:[Object(y.jsx)("p",{className:"modal-action-confirm__text",children:null===t||void 0===t?void 0:t.text}),(null===t||void 0===t?void 0:t.password)&&Object(y.jsxs)("form",{className:"primary-form",action:"#",method:"post",autoComplete:"off",onSubmit:r(b),children:[Object(y.jsx)(R,{id:"modal-action-confirm__form-input",onInput:()=>j(!1),opts:{obj:C.find((e=>"existingPassword"===e.id)),errors:c,label:!0,labelText:"Enter your password to continue",placeholder:!0,register:i}}),u&&Object(y.jsx)("p",{className:"error-text",children:"Wrong password."})]}),Object(y.jsxs)("div",{className:"modal-action-confirm__buttons",children:[Object(y.jsx)(J,{afterIconClass:"fas fa-check",preset:"secondary",text:"Yes",onClick:r(b)}),Object(y.jsx)(J,{afterIconClass:"fas fa-times",preset:"remove",text:"No",onClick:()=>e(l("action-confirm"))})]})]})]})}function se(){const e=Object(o.b)(),t=g((e=>e.modal.actionError));return Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)("div",{className:"modal-action-error__header",children:Object(y.jsx)("h4",{className:"modal-action-error__title",children:"Error"})}),Object(y.jsxs)("div",{className:"modal-action-error__wrapper",children:[Object(y.jsx)("p",{className:"modal-action-error__text",children:t}),Object(y.jsx)("div",{className:"modal-action-error__buttons",children:Object(y.jsx)(J,{afterIconClass:"fas fa-check",text:"OK",onClick:()=>e(l("action-error"))})})]})]})}function ae(){const e=Object(o.b)(),t=g((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),{addImgPreview:s,imgPreview:a,setImgPreview:n}=T(!1);return a.length?Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(V,{imgPreview:a[0],removeOnClick:()=>n([])}),Object(y.jsx)(J,{afterIconClass:"fas fa-check",className:"set-button",preset:"secondary",text:"Set as avatar",onClick:function(){e(l("change-avatar")),setTimeout((()=>n([])),300),Y({addToPhotos:!0,file:a[0].file,userID:t,callback:({link:e})=>{S.ref(`/users/user${t}/info/avatar`).set(e)}})}})]}):Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(J,{afterIconClass:"fas fa-images",text:"Choose an existing photo",onClick:()=>e(i("choose-photo"))}),Object(y.jsxs)("label",{className:"modal-change-avatar__upload",htmlFor:"modal-change-avatar__upload-input",children:[Object(y.jsx)(J,{afterIconClass:"fas fa-upload",preset:"secondary",text:"Upload photo",onClick:e=>{var t;return null===(t=e.target.closest("label"))||void 0===t?void 0:t.click()}}),Object(y.jsx)("input",{className:"modal-change-avatar__upload-input",id:"modal-change-avatar__upload-input",type:"file",accept:".jpg, .jpeg, .png",hidden:!0,onChange:s})]})]})}function ne(){const e=Object(o.b)(),t=g((e=>e.modal.activeModals)),s=g((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),n=g((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.photos})),c=g((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.profilePhotos})),r=Object(a.useRef)(!1),[i,d]=Object(a.useState)();return Object(a.useEffect)((()=>{const e=[];Object.keys({...c}).forEach((t=>e.push(null===n||void 0===n?void 0:n[t]))),e.includes(void 0)||(e.sort(((e,t)=>t.date-e.date)),d(e))}),[n,c]),t.includes("choose-photo")&&(r.current=!0),r.current?Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)("div",{className:"photos__header",children:Object(y.jsx)("h4",{className:"photos__title",children:`Your photos (${null===i||void 0===i?void 0:i.length})`})}),Object(y.jsx)("div",{className:"photos__items",children:Object(y.jsx)("div",{className:"photos__items-wrapper",children:null===i||void 0===i?void 0:i.map((t=>Object(y.jsx)("button",{className:"photos__item",onClick:()=>{return a=t.src,S.ref(`/users/user${s}/info/avatar`).set(a),e(l("choose-photo")),void e(l("change-avatar"));var a},children:Object(y.jsx)("div",{className:"photos__item-wrapper",children:Object(y.jsx)("img",{className:"photos__item-img",src:t.src,alt:""})})},t.id)))})})]}):null}function oe(){const e=Object(o.b)(),{formState:{errors:t},handleSubmit:s,register:a}=Object(k.a)(),n=g((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id}));return Object(y.jsxs)("form",{className:"primary-form",action:"#",method:"post",onSubmit:s((function(t){t=q(t),e(l("create-community")),S.ref("contentData/nextCommunityID").once("value",(e=>{const s={avatar:"img/community-default.svg",creationTime:$,creatorID:n,id:e.val(),...t};S.ref("communities/community"+e.val()).set(s),S.ref("contentData/nextCommunityID").set(`${parseInt(e.val(),10)+1}`)}))})),children:[C.filter((e=>["title","description","shortDescription"].includes(e.id))).map((e=>Object(y.jsx)(R,{opts:{obj:e,errors:t,placeholder:!0,register:a}},e.id))),Object(y.jsx)(J,{text:"Create community"})]})}var ce=s(59),re=s(56),ie=s(57),le=s(60),de=s(58);function me(){const e=Object(o.b)(),t=g((e=>e.modal.gallery)),s=g((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.admin})),n=g((e=>{var t,s;return null===(t=e.user)||void 0===t||null===(s=t.info)||void 0===s?void 0:s.avatar})),r=g((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),d=g((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.profilePhotos})),m=Object(a.useRef)(null),u=Object(a.useRef)(null),[j,b]=Object(a.useState)(),[f,h]=Object(a.useState)();function p(){e(l("gallery"))}return Object(a.useEffect)((()=>{j&&f&&(j.params.navigation.prevEl=m.current,j.params.navigation.nextEl=u.current,j.controller.control=f,f.controller.control=j)}),[j,f]),Object(a.useEffect)((()=>{j&&(j[t.content.length>1?"enable":"disable"](),j.update(),j.slideToLoop(t.initialSlide,0))}),[t,j]),t.author?Object(y.jsxs)(y.Fragment,{children:[Object(y.jsxs)(le.a,{className:"gallery-swiper__container",autoHeight:!0,navigation:{prevEl:m.current,nextEl:u.current},onBeforeInit:e=>{e.params.navigation.prevEl=m.current,e.params.navigation.nextEl=u.current},onSwiper:b,speed:600,children:[t.content.map((a=>Object(y.jsxs)(de.a,{className:"gallery-swiper__slide",children:[Object(y.jsx)("div",{className:"modal-gallery__img-container",children:Object(y.jsx)("img",{className:"modal-gallery__img",src:a.src,alt:""})}),Object(y.jsxs)("div",{className:"modal-gallery__info",children:[Object(y.jsxs)("div",{className:"modal-gallery__info-header",children:[Object(y.jsx)(c.b,{className:"modal-gallery__info-avatar",to:"/id"+t.author.info.id,onClick:p,children:Object(y.jsx)("img",{className:"modal-gallery__info-avatar-img",src:t.author.info.avatar,alt:"Avatar"})}),Object(y.jsxs)("div",{className:"modal-gallery__info-text",children:[Object(y.jsx)(c.b,{className:"modal-gallery__info-author",to:"/id"+t.author.info.id,onClick:p,children:`${t.author.info.name} ${t.author.info.lastName}`}),Object(y.jsx)(c.b,{className:"modal-gallery__info-date",to:"#todo",children:A(a.date)})]})]}),r===t.author.info.id&&a.src!==n&&(null===d||void 0===d?void 0:d[a.id])&&Object(y.jsx)(J,{beforeIconClass:"fas fa-user-circle",preset:"secondary",text:"Set as avatar",onClick:()=>{return e=a.src,S.ref(`/users/user${r}/info/avatar`).set(e),void p();var e}}),(r===t.author.info.id||s)&&Object(y.jsx)(J,{beforeIconClass:"fas fa-trash-alt",preset:"remove",text:"Delete photo",onClick:()=>function(s){const a=t.author.info.title,n=a?"communities/community":"users/user";e(i("action-confirm",{actionConfirm:{text:"Are you sure you want to delete this photo? This action is irreversible!",callback:()=>{S.ref(`${n+t.author.info.id}/photos/${s.id}`).remove(),S.ref(`${n+t.author.info.id}/profilePhotos/${s.id}`).remove(),E.ref("img/"+s.id).delete(),t.author.info.avatar===s.src&&S.ref(`${n+t.author.info.id}/${a?"":"info/"}avatar`).set(a?"img/community-default.svg":"img/user-default.svg"),p()}}}))}(a)})]})]},a.id))),Object(y.jsx)("button",{className:"gallery-swiper__button-prev swiper-button-prev",ref:m,children:Object(y.jsx)("i",{className:"fas fa-chevron-left"})}),Object(y.jsx)("button",{className:"gallery-swiper__button-next swiper-button-next",ref:u,children:Object(y.jsx)("i",{className:"fas fa-chevron-right"})})]}),Object(y.jsx)(le.a,{className:"gallery-thumbs__container",breakpoints:{768:{slidesPerView:6}},centeredSlides:!0,onSwiper:h,slidesPerView:4,slideToClickedSlide:!0,spaceBetween:10,speed:600,children:t.content.map((e=>Object(y.jsx)(de.a,{className:"gallery-thumbs__slide",children:Object(y.jsx)("button",{className:"gallery-thumbs__slide-button",children:Object(y.jsx)("img",{className:"gallery-thumbs__slide-img",src:e.src,alt:""})})},e.id)))})]}):null}function ue(e,t){const s=S.ref(e),a=s.on("value",(e=>t(e.val())));return()=>s.off("value",a)}function je({callback:e,fields:t=["info"],userID:s}){const a={},n=[],o=t.map((e=>{const t=e.split("/");return t[t.length-1]}));return t.forEach(((t,c)=>{n.push(ue(`users/user${s}/${t}`,(t=>{a[o[c]]=t,o.map((e=>a[e])).includes(void 0)||e(a.info?a:null)})))})),()=>n.forEach((e=>e()))}ce.a.use([re.a,ie.a]);const be=e=>({type:"LOG_IN",user:e}),fe=e=>({type:"LOG_SYNC",user:e});let he,pe,ve,Oe;var _e=()=>e=>{var t,s;null===(t=pe)||void 0===t||t.off("value",ve),null===(s=Oe)||void 0===s||s(),document.cookie.split(";").forEach((t=>{try{he=JSON.parse(t.replace("USER_DATA=",""))}catch(s){return void e(fe(null))}""!==he.id?(pe=S.ref(`users/user${he.id}/account`),ve=pe.orderByValue().equalTo(he.password).on("value",(t=>{t.val()?Oe=je({fields:["account","bookmarks","friendRequests","info","photos","profilePhotos"],userID:he.id,callback:t=>{var s;(null===t||void 0===t?void 0:t.account.deleted)?e({type:"LOG_OUT"}):t?(e(fe(t)),(null===t||void 0===t||null===(s=t.account.preferences)||void 0===s?void 0:s.darkTheme)?localStorage.setItem("darkTheme","true"):localStorage.removeItem("darkTheme"),document.documentElement.classList[localStorage.getItem("darkTheme")?"add":"remove"]("dark")):e({type:"LOG_OUT"})}}):e(fe(null))}))):e(fe(null))}))};let xe,ge;function Ne(){const e=Object(o.b)(),{formState:{errors:t},handleSubmit:s,register:n}=Object(k.a)(),[c,r]=Object(a.useState)({});return Object(y.jsxs)("form",{className:"primary-form",action:"#",method:"post",onSubmit:s((function(t){var s;t=q(t),null===(s=xe)||void 0===s||s.off("value",ge),xe=S.ref("users/"),ge=xe.orderByChild("account/email").equalTo(t.email).on("value",(s=>{xe.off("value",ge);const a=function(e){const t={...c};return e.password!==e.confirmPassword&&(t.wrongPassword=!0),r(t),t}(t);s.val()&&(r({...a,emailExists:!0}),a.emailExists=!0),Object.values(a).includes(!1)||(e(l("sign-up")),S.ref("contentData/nextUserID").once("value",(s=>{t.confirmPassword=null;const a={account:{email:t.email,id:s.val(),password:t.password,preferences:{darkTheme:!!localStorage.getItem("darkTheme")||null},registrationTime:$},info:{avatar:"img/user-default.svg",gender:t.gender,id:s.val(),lastName:t.lastName,lastSeen:$,name:t.name}};S.ref("users/user"+s.val()).set(a),S.ref("contentData/nextUserID").set(`${parseInt(s.val(),10)+1}`),setTimeout((()=>{e(be(a)),e(_e())}),300)})))}))})),children:[C.filter((e=>["name","lastName"].includes(e.id))).map((e=>Object(y.jsx)(R,{opts:{obj:e,errors:t,placeholder:!0,register:n}},e.id))),Object(y.jsx)(P,{register:n}),Object(y.jsx)(R,{onInput:()=>r({...c,emailExists:!1}),opts:{obj:C.find((e=>"email"===e.id)),errors:t,placeholder:!0,register:n}}),c.emailExists&&Object(y.jsx)("p",{className:"error-text",children:"This email is already used."}),C.filter((e=>["password","confirmPassword"].includes(e.id))).map((e=>Object(y.jsx)(R,{onInput:()=>r({...c,wrongPassword:!1}),opts:{obj:e,errors:t,placeholder:!0,register:n}},e.id))),c.wrongPassword&&Object(y.jsx)("p",{className:"error-text",children:"Wrong confirm password."}),Object(y.jsx)(J,{text:"Sign up"})]})}function ye(){const e=g((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id}));return Object(y.jsxs)("div",{className:"modals",children:[!e&&Object(y.jsx)(w,{className:"modal-sign-up modal",modalName:"sign-up",contentClassName:"modal-sign-up__content modal__content",children:Object(y.jsx)(Ne,{})}),e&&Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(w,{className:"modal-create-community modal",modalName:"create-community",contentClassName:"modal-create-community__content modal__content",children:Object(y.jsx)(oe,{})}),Object(y.jsx)(w,{className:"modal-change-avatar modal",modalName:"change-avatar",contentClassName:"modal-change-avatar__content modal__content",children:Object(y.jsx)(ae,{})}),Object(y.jsx)(w,{className:"modal-choose-photo modal",modalName:"choose-photo",contentClassName:"modal-choose-photo__content modal__content",children:Object(y.jsx)(ne,{})})]}),Object(y.jsx)(w,{className:"modal-gallery modal",modalName:"gallery",contentClassName:"modal-gallery__content modal__content",children:Object(y.jsx)(me,{})}),Object(y.jsx)(w,{className:"modal-action-confirm modal",modalName:"action-confirm",contentClassName:"modal-action-confirm__content modal__content",children:Object(y.jsx)(te,{})}),Object(y.jsx)(w,{className:"modal-action-error modal",modalName:"action-error",contentClassName:"modal-action-error__content modal__content",children:Object(y.jsx)(se,{})}),Object(y.jsx)(w,{zoomImg:!0,className:"modal-zoom modal",modalName:"zoom",contentClassName:"modal-zoom__content modal__content"})]})}function we(){const e=Object(o.b)(),t=g((e=>e.hamburger)),s=g((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),[n,r]=Object(a.useState)(!0),i=Object(a.useRef)(null),l=Object(a.useCallback)((()=>{r(!1),e({type:"CLOSE_HAMBURGER"})}),[e]);const d=Object(a.useCallback)((e=>{"Escape"===e.key&&t&&l()}),[l,t]);return Object(a.useEffect)((()=>(window.addEventListener("keydown",d),()=>window.removeEventListener("keydown",d))),[d]),s?Object(y.jsx)("div",{className:"hamburger"+(!n||t?" hamburger--open":""),onClick:l,children:Object(y.jsx)("div",{className:"hamburger__wrapper"+(t?" hamburger__wrapper--open":""),ref:i,onClick:e=>e.stopPropagation(),onTransitionEnd:function(e){t||e.target!==i.current||(r(!0),b())},children:Object(y.jsxs)("nav",{className:"hamburger__nav",children:[Object(y.jsx)(c.b,{className:"hamburger__nav-link",to:"/id"+s,onClick:l,children:"My Profile"}),Object(y.jsx)(c.b,{className:"hamburger__nav-link",to:"/news",onClick:l,children:"News"}),Object(y.jsx)(c.b,{className:"hamburger__nav-link",to:"/messages",onClick:l,children:"Messages"}),Object(y.jsx)(c.b,{className:"hamburger__nav-link",to:"/friends",onClick:l,children:"Friends"}),Object(y.jsx)(c.b,{className:"hamburger__nav-link",to:"/communities",onClick:l,children:"Communities"}),Object(y.jsx)(c.b,{className:"hamburger__nav-link",to:"/bookmarks",onClick:l,children:"Bookmarks"}),Object(y.jsx)(c.b,{className:"hamburger__nav-link",to:"/search",onClick:l,children:"Search"})]})})}):null}function ke(){const[e,t]=Object(a.useState)("scroll-to-top__button");return Object(a.useEffect)((()=>{const e=setInterval((()=>{t("scroll-to-top__button"+(window.pageYOffset<window.innerHeight?" scroll-to-top__button--hidden":""))}),100);return()=>clearInterval(e)}),[]),Object(y.jsx)("div",{className:"scroll-to-top",children:Object(y.jsx)("div",{className:"page-width",children:Object(y.jsx)("div",{className:"scroll-to-top__wrapper",children:Object(y.jsx)("button",{className:e,"aria-label":"Scroll to top",onClick:function(){document.body.scrollIntoView({behavior:"smooth",block:"start"})},children:Object(y.jsx)("i",{className:"fas fa-chevron-up"})})})})})}function Ie(){return Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)("footer",{className:"footer",children:Object(y.jsx)("div",{className:"page-width"})}),Object(y.jsx)(we,{}),Object(y.jsx)(ye,{}),Object(y.jsx)(ke,{})]})}const Ce=Object(a.createContext)(null);function De({opts:e={},...t}){let{openState:s,setOpenState:n,submenuClass:o,tag:c}=e;const r=c||a.Fragment;"string"!==typeof o&&(o="submenu");const[i,l]=Object(a.useState)(!1);null!=s&&n||([s,n]=[i,l]);const d=Object(a.useRef)();return Object(y.jsx)(Ce.Provider,{value:{buttonRef:d,openState:s,setOpenState:n,submenuClass:o},children:Object(y.jsx)(r,{...t})})}function Se({Tag:e,...t}){const{buttonRef:s,openState:n,setOpenState:o,submenuClass:c}=Object(a.useContext)(Ce);return Object(y.jsx)(e,{...t,ref:s,className:t.className+(n?` ${c}__button--open`:""),onClick:()=>o(!n)})}function $e({Tag:e="div",...t}){const{buttonRef:s,openState:n,setOpenState:o,submenuClass:c}=Object(a.useContext)(Ce),r=Object(a.useRef)(),i=Object(a.useCallback)((e=>{!s.current||s.current.contains(e.target)||r.current.contains(e.target)||o(!1)}),[s,o]);return Object(a.useEffect)((()=>(window.addEventListener("click",i),()=>window.removeEventListener("click",i))),[i]),Object(y.jsx)(e,{...t,ref:r,className:t.className+(n?` ${c}__wrapper--open`:"")})}function Ee(){const e=Object(o.b)(),t=Object(I.useHistory)(),s=g((e=>{var t,s,a;return null===(t=e.user)||void 0===t||null===(s=t.account)||void 0===s||null===(a=s.preferences)||void 0===a?void 0:a.darkTheme})),n=g((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),r=g((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.info})),i=Object(a.useRef)(),[l,d]=Object(a.useState)("true"===localStorage.getItem("darkTheme")),[m,u]=Object(a.useState)(!1);function j(){if(n){s?(S.ref(`users/user${n}/account/preferences/darkTheme`).remove(),localStorage.removeItem("darkTheme"),d(!1)):(S.ref(`users/user${n}/account/preferences/darkTheme`).set(!0),localStorage.setItem("darkTheme","true"),d(!0))}else{const e=document.documentElement;localStorage.getItem("darkTheme")?(localStorage.removeItem("darkTheme"),e.classList.remove("dark"),d(!1)):(localStorage.setItem("darkTheme","true"),e.classList.add("dark"),d(!0))}}return Object(a.useEffect)((()=>{if(localStorage.getItem("darkTheme")){document.body.style.transitionDuration="0s",document.documentElement.classList.add("dark");document.body.scrollHeight;document.body.style.transitionDuration=""}}),[]),Object(a.useEffect)((()=>{d(n?!0===s:"true"===localStorage.getItem("darkTheme"))}),[s,n]),Object(y.jsx)("header",{className:"header fixed-item",children:Object(y.jsx)("div",{className:"page-width",children:Object(y.jsxs)("div",{className:"header__wrapper",children:[Object(y.jsx)(c.b,{className:"header__logo",to:n?"/news":"/","aria-label":"Homepage",children:"Social App"}),Object(y.jsxs)("div",{className:"header__right",children:[Object(y.jsx)(ee,{id:"header__search-bar",onChange:e=>i.current=e.target.value,onSubmit:function(e){e.preventDefault(),t.push("/search?query="+(i.current||""))}}),void 0===n&&Object(y.jsx)("label",{className:"change-theme"+(l?" change-theme--checked":""),children:Object(y.jsxs)("div",{className:"change-theme__wrapper",children:[Object(y.jsx)("input",{className:"change-theme__input",type:"checkbox","aria-label":"Toggle dark theme",checked:l,onChange:j}),Object(y.jsx)("i",{className:"change-theme__icon fas fa-cloud-moon"})]})}),n&&Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)("div",{className:"header__user",children:Object(y.jsxs)(De,{opts:{openState:m,setOpenState:u},children:[Object(y.jsxs)(Se,{Tag:"button",className:"header__user-button",children:[Object(y.jsx)("p",{className:"header__user-button-name",children:r.name}),Object(y.jsx)("img",{className:"header__user-button-avatar",src:r.avatar,alt:"Avatar"}),Object(y.jsx)("i",{className:"header__user-button-icon fas fa-chevron-down"})]}),Object(y.jsxs)($e,{className:"header__user-submenu submenu__wrapper",children:[Object(y.jsx)("label",{className:"change-theme"+(l?" change-theme--checked":""),children:Object(y.jsxs)("div",{className:"change-theme__wrapper",children:[Object(y.jsx)("input",{className:"change-theme__input",type:"checkbox","aria-label":"Toggle dark theme",checked:l,onChange:j}),Object(y.jsx)("i",{className:"change-theme__icon fas fa-cloud-moon"})]})}),Object(y.jsx)(c.b,{className:"header__user-submenu-button",to:"/settings",onClick:()=>u(!1),children:"Settings"}),Object(y.jsx)("button",{className:"header__user-submenu-button",onClick:()=>{u(!1),e({type:"LOG_OUT"}),e(_e()),t.push("/")},children:"Log out"})]})]})}),Object(y.jsx)("button",{className:"header__hamburger","aria-label":"Open navigation",onClick:()=>e({type:"OPEN_HAMBURGER"}),children:Object(y.jsx)("i",{className:"fas fa-bars"})})]})]})]})})})}function Pe(){const e=Object(o.b)(),t=g((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id}));Object(a.useEffect)((()=>{if(!t)return;const e="/users/user"+t;let s;const a=ue(".info/connected",(t=>{var a;t&&(null===(a=s)||void 0===a||a.remove(),s=S.ref(e+"/connections").push(),s.set(!0),s.onDisconnect().remove(),S.ref(e+"/info/lastSeen").onDisconnect().set($))}));return()=>{s.remove(),S.ref(e+"/info/lastSeen").onDisconnect().cancel(),S.ref(e+"/info/lastSeen").set($),a()}}),[e,t]);const s=Object(a.useCallback)((()=>{e(_e())}),[e]);return Object(a.useEffect)((()=>(s(),window.addEventListener("storage",s),()=>window.removeEventListener("storage",s))),[s]),null}var Re=Object(a.memo)((()=>{const e=g((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id}));return e?Object(y.jsx)("nav",{className:"navigation",children:Object(y.jsxs)("div",{className:"navigation__wrapper",children:[Object(y.jsxs)(c.b,{className:"navigation__link",to:"/id"+e,children:[Object(y.jsx)("i",{className:"navigation__link-icon fas fa-user-circle"}),Object(y.jsx)("p",{className:"navigation__link-text",children:"My Profile"})]}),Object(y.jsxs)(c.b,{className:"navigation__link",to:"/news",children:[Object(y.jsx)("i",{className:"navigation__link-icon fas fa-newspaper"}),Object(y.jsx)("p",{className:"navigation__link-text",children:"News"})]}),Object(y.jsxs)(c.b,{className:"navigation__link",to:"/messages",children:[Object(y.jsx)("i",{className:"navigation__link-icon fas fa-comment"}),Object(y.jsx)("p",{className:"navigation__link-text",children:"Messages"})]}),Object(y.jsxs)(c.b,{className:"navigation__link",to:"/friends",children:[Object(y.jsx)("i",{className:"navigation__link-icon fas fa-user-friends"}),Object(y.jsx)("p",{className:"navigation__link-text",children:"Friends"})]}),Object(y.jsxs)(c.b,{className:"navigation__link",to:"/communities",children:[Object(y.jsx)("i",{className:"navigation__link-icon fas fa-users"}),Object(y.jsx)("p",{className:"navigation__link-text",children:"Communities"})]}),Object(y.jsxs)(c.b,{className:"navigation__link",to:"/bookmarks",children:[Object(y.jsx)("i",{className:"navigation__link-icon fas fa-bookmark"}),Object(y.jsx)("p",{className:"navigation__link-text",children:"Bookmarks"})]})]})}):null}));function Te(){const e=g((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id}));return Object(a.useEffect)((()=>document.title="404 Not Found | Social App"),[]),Object(y.jsx)("section",{className:"error-404",children:Object(y.jsxs)("div",{className:"page-width",style:e?{}:{justifyContent:"center"},children:[Object(y.jsx)(Re,{}),Object(y.jsx)("div",{className:"content-width",children:Object(y.jsxs)("div",{className:"error-404__wrapper",children:[Object(y.jsx)("p",{className:"error-404__number",children:"404"}),Object(y.jsx)("h2",{className:"error-404__title",children:"Not Found"}),Object(y.jsx)("p",{className:"error-404__text",children:"The requested page was not found on our server. It may have been removed."})]})})]})})}const Le=Object(a.createContext)(null);function Ae(e){const{loadItem:t,opts:s}=Object(a.useContext)(Le),n=Object(a.useRef)(),o=Object(a.useRef)(),c=Object(a.useRef)(!1),[r,i]=Object(a.useState)({src:"#",alt:""}),l=Object(a.useCallback)((()=>{window.removeEventListener("load",d),window.removeEventListener("resize",d),window.removeEventListener("scroll",d),clearInterval(n.current)}),[]),d=Object(a.useCallback)((()=>{if(!o.current)return;const t=o.current,a=t.getBoundingClientRect().top+window.pageYOffset+s.scrollOffset-window.innerHeight;window.pageYOffset>=a&&t.offsetParent&&"hidden"!==getComputedStyle(t).visibility&&(c.current=!0,i({src:e.src,alt:e.alt||""}),l())}),[l,s.scrollOffset,e.alt,e.src]);return Object(a.useEffect)((()=>(c.current||(d(),window.addEventListener("load",d),window.addEventListener("resize",d),window.addEventListener("scroll",d),s.autoCheck&&(n.current=setInterval(d,s.autoCheckInterval))),l)),[l,d,s.autoCheck,s.autoCheckInterval]),Object(y.jsx)("img",{ref:o,...e,...r,onLoad:t})}var Me=function({opts:e={},tag:t="div",...s}){const n=t,o="string"===typeof e.animationClass?" "+e.animationClass:" lazy-animation";e.autoCheck="boolean"!==typeof e.autoCheck||e.autoCheck,e.autoCheckInterval=Number.isInteger(e.autoCheckInterval)?e.autoCheckInterval:2e3,e.scrollOffset=Number.isInteger(e.scrollOffset)?e.scrollOffset:0;const[c,r]=Object(a.useState)(!1),i=Object(a.useCallback)((()=>r(!0)),[]);return Object(y.jsx)(Le.Provider,{value:{loadItem:i,opts:e},children:Object(y.jsx)(n,{...s,className:s.className+(c?"":o)})})};function qe({author:e,content:t,lazyLoadEnabled:s,linkStopPropagation:n,msgIndex:r,renderReplyToAuthorText:l}){const d=Object(o.b)(),m=t.filter((e=>"img"===e.type)).map((t=>Object.values({...e.photos}).find((e=>e.id===t.value)))),u=m.filter((e=>e));return Object(y.jsx)("div",{className:"user-message",children:t.map(((t,o)=>{var j;return Object(y.jsx)(a.Fragment,{children:"text"===t.type?l?l(t,!0):Object(y.jsx)("p",{className:"user-message__text user-message__item",children:t.value}):Object(y.jsxs)(y.Fragment,{children:[l&&0===o&&l(t),m.find((e=>(null===e||void 0===e?void 0:e.id)===t.value))?!s||r<4?Object(y.jsx)(c.b,{className:"user-message__img-container user-message__item",to:"#javascript",onClick:s=>{d(i("gallery",{gallery:{author:e,content:u,initialSlide:u.indexOf(u.find((e=>e.id===t.value)))}})),s.preventDefault(),n&&s.stopPropagation()},children:Object(y.jsx)("img",{className:"user-message__img",src:null===(j=m.find((e=>(null===e||void 0===e?void 0:e.id)===t.value)))||void 0===j?void 0:j.src,alt:""})}):Object(y.jsx)(Me,{opts:{scrollOffset:-1e3},tag:c.b,className:"user-message__img-container user-message__item",to:"#javascript",onClick:s=>{d(i("gallery",{gallery:{author:e,content:m,initialSlide:m.indexOf(m.find((e=>e.id===t.value)))}})),s.preventDefault()},children:Object(y.jsx)(Ae,{className:"user-message__img",src:m.find((e=>e.id===t.value)).src,alt:""})}):Object(y.jsx)("p",{className:"user-message__deleted-photo user-message__item",children:"Deleted photo"})]})},o)}))})}function Fe({post:e}){const{hash:t}=Object(I.useLocation)(),s=g((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.info.avatar})),n=g((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),{addImgPreview:o,imgPreview:r,setImgPreview:i}=T(),l=Object(a.useRef)(),d=Object(a.useRef)(null),[m,u]=Object(a.useState)(null),[j,b]=Object(a.useState)();function f({commentID:t,e:s,replyText:a,replyToID:o,tempImgPreview:c,tempSetImgPreview:d}){B({callback:s=>{const a=S.ref().push().key;S.ref(`posts/post${e.id}/comments${t?`/${t}/replies`:""}/${a}`).set({authorID:n,content:s,date:$,id:a,replyTo:o||null}),setTimeout((()=>u(null)),0)},e:s,imgPreview:c||r,inputText:a||l,setImgPreview:d||i,userID:n})}Object(a.useEffect)((()=>{"#comments"===t&&setTimeout((()=>{var e;return null===(e=d.current)||void 0===e?void 0:e.scrollIntoView({behavior:"auto",block:"start"})}),0)}),[t]);const h=Object.values({...e.comments}).sort(((e,t)=>t.date-e.date));return Object(y.jsx)("div",{ref:d,className:"post__comments-container",children:Object(y.jsxs)("div",{className:"post__comments",children:[Object(y.jsx)("div",{className:"post__comments-title",children:`Comments (${h.length})`}),Object(y.jsx)("div",{className:"post__comments-wrapper",children:h.map((t=>Object(y.jsx)(Ue,{comment:t,handleSubmit:f,postID:e.id,replyComment:m,selectedReply:j,setReplyComment:u,setSelectedReply:b},t.id)))}),n&&Object(y.jsxs)("div",{className:"post__comments-form-container",children:[Object(y.jsx)(c.b,{className:"post__comments-form-avatar",to:"/id"+n,children:Object(y.jsx)("img",{className:"post__comments-form-avatar-img",src:s,alt:""})}),Object(y.jsxs)("form",{className:"post__comments-form",action:"#",method:"post",onSubmit:e=>f({e:e}),children:[Object(y.jsx)("textarea",{className:"post__comments-form-input",placeholder:"Leave a comment...",maxLength:5e3,onKeyPress:e=>f({e:e}),onChange:e=>l.current=e.target.value}),Object(y.jsxs)("div",{className:"post__comments-form-footer",children:[Object(y.jsx)(W,{addImgPreview:o}),Object(y.jsx)(J,{text:"Comment"})]}),Object(y.jsx)("div",{className:"upload-previews",children:r.map(((e,t)=>Object(y.jsx)(V,{imgPreview:e,removeOnClick:()=>i(r.filter((t=>t.result!==e.result)))},t)))})]})]})]})})}function Ue({comment:e,handleSubmit:t,postID:s,replyComment:n,selectedReply:r,setReplyComment:l,setSelectedReply:d}){const m=Object(o.b)(),u=Object(I.useHistory)(),j=g((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.admin})),b=g((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.info.avatar})),f=g((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),{addImgPreview:h,imgPreview:p,setImgPreview:v}=T(),O=Object(a.useRef)(),[_,x]=Object(a.useState)(),[N,w]=Object(a.useState)([]),[k,C]=Object(a.useState)([]);function D(s){t({commentID:e.id,e:s,replyText:O,replyToID:n.reply.id,tempImgPreview:p,tempSetImgPreview:v})}Object(a.useEffect)((()=>{const t=Object.values({...e.replies});w(t)}),[e.replies]),Object(a.useEffect)((()=>{const t=je({fields:["info","photos"],userID:e.authorID,callback:e=>x(e)}),s=[],a=[];return N.forEach(((e,t)=>{s.push(je({fields:["info","photos"],userID:e.authorID,callback:e=>{a[t]=e,a.length!==N.length||a.includes(void 0)||C([...a])}}))})),()=>{t(),s.forEach((e=>e()))}}),[e.authorID,N]);const $=({replies:t,replyLikes:a,replyTo:o,tempAuthor:x,tempComment:g})=>Object(y.jsxs)("div",{className:"post__comment",children:[Object(y.jsx)(c.b,{className:"post__comment-avatar",to:"/id"+g.authorID,children:Object(y.jsx)("img",{className:"post__comment-avatar-img",src:x.info.avatar,alt:"Avatar"})}),Object(y.jsxs)("div",{className:"post__comment-wrapper"+(g.id===r?" post__comment-wrapper--selected":""),children:[Object(y.jsxs)("div",{className:"post__comment-header",children:[Object(y.jsx)(c.b,{className:"post__comment-header-name",to:"/id"+g.authorID,children:`${x.info.name} ${x.info.lastName}`}),Object(y.jsx)("p",{className:"post__comment-header-date",children:A(g.date)})]}),Object(y.jsx)(qe,{author:x,content:g.content,renderReplyToAuthorText:(e,t)=>{var s;return Object(y.jsxs)("p",{className:"user-message__text user-message__item",children:[o&&Object(y.jsxs)(c.b,{className:"user-message__reply-to",to:"/id"+o.info.id,children:[Object(y.jsx)("span",{className:"user-message__reply-to-name",children:null===(s=k.find((e=>{var t;return e.info.id===(null===(t=N.find((e=>e.id===g.replyTo)))||void 0===t?void 0:t.authorID)})))||void 0===s?void 0:s.info.name}),", "]}),t&&e.value]})}}),Object(y.jsxs)("div",{className:"post__comment-footer",children:[Object(y.jsxs)("button",{className:"post__comment-footer-button",onClick:(n,o=!t&&g.id)=>z({condition:!!(a||E).find((e=>e.userID===f)),contentID:e.id,contentRef:`posts/post${s}/comments/${e.id+(o?`/replies/${o}`:"")}/likes/user${f}`,history:u,userID:f,userRef:`users/user${f}/likes/comments/post${s}/${o?`reply${o}`:`comment${e.id}`}`}),children:[Object(y.jsx)("i",{className:"post__comment-footer-button-icon"+((a||E).find((e=>e.userID===f))?" fas fa-heart":" far fa-heart")}),Object(y.jsx)("p",{className:"post__comment-footer-button-text",children:(a||E).length||0})]}),Object(y.jsxs)("button",{className:"post__comment-footer-button",onClick:()=>{return t=g,void(f?l({author:k.find((e=>e.info.id===t.authorID))||_,commentID:e.id,reply:t}):u.push("/"));var t},children:[Object(y.jsx)("i",{className:"post__comment-footer-button-icon fas fa-reply"}),Object(y.jsx)("p",{className:"post__comment-footer-button-text",children:"reply"})]}),(x.info.id===f||j)&&Object(y.jsxs)("button",{className:"post__comment-footer-delete-button",onClick:()=>function(t){const a=S.ref(`posts/post${s}/comments/${e.id}`+(t?"/replies/"+t:""));m(i("action-confirm",{actionConfirm:{text:"Are you sure you want to delete this comment? This action is irreversible!",callback:()=>a.remove()}}))}(t?"":g.id),children:[Object(y.jsx)("i",{className:"post__comment-footer-delete-button-icon fas fa-trash-alt"}),Object(y.jsx)("p",{className:"post__comment-footer-delete-button-text",children:"Delete"})]})]}),(null===t||void 0===t?void 0:t.length)>0&&Object(y.jsx)("div",{className:"post__comment-replies",children:t}),(null===n||void 0===n?void 0:n.commentID)===e.id&&t&&Object(y.jsxs)("div",{className:"post__comments-form-container",children:[Object(y.jsx)(c.b,{className:"post__comments-form-avatar",to:"/id"+f,children:Object(y.jsx)("img",{className:"post__comments-form-avatar-img",src:b,alt:""})}),Object(y.jsxs)("form",{className:"post__comments-form",action:"#",method:"post",onSubmit:D,children:[Object(y.jsxs)("button",{className:"post__comments-form-reply-to",type:"button",onClick:()=>{return e=n.reply.id,d(e),void setTimeout((()=>d(null)),0);var e},children:[Object(y.jsxs)("p",{className:"post__comments-form-reply-to-text",children:["reply to"," ",n.author.info.name+" "+n.author.info.lastName]}),Object(y.jsx)("i",{className:"post__comments-form-reply-to-icon fas fa-level-up-alt"})]}),Object(y.jsx)("textarea",{className:"post__comments-form-input",placeholder:"Leave a comment...",maxLength:5e3,onChange:e=>O.current=e.target.value,onKeyPress:D}),Object(y.jsxs)("div",{className:"post__comments-form-footer",children:[Object(y.jsx)(W,{addImgPreview:h}),Object(y.jsx)(J,{text:"Reply"})]}),Object(y.jsx)("div",{className:"upload-previews",children:p.map(((e,t)=>Object(y.jsx)(V,{imgPreview:e,removeOnClick:()=>v(p.filter((t=>t.result!==e.result)))},t)))})]})]})]})]},g.id),E=Object.values({...e.likes}),P=[];return N.forEach((e=>P.push(Object.values({...e.likes})))),_?$({tempAuthor:_,tempComment:e,replies:N.map(((e,t)=>k[t]&&$({tempAuthor:k[t],tempComment:e,replyTo:k.find((t=>{var s;return t.info.id===(null===(s=N.find((t=>t.id===e.replyTo)))||void 0===s?void 0:s.authorID)})),replyLikes:P[t]})))}):null}function He({fetchedItems:e,index:t=0,loadingCallback:s,post:n,renderComments:r}){var l;const d=Object(o.b)(),m=Object(I.useHistory)(),u=g((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.admin})),j=g((e=>{var t,s;return null===(t=e.user)||void 0===t||null===(s=t.bookmarks)||void 0===s?void 0:s.posts})),b=g((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),f=Object(a.useRef)(null),[h,p]=Object(a.useState)();Object(a.useEffect)((()=>{let t;const a=t=>{n.communityID?p({info:{...t,lastName:"",name:t.title},photos:t.photos}):p(t),e.current.incrementQty(n.id,s)};return t=n.communityID?ue("communities/community"+n.communityID,a):je({fields:["info","photos"],userID:n.authorID,callback:a}),t}),[e,s,n.authorID,n.communityID,n.id]);const v=null===(l=n.views)||void 0===l?void 0:l["user"+b];if(Object(a.useEffect)((()=>{if(!(null===h||void 0===h?void 0:h.info.id)||!b||v)return;let e;const t=new IntersectionObserver((([t])=>{t.isIntersecting?e=setTimeout((()=>{S.ref(`posts/post${n.id}/views/user${b}`).set({date:$,userID:b})}),5e3):clearInterval(e)}),{threshold:.5});return t.observe(f.current),()=>{t.disconnect(),clearTimeout(e)}}),[n.id,null===h||void 0===h?void 0:h.info.id,v,b]),!h)return null;const O=Object.values({...n.likes}),_=Object.values({...n.comments});return Object(y.jsxs)("article",{className:"post",ref:f,children:[Object(y.jsxs)("div",{className:"post__main",children:[Object(y.jsxs)("div",{className:"post__header",children:[Object(y.jsx)(c.b,{className:"post__header-avatar",to:"/"+(n.communityID?"community":"id")+h.info.id,children:Object(y.jsx)("img",{className:"post__header-avatar-img",src:h.info.avatar,alt:"Avatar"})}),Object(y.jsxs)("div",{className:"post__header-info",children:[Object(y.jsx)(c.b,{className:"post__header-author",to:"/"+(n.communityID?"community":"id")+h.info.id,children:`${h.info.name} ${h.info.lastName}`}),Object(y.jsx)(c.b,{className:"post__header-date",to:"/post"+n.id,children:A(n.date)})]}),Object(y.jsx)(Z,{bookmarkedItems:j,bookmarkRef:"posts",itemID:n.id,children:(h.info.id===b||h.info.creatorID===b||u)&&Object(y.jsx)(J,{text:"Delete post",onClick:function(){d(i("action-confirm",{actionConfirm:{text:"Are you sure you want to delete this post? This action is irreversible!",callback:()=>S.ref("posts/post"+n.id).remove()}}))}})})]}),Object(y.jsx)(qe,{author:h,content:n.content,lazyLoadEnabled:!0,msgIndex:t}),Object(y.jsxs)("div",{className:"post__footer",children:[Object(y.jsxs)("div",{className:"post__footer-left",children:[Object(y.jsxs)("button",{className:"post__footer-button post__footer-item",onClick:()=>z({condition:!!O.find((e=>e.userID===b)),contentID:n.id,contentRef:`posts/post${n.id}/likes/user${b}`,history:m,userID:b,userRef:`users/user${b}/likes/posts/post${n.id}`}),children:[Object(y.jsx)("i",{className:"post__footer-button-icon"+(O.find((e=>e.userID===b))?" fas fa-heart":" far fa-heart")}),Object(y.jsx)("p",{className:"post__footer-button-text",children:O.length})]}),Object(y.jsxs)(c.b,{className:"post__footer-button post__footer-item",to:`/post${n.id}#comments`,children:[Object(y.jsx)("i",{className:"post__footer-button-icon far fa-comment"}),Object(y.jsx)("p",{className:"post__footer-button-text",children:_.length})]}),Object(y.jsxs)("button",{className:"post__footer-button post__footer-item",children:[Object(y.jsx)("i",{className:"post__footer-button-icon far fa-share-square"}),Object(y.jsx)("p",{className:"post__footer-button-text",children:n.shares})]})]}),Object(y.jsx)("div",{className:"post__footer-right",children:Object(y.jsxs)("div",{className:"post__footer-item",children:[Object(y.jsx)("i",{className:"post__footer-button-icon fas fa-eye"}),Object(y.jsx)("p",{className:"post__footer-button-text",children:Object.values({...n.views}).length})]})})]})]}),r&&Object(y.jsx)(Fe,{post:n})]})}function ze({button:e,requestDate:t,singleUser:s,users:a}){const n=g((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),o=s=>Object(y.jsxs)("div",{className:"users-list__item",children:[Object(y.jsx)(c.b,{className:"users-list__item-avatar",to:"/id"+s.info.id,children:Object(y.jsx)("img",{className:"users-list__item-avatar-img",src:s.info.avatar,alt:"Avatar"})}),Object(y.jsxs)("div",{className:"users-list__item-content",children:[Object(y.jsxs)("div",{className:"users-list__item-header",children:[Object(y.jsx)(c.b,{className:"users-list__item-name",to:"/id"+s.info.id,children:`${s.info.name} ${s.info.lastName}`}),Object(y.jsx)("p",{className:"users-list__item-date",children:t?A(t):H(s)})]}),"bookmarks"===e&&!t&&Object(y.jsx)(J,{text:"Remove from bookmarks",onClick:()=>S.ref(`users/user${n}/bookmarks/users/${s.info.id}`).remove()}),t&&Object(y.jsx)(J,{text:"Accept friend request",onClick:()=>F({reqUserID:s.info.id,userID:n})})]})]},s.info.id);return s?o(s):Object(y.jsx)("div",{className:"users-list",children:a.map((e=>o(e)))})}function Be(){const e=Object(a.useContext)(r.LoadingContext),t=Object(a.useRef)({qty:[],incrementQty(e,t){this.qty.includes(e)||(this.qty.push(e),this.qty.length===this.expectedQty&&t())},setExpected(e,t){this.expectedQty||(this.expectedQty=e,t&&0===this.expectedQty&&t())}}),s=Object(a.useRef)(),n=Object(a.useCallback)((e=>document.title=e+" | Social App"),[]);return{fetchedItems:t,finishLoading:Object(a.useCallback)((t=>{t&&n(t),s.current=!0,e.done(),window.scrollTo(0,0)}),[e,n]),loaded:s,setTitle:n}}function Ge(){var e;const t=Object(I.useHistory)(),{search:s}=Object(I.useLocation)(),n=new URLSearchParams(s).get("tab"),o=g((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.bookmarks})),r=g((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),i=["users"].find((e=>e===n))||"posts",l=Object(a.useRef)(),[d,m]=Object(a.useState)([]),{fetchedItems:u,finishLoading:j}=Be(),b=Object(a.useCallback)((()=>j("Bookmarks")),[j]);Object(a.useEffect)((()=>{if(void 0===r&&t.replace("/"),!r)return;const e=Object.values({...null===o||void 0===o?void 0:o[i]}).sort(((e,t)=>t.date-e.date));e.length||(b(),m([]));const s=[],a=[],n=(t,s,n)=>{a[n]=t||{id:s.id,unavailable:!0},t||u.current.incrementQty(s.id,b),a.length!==e.length||a.includes(void 0)||(m([...a]),"users"===i?b():u.current.setExpected(a.length,b))};return e.forEach(((e,t)=>{"users"===i?s.push(je({fields:["connections","info"],userID:e.id,callback:s=>n(s,e,t)})):s.push(ue(("users"===i?"users/user":"posts/post")+e.id,(s=>n(s,e,t))))})),()=>s.forEach((e=>e()))}),[i,u,t,b,o,r]),Object(a.useEffect)((()=>l.current=i),[i]);const f=d.filter((e=>!e.unavailable)),h=null===(e=d.filter((e=>e.unavailable)))||void 0===e?void 0:e.length;return Object(y.jsx)("section",{className:"bookmarks",children:Object(y.jsxs)("div",{className:"page-width",children:[Object(y.jsx)(Re,{}),Object(y.jsx)("div",{className:"content-width",children:Object(y.jsxs)("div",{className:"bookmarks__wrapper",children:[Object(y.jsxs)("div",{className:"bookmarks__header",children:[Object(y.jsx)("h1",{className:"bookmarks__header-title",children:`${i} bookmarks (${d.length})`}),h>0&&Object(y.jsxs)("p",{className:"bookmarks__header-unavailable",children:[h+" unavailable item(s) are hidden ",Object(y.jsx)("button",{className:"bookmarks__header-unavailable-remove",onClick:function(){d.forEach((e=>e.unavailable&&S.ref(`users/user${r}/bookmarks/${i}/${e.id}`).remove()))},children:"(Remove)."})]})]}),Object(y.jsx)("div",{className:"bookmarks__content",children:i===l.current&&("posts"===i?f.map(((e,t)=>Object(y.jsx)(He,{fetchedItems:u,index:t,loadingCallback:b,post:e},e.id))):"users"===i&&Object(y.jsx)(ze,{button:"bookmarks",users:f}))})]})}),Object(y.jsx)("aside",{className:"sidebar",children:Object(y.jsxs)("div",{className:"sidebar__wrapper",children:[Object(y.jsx)(c.b,{className:"sidebar__button"+("posts"===i?" sidebar__button--active":""),to:"/bookmarks",children:`Posts (${Object.values({...null===o||void 0===o?void 0:o.posts}).length})`}),Object(y.jsx)(c.b,{className:"sidebar__button"+("users"===i?" sidebar__button--active":""),to:"?tab=users",children:`Users (${Object.values({...null===o||void 0===o?void 0:o.users}).length})`})]})})]})})}function Ye(){const e=Object(o.b)(),t=g((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),[s,c]=Object(a.useState)(),[r,l]=Object(a.useState)(),{finishLoading:d}=Be();return Object(a.useEffect)((()=>{if(null!==t)return ue("communities",(e=>{d("Communities");const s=Object.values({...e});Object(n.unstable_batchedUpdates)((()=>{c(s.filter((e=>{var s;return!(null===(s=e.subscribers)||void 0===s?void 0:s["user"+t])}))),l(s.filter((e=>{var s;return null===(s=e.subscribers)||void 0===s?void 0:s["user"+t]})))}))}))}),[d,t]),s||r?Object(y.jsx)("section",{className:"communities",children:Object(y.jsxs)("div",{className:"page-width",style:t?{}:{justifyContent:"center"},children:[Object(y.jsx)(Re,{}),Object(y.jsxs)("div",{className:"content-width",children:[Object(y.jsxs)("div",{className:"communities__header",children:[Object(y.jsx)("h1",{className:"communities__title",children:"Communities"}),Object(y.jsx)(J,{text:"Create new community",onClick:()=>e(i("create-community"))})]}),r.length>0&&Object(y.jsxs)("div",{className:"communities__subscribed",children:[Object(y.jsx)("div",{className:"communities__subscribed-header",children:Object(y.jsx)("h2",{className:"communities__subscribed-title",children:`Subscribed (${r.length})`})}),Object(y.jsx)("div",{className:"communities__subscribed-content",children:Object(y.jsx)(Ve,{communities:r,subscribed:!0})})]}),s.length>0&&Object(y.jsxs)("div",{className:"communities__explore",children:[Object(y.jsx)("div",{className:"communities__explore-header",children:Object(y.jsx)("h2",{className:"communities__explore-title",children:`Explore (${s.length})`})}),Object(y.jsx)("div",{className:"communities__explore-content",children:Object(y.jsx)(Ve,{communities:s})})]})]})]})}):null}function Ve({communities:e=[],subscribed:t}){const s=Object(o.b)(),a=Object(I.useHistory)(),n=g((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.admin})),r=g((e=>{var t,s;return null===(t=e.user)||void 0===t||null===(s=t.bookmarks)||void 0===s?void 0:s.communities})),l=g((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id}));return Object(y.jsx)("div",{className:"communities__list",children:e.map((e=>Object(y.jsxs)("div",{className:"communities__list-item",children:[Object(y.jsx)(c.b,{className:"communities__list-item-avatar",to:"/community"+e.id,children:Object(y.jsx)("img",{className:"communities__list-item-avatar-img",src:e.avatar,alt:"Avatar"})}),Object(y.jsxs)("div",{className:"communities__list-item-info",children:[Object(y.jsxs)("div",{className:"communities__list-item-info-container",children:[Object(y.jsx)(c.b,{className:"communities__list-item-title",to:"/community"+e.id,children:e.title}),Object(y.jsx)("p",{className:"communities__list-item-description",children:e.deleted?"This community has been deleted.":e.shortDescription||"No description provided."}),Object(y.jsx)(J,{preset:t?"remove":"primary",text:t?"Unsubscribe":"Subscribe",onClick:()=>G(e.id,a,l,t)})]}),Object(y.jsxs)(Z,{bookmarkedItems:r,bookmarkRef:"communities",itemID:e.id,children:[Object(y.jsx)(J,{text:"Report",onClick:()=>!l&&a.push("/")}),n&&Object(y.jsx)(J,{text:"Delete community",onClick:()=>{return t=e.id,void s(i("action-confirm",{actionConfirm:{text:"Are you sure you want to delete this community? This action is irreversible!",password:!0,callback:()=>{S.ref("posts").once("value",(e=>{const s=Object.values({...e.val()});S.ref("communities/community"+t).update({avatar:"img/community-deleted.svg",banner:null,deleted:!0,description:null,id:t,photos:null,profilePhotos:null,shortDescription:null,title:"Deleted community"}),s.filter((e=>e.communityID===t)).map((e=>S.ref("posts/post"+e.id).remove()))}))}}}));var t}})]})]})]},e.id)))})}function Qe(){var e;const t=Object(I.useHistory)(),{communityID:s}=Object(I.useParams)(),n=g((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),{addImgPreview:o,imgPreview:r,setImgPreview:i}=T(!1),[l,d]=Object(a.useState)(),[m,u]=Object(a.useState)(),[j,b]=Object(a.useState)(),{fetchedItems:f,finishLoading:h,loaded:p,setTitle:v}=Be(),O=Object(a.useCallback)((()=>h(l.title)),[l,h]);if(Object(a.useEffect)((()=>{if(null===n)return;let e,t,a;const o=ue("communities/community"+s,(n=>{d(n),n?(e=je({userID:n.creatorID,callback:e=>{u([e.info])}}),(()=>{var e;null===(e=t)||void 0===e||e.off("value",a),t=S.ref("posts"),a=t.orderByChild("communityID").equalTo(s).on("value",(e=>{const t=Object.values({...e.val()});b(t.sort(((e,t)=>t.id-e.id))),f.current.setExpected(t.length)}))})()):h()}));return()=>{var s,n;o(),null===(s=e)||void 0===s||s(),null===(n=t)||void 0===n||n.off("value",a)}}),[s,f,h,n]),Object(a.useEffect)((()=>{p.current&&l?v(l.title):j?O():null!==j&&null!==l||h()}),[l,h,p,O,j,v]),void 0===l)return null;if(!l)return Object(y.jsx)(Te,{});const _=!!(null===(e=l.subscribers)||void 0===e?void 0:e["user"+n]);return Object(y.jsx)("section",{className:"community",children:Object(y.jsxs)("div",{className:"page-width",style:n?{}:{justifyContent:"center"},children:[Object(y.jsx)(Re,{}),Object(y.jsx)("div",{className:"content-width",children:Object(y.jsxs)("div",{className:"community__content",children:[Object(y.jsxs)("div",{className:"community__header",children:[n===l.creatorID?r[0]?Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)("div",{className:"community__banner",children:Object(y.jsx)("img",{className:"community__banner-img",src:r[0].result,alt:""})}),Object(y.jsxs)("div",{className:"community__header-buttons",children:[Object(y.jsx)(J,{text:"Confirm banner",onClick:function(){i([]),Y({communityID:s,createID:!1,file:r[0].file,imgPath:"banner",storagePrefix:"community"+s})}}),Object(y.jsx)(J,{preset:"secondary",text:"Cancel",onClick:()=>i([])})]})]}):Object(y.jsxs)("label",{className:"modal-change-avatar__upload",htmlFor:"community__banner-overlay-input",children:[Object(y.jsxs)("button",{className:"community__banner-button community__banner",onClick:e=>{var t;return null===(t=e.target.closest("label"))||void 0===t?void 0:t.click()},children:[l.banner?Object(y.jsx)("img",{className:"community__banner-img",src:l.banner.src,alt:""}):Object(y.jsx)("p",{className:"community__banner-placeholder",children:"No banner"}),Object(y.jsxs)("div",{className:"community__banner-overlay",children:[Object(y.jsx)("i",{className:"community__banner-overlay-icon far fa-image"}),Object(y.jsx)("p",{className:"community__banner-overlay-text",children:(l.banner?"Change":"Set")+" banner"})]})]}),Object(y.jsx)("input",{className:"community__banner-overlay-input",id:"community__banner-overlay-input",type:"file",accept:".jpg, .jpeg, .png",hidden:!0,onChange:o})]}):l.banner&&Object(y.jsx)("div",{className:"community__banner",children:Object(y.jsx)("img",{className:"community__banner-img",src:l.banner.src,alt:""})}),Object(y.jsxs)("div",{className:"community__info",children:[Object(y.jsxs)("div",{className:"community__info-content",children:[Object(y.jsx)(Q,{avatar:null,owner:{info:l}}),Object(y.jsxs)("div",{className:"community__info-text",children:[Object(y.jsx)(K,{className:"community-title",databaseRef:`communities/community${s}/title`,field:l.title,ownerID:l.creatorID,renderInputId:"title"}),Object(y.jsx)("p",{className:"community__info-subscribers",children:L("subscriber",Object.keys({...l.subscribers}).length)})]})]}),Object(y.jsx)(J,{className:"community-subscribe",preset:_?"remove":"primary",text:_?"Unsubscribe":"Subscribe",onClick:()=>G(s,t,n,_)})]})]}),Object(y.jsxs)("div",{className:"community__description",children:[Object(y.jsx)("h3",{className:"community__description-title",children:"Description"}),Object(y.jsx)(K,{databaseRef:`communities/community${s}/description`,emptyButtonText:"Set description",emptyFieldText:"No description provided.",field:l.description,ownerID:l.creatorID,renderInputId:"description"})]}),n===l.creatorID&&Object(y.jsx)(X,{avatar:l.avatar,communityID:s}),Object(y.jsxs)("div",{className:"community__posts",children:[Object(y.jsx)("div",{className:"community__posts-header",children:Object(y.jsx)(c.b,{className:"community__posts-title",to:"#todo",children:"Posts"})}),null===j||void 0===j?void 0:j.map(((e,t)=>Object(y.jsx)(He,{fetchedItems:f,index:t,loadingCallback:O,post:e},e.id)))]})]})}),Object(y.jsxs)("aside",{className:"community__sidebar sidebar",children:[Object(y.jsx)("h3",{className:"community__sidebar-title",children:`Contacts (${null===m||void 0===m?void 0:m.length})`}),Object(y.jsx)("div",{className:"community__sidebar-content",children:null===m||void 0===m?void 0:m.map((e=>Object(y.jsxs)("div",{className:"community__sidebar-item",children:[Object(y.jsx)(c.b,{className:"community__sidebar-item-avatar",to:"/id"+e.id,children:Object(y.jsx)("img",{className:"community__sidebar-item-avatar-img",src:e.avatar,alt:""})}),Object(y.jsxs)("div",{className:"community__sidebar-item-info",children:[Object(y.jsx)(c.b,{className:"community__sidebar-item-name",to:"/id"+e.id,children:e.name+" "+e.lastName}),Object(y.jsx)("p",{className:"community__sidebar-item-description",children:"Creator"})]})]},e.id)))})]})]})})}function Je(){const e=Object(o.b)(),t=Object(I.useHistory)(),{search:s}=Object(I.useLocation)(),r=new URLSearchParams(s).get("interlocutor"),{conversationID:l}=Object(I.useParams)(),d=g((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),m=g((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.info})),u=g((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.photos})),j=Object(a.useRef)(),[b,f]=Object(a.useState)(null),[h,p]=Object(a.useState)(null),[v,O]=Object(a.useState)(),[_,x]=Object(a.useState)([]),{addImgPreview:N,imgPreview:w,setImgPreview:k}=T(),C=Object(a.useRef)(),D=Object(a.useRef)(),{finishLoading:E,loaded:P}=Be(),R=Object(a.useCallback)((()=>{f(null),p(null),O([]),P.current||E()}),[E,P]),A=Object(a.useCallback)((e=>{d&&(D.current=je({fields:["connections","info","photos"],userID:e.participants.find((e=>e!==d)),callback:t=>{P.current||E(e.participants.includes(d)?"Conversation":null),Object(n.unstable_batchedUpdates)((()=>{f(e),p(t),O([{info:m,photos:u},t])}))}}))}),[E,P,d,m,u]);Object(a.useEffect)((()=>{if(!l&&r&&d){if(d!==r)return S.ref("conversations/").once("value",(e=>{const s=Object.values(e.val());for(const a of s)if(a.participants.includes(d)&&a.participants.includes(r))return void t.replace("/conversation"+a.id);A({id:"0",messages:[],nextMessageID:"1",participants:[d,r]})})),()=>{var e;return null===(e=D.current)||void 0===e?void 0:e.call(D)};R()}}),[l,A,t,R,r,d]),Object(a.useEffect)((()=>{if(!l||!d)return;const e=ue("conversations/conversation"+l,(e=>{e&&e.participants.includes(d)?(e.messages=Object.values({...e.messages}).sort(((e,t)=>e.id-t.id)),A(e)):R()}));return()=>{var t;e(),null===(t=D.current)||void 0===t||t.call(D)}}),[l,A,R,d]),Object(a.useEffect)((()=>{l||r||R()}),[l,R,r]);const M=Object(a.useCallback)((()=>!(void 0===d||!v||!h||!(null===b||void 0===b?void 0:b.participants.includes(d)))),[null===b||void 0===b?void 0:b.participants,h,v,d]);function q(e){if(_.find((t=>t.id===e.id))){const t=[..._];t.splice(_.indexOf(e),1),x(t)}else x([..._,e])}Object(a.useEffect)((()=>{void 0===d&&t.push("/")}),[t,d]);const F=Object(a.useRef)(),U=Object(a.useRef)(),z=Object(a.useRef)(),[G,Y]=Object(a.useState)(""),[Q,K]=Object(a.useState)(""),Z=Object(a.useCallback)((()=>{K(`${U.current.offsetHeight}px 0 ${z.current.offsetHeight}px`),Y(F.current.offsetWidth)}),[]);return Object(a.useEffect)((()=>{if(M())return window.addEventListener("resize",Z),window.addEventListener("load",Z),()=>{window.removeEventListener("resize",Z),window.removeEventListener("load",Z)}}),[Z,M]),Object(a.useEffect)((()=>{C.current&&setTimeout((()=>{Z(),window.innerHeight<C.current.offsetHeight&&window.scrollTo(0,C.current.offsetHeight)}),0)}),[null===b||void 0===b?void 0:b.id,Z]),v?M()?Object(y.jsx)("section",{className:"conversation fixed-item",ref:C,children:Object(y.jsxs)("div",{className:"page-width",children:[Object(y.jsx)(Re,{}),Object(y.jsx)("div",{className:"content-width",ref:F,children:Object(y.jsxs)("div",{className:"conversation__wrapper",children:[Object(y.jsx)("div",{className:"conversation__header",ref:U,style:{width:G},children:Object(y.jsxs)("div",{className:"conversation__header-wrapper",children:[Object(y.jsxs)("div",{className:"conversation__header-interlocutor",children:[Object(y.jsx)(c.b,{className:"conversation__header-interlocutor-avatar",to:"/id"+h.info.id,children:Object(y.jsx)("img",{className:"conversation__header-interlocutor-avatar-img",src:h.info.avatar,alt:"Avatar"})}),Object(y.jsxs)("div",{className:"conversation__header-interlocutor-info",children:[Object(y.jsx)(c.b,{className:"conversation__header-interlocutor-name",to:"/id"+h.info.id,children:`${h.info.name} ${h.info.lastName}`}),Object(y.jsx)("p",{className:"conversation__header-interlocutor-last-seen",children:H(h)})]})]}),_.length>0&&Object(y.jsxs)("div",{className:"conversation__header-overlay",children:[Object(y.jsxs)("button",{className:"conversation__header-overlay-qty",onClick:()=>x([]),children:[Object(y.jsx)("i",{className:"conversation__header-overlay-qty-icon",children:"\xd7"}),L("message",_.length)]}),Object(y.jsx)("div",{className:"conversation__header-overlay-buttons",children:Object(y.jsx)(J,{afterIconClass:"fas fa-trash-alt",preset:"remove",text:"Delete forever",onClick:function(){_.find((e=>e.authorID!==d))?e(i("action-error",{actionError:"You can't delete someone else's messages. Try to select only your own messages and try again."})):e(i("action-confirm",{actionConfirm:{text:`Are you sure you want to delete ${L("message",_.length)}? This action is irreversible!`,callback:()=>{x([]);for(const e of _)S.ref(`conversations/conversation${l}/messages/message${e.id}`).remove()}}}))}})})]})]})}),Object(y.jsx)("div",{className:"conversation__content",style:{padding:Q},children:b.messages.map(((e,t)=>Object(y.jsx)(Ke,{index:t,message:e,participants:v,previousMessage:b.messages[t-1],selectedMessages:_,selectMessage:q},e.id)))}),Object(y.jsx)("div",{className:"conversation__footer",ref:z,style:{width:G},children:Object(y.jsx)("div",{className:"conversation__footer-wrapper",children:Object(y.jsxs)("form",{className:"conversation__footer-form",action:"#",method:"post",children:[Object(y.jsx)(W,{addImgPreview:N}),Object(y.jsx)("textarea",{className:"conversation__footer-form-input",placeholder:"Your message...",maxLength:5e3,onKeyPress:function(e){function s(e,t){const s={authorID:d,content:e,date:$,id:b.nextMessageID};S.ref(`conversations/conversation${t}/lastMessage`).set(s),S.ref(`conversations/conversation${t}/messages/message${b.nextMessageID}`).set(s),S.ref(`conversations/conversation${t}/nextMessageID`).set(`${parseInt(b.nextMessageID,10)+1}`),setTimeout((()=>{window.innerHeight<C.current.offsetHeight&&window.scrollTo(0,C.current.offsetHeight)}),0)}j.current=e.target.value,B({callback:e=>{b.id&&"0"!==b.id?s(e,l):S.ref("contentData/nextConversationID").once("value",(a=>{S.ref("conversations/conversation"+a.val()).set({id:a.val(),participants:v.map((e=>e.info.id))}),S.ref("contentData/nextConversationID").set(`${parseInt(a.val(),10)+1}`),s(e,a.val()),t.replace("/conversation"+a.val())}))},e:e,imgPreview:w,inputText:j,setImgPreview:k,userID:d})}}),Object(y.jsx)("div",{className:"upload-previews",children:w.map(((e,t)=>Object(y.jsx)(V,{imgPreview:e,removeOnClick:()=>k(w.filter((t=>t.result!==e.result)))},t)))})]})})})]})})]})}):Object(y.jsx)(Te,{}):null}function Ke({index:e,message:t,participants:s,previousMessage:a,selectedMessages:n,selectMessage:o}){const r=s.find((e=>e.info.id===t.authorID)),i=0===e||t.authorID!==a.authorID||t.date>a.date+3e5;return Object(y.jsxs)("button",{className:"conversation__message"+(n.find((e=>e.id===t.id))?" conversation__message--selected":""),onClick:()=>o(t),children:[i&&Object(y.jsx)(c.b,{className:"conversation__message-avatar",to:"/id"+t.authorID,onClick:e=>e.stopPropagation(),children:Object(y.jsx)("img",{className:"conversation__message-avatar-img",src:s.find((e=>e.info.id===t.authorID)).info.avatar,alt:"Avatar"})}),Object(y.jsxs)("div",{className:"conversation__message-wrapper",children:[i&&Object(y.jsxs)("div",{className:"conversation__message-header",children:[Object(y.jsx)(c.b,{className:"conversation__message-header-name",to:"/id"+t.authorID,onClick:e=>e.stopPropagation(),children:s.find((e=>e.info.id===t.authorID)).info.name}),Object(y.jsx)("p",{className:"conversation__message-header-date",children:A(t.date)})]}),Object(y.jsx)(qe,{author:r,content:t.content,linkStopPropagation:!0})]})]})}function We(){const{search:e}=Object(I.useLocation)(),{ownerID:t}=Object(I.useParams)(),s=new URLSearchParams(e).get("tab"),n=g((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),o=g((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.friendRequests})),[r,i]=Object(a.useState)(),[l,d]=Object(a.useState)(!1),m=Object(a.useRef)(""),{fetchedItems:u,finishLoading:j,loaded:b,setTitle:f}=Be(),h=Object(a.useCallback)((()=>j(m.current)),[j]);if(Object(a.useEffect)((()=>{if(null!==n)return je({fields:["friends","info"],userID:t||n,callback:e=>i(e)})}),[u,t,n]),Object(a.useEffect)((()=>{(null===r||void 0===r?void 0:r.info.id)?(m.current=r.info.id===n?"requests"===s?"My friend requests":"My friends":`${r.info.name} ${r.info.lastName}'s friends`,b.current&&f(m.current),l||d(!0),u.current.setExpected(Object.keys("requests"===s?{...null===o||void 0===o?void 0:o.received}:{...r.friends}).length,h)):null===r&&(d(!0),j())}),[u,j,r,b,h,s,f,l,null===o||void 0===o?void 0:o.received,n]),!l)return null;if(!r)return Object(y.jsx)(Te,{});const p=Object.values({...r.friends}),v=Object.values({...null===o||void 0===o?void 0:o.received}),O=r.info.id===n&&"requests"===s;return Object(y.jsx)("section",{className:"friends",children:Object(y.jsxs)("div",{className:"page-width",style:n?{}:{justifyContent:"center"},children:[Object(y.jsx)(Re,{}),Object(y.jsx)("div",{className:"content-width",children:Object(y.jsxs)("div",{className:"friends__wrapper",children:[Object(y.jsx)("div",{className:"friends__header",children:Object(y.jsx)(c.b,{className:"friends__title",to:"/id"+r.info.id,children:O?`Your friend requests (${v.length})`:(r.info.id!==n?`${r.info.name}'s`:"Your")+` friends (${p.length})`})}),(O?v:p).length>0&&Object(y.jsx)("div",{className:"users-list",children:(O?v:p).map((e=>Object(y.jsx)(Ze,{fetchedItems:u,friendID:e.userID,friendRequestDate:O&&e.date,loadingCallback:h},e.userID)))})]})}),r.info.id===n&&Object(y.jsx)("aside",{className:"sidebar",children:Object(y.jsxs)("div",{className:"sidebar__wrapper",children:[Object(y.jsx)(c.b,{className:"sidebar__button"+("requests"!==s?" sidebar__button--active":""),to:"/friends",children:`Friends (${p.length})`}),Object(y.jsx)(c.b,{className:"sidebar__button"+("requests"===s?" sidebar__button--active":""),to:"?tab=requests",children:`Friend requests (${v.length})`})]})})]})})}function Ze({fetchedItems:e,friendID:t,friendRequestDate:s,loadingCallback:n}){const[o,c]=Object(a.useState)();return Object(a.useEffect)((()=>je({fields:["connections","info"],userID:t,callback:s=>{c(s),e.current.incrementQty(t,n)}})),[e,t,n]),o?Object(y.jsx)(ze,{requestDate:s,singleUser:o}):null}let Xe,et;function tt(){const e=Object(o.b)(),t=Object(I.useHistory)(),s=g((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),{formState:{errors:n},handleSubmit:r,register:l}=Object(k.a)(),[d,m]=Object(a.useState)(!1);return Object(a.useEffect)((()=>{s?t.replace("/news"):void 0===s&&(document.title="Log in | Social App")}),[t,s]),void 0!==s?null:Object(y.jsx)("section",{className:"home",children:Object(y.jsx)("div",{className:"page-width",children:Object(y.jsx)("div",{className:"content-width",children:Object(y.jsxs)("div",{className:"home__wrapper",children:[Object(y.jsxs)("div",{className:"home__info",children:[Object(y.jsx)("h1",{className:"home__info-title",children:"Social App"}),Object(y.jsx)("p",{className:"home__info-text",children:"Connect with your friends and communities on Social App."})]}),Object(y.jsxs)("div",{className:"home__content",children:[Object(y.jsxs)("form",{className:"primary-form",action:"#",method:"post",onSubmit:r((function(s){var a;function n(a){(null===a||void 0===a?void 0:a.account.email)===s.email&&a.account.password===s.password?(e(be(a)),e(_e()),t.replace("/news")):m(!0)}null===(a=Xe)||void 0===a||a.off("value",et),Xe=S.ref("users"),et=Xe.orderByChild("account/email").equalTo(s.email).on("value",(e=>{Xe.off("value",et),e.val()?Object.values(e.val()).forEach((e=>n(e))):n()}))})),children:[Object(y.jsx)(R,{autoFocus:!0,id:"home__form-email",onInput:()=>m(!1),opts:{obj:C.find((e=>"email"===e.id)),errors:n,label:!0,placeholder:!0,register:l}}),Object(y.jsx)(R,{id:"home__form-password",onInput:()=>m(!1),opts:{obj:C.find((e=>"existingPassword"===e.id)),errors:n,label:!0,placeholder:!0,register:l}}),d&&Object(y.jsx)("p",{className:"error-text",children:"Wrong email or password."}),Object(y.jsx)(J,{text:"Log in"})]}),Object(y.jsx)(c.b,{className:"home__content-forgot-password",to:"#todo",children:"Forgot password?"}),Object(y.jsx)("hr",{className:"home__content-hr"}),Object(y.jsx)(J,{preset:"secondary",text:"Sign up",onClick:()=>e(i("sign-up"))})]})]})})})})}function st(){const e=Object(I.useHistory)(),t=g((e=>{var t,s;return null===(t=e.user)||void 0===t||null===(s=t.info)||void 0===s?void 0:s.avatar})),s=g((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),[n,o]=Object(a.useState)(),{fetchedItems:c,finishLoading:r}=Be(),i=Object(a.useCallback)((()=>r("Messages")),[r]);return Object(a.useEffect)((()=>{if(!s)return;const e=S.ref("conversations/"),t=e.on("value",(e=>{const t=Object.values(e.val()).filter((e=>e.participants.includes(s)));t.sort(((e,t)=>t.lastMessage.date-e.lastMessage.date)),o(t),c.current.setExpected(t.length,i)}));return()=>e.off("value",t)}),[c,i,s]),Object(a.useEffect)((()=>{void 0===s&&e.push("/")}),[e,s]),void 0!==s&&n?Object(y.jsx)("section",{className:"messages",children:Object(y.jsxs)("div",{className:"page-width",children:[Object(y.jsx)(Re,{}),Object(y.jsx)("div",{className:"content-width",children:Object(y.jsx)("div",{className:"messages__wrapper",children:n.length?n.map((e=>Object(y.jsx)(at,{conversation:e,fetchedItems:c,loadingCallback:i,userAvatar:t,userID:s},e.id))):Object(y.jsx)("p",{className:"no-content",children:"No messages"})})})]})}):null}function at({conversation:e,fetchedItems:t,loadingCallback:s,userAvatar:n,userID:o}){const[r,i]=Object(a.useState)();return Object(a.useEffect)((()=>je({userID:e.participants.find((e=>e!==o)),callback:e=>{i(e.info),t.current.incrementQty(e.info.id,s)}})),[e.participants,t,s,o]),r?Object(y.jsxs)("div",{className:"messages__item",children:[Object(y.jsx)(c.b,{className:"messages__item-avatar",to:"/id"+r.id,children:Object(y.jsx)("img",{className:"messages__item-avatar-img",src:r.avatar,alt:"Avatar"})}),Object(y.jsxs)(c.b,{className:"messages__item-info",to:"/conversation"+e.id,children:[Object(y.jsxs)("div",{className:"messages__item-info-header",children:[Object(y.jsx)("h4",{className:"messages__item-info-name",children:`${r.name} ${r.lastName}`}),e.lastMessage&&Object(y.jsx)("p",{className:"messages__item-info-date",children:A(e.lastMessage.date,!0)})]}),e.lastMessage?Object(y.jsxs)("div",{className:"messages__item-info-last-message",children:[Object(y.jsx)("img",{className:"messages__item-info-last-message-avatar",src:e.lastMessage.authorID===o?n:r.avatar,alt:"Avatar"}),Object(y.jsx)("p",{className:"messages__item-info-last-message-content",children:"text"===e.lastMessage.content[0].type?e.lastMessage.content[0].value:"Photo"})]}):Object(y.jsx)("p",{className:"messages__item-info-no-messages",children:"No messages yet"})]})]}):null}function nt(){const e=Object(I.useHistory)(),t=g((e=>{var t,s;return null===(t=e.user)||void 0===t||null===(s=t.info)||void 0===s?void 0:s.avatar})),s=g((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),[n,o]=Object(a.useState)([]),{fetchedItems:c,finishLoading:r}=Be(),i=Object(a.useCallback)((()=>r("News")),[r]);return Object(a.useEffect)((()=>{if(void 0===s&&e.replace("/"),s)return ue("posts/",(e=>{const t=Object.values(e);o(t.sort(((e,t)=>t.id-e.id))),c.current.setExpected(t.length,i)}))}),[c,e,i,s]),s&&n.length?Object(y.jsx)("section",{className:"news",children:Object(y.jsxs)("div",{className:"page-width",children:[Object(y.jsx)(Re,{}),Object(y.jsxs)("div",{className:"content-width",children:[Object(y.jsx)(X,{avatar:t,userID:s}),n.map(((e,t)=>Object(y.jsx)(He,{fetchedItems:c,index:t,loadingCallback:i,post:e},e.id)))]})]})}):null}function ot(){const e=Object(o.b)(),{ownerID:t}=Object(I.useParams)(),s=g((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),[n,r]=Object(a.useState)(),[l,d]=Object(a.useState)();Object(a.useEffect)((()=>{if(null!==s)return je({fields:["info","photos","profilePhotos"],userID:t||s,callback:e=>{const t=[];for(const s in null===e||void 0===e?void 0:e.profilePhotos)(null===e||void 0===e?void 0:e.photos)&&t.push(e.photos[s]);t.sort(((e,t)=>t.date-e.date)),r(t),d(e)}})}),[t,s]);const{finishLoading:m,loaded:u,setTitle:j}=Be();return Object(a.useEffect)((()=>{const e=t!==s&&t?`${null===l||void 0===l?void 0:l.info.name} ${null===l||void 0===l?void 0:l.info.lastName}'s photos`:"My photos";u.current?j(e):l?m(e):null===l&&m()}),[u,t,l,m,s,j]),void 0===l?null:l?Object(y.jsx)("section",{className:"photos",children:Object(y.jsxs)("div",{className:"page-width",style:s?{}:{justifyContent:"center"},children:[Object(y.jsx)(Re,{}),Object(y.jsx)("div",{className:"content-width",children:Object(y.jsxs)("div",{className:"photos__wrapper",children:[Object(y.jsx)("div",{className:"photos__header",children:Object(y.jsxs)(c.b,{className:"photos__title",to:"/id"+l.info.id,children:[t!==s&&t?l.info.name+"'s":"My",` photos (${null===n||void 0===n?void 0:n.length})`]})}),Object(y.jsx)("div",{className:"photos__items",children:Object(y.jsx)("div",{className:"photos__items-wrapper",children:null===n||void 0===n?void 0:n.map(((t,s)=>Object(y.jsx)(c.b,{className:"photos__item",to:"#javascript",onClick:t=>{e(i("gallery",{gallery:{author:l,content:n,initialSlide:s}})),t.preventDefault()},children:Object(y.jsx)("div",{className:"photos__item-wrapper",children:Object(y.jsx)("img",{className:"photos__item-img",src:t.src,alt:""})})},t.id)))})})]})})]})}):Object(y.jsx)(Te,{})}function ct(){const{postID:e}=Object(I.useParams)(),t=g((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),[s,n]=Object(a.useState)(),{fetchedItems:o,finishLoading:c}=Be(),r=Object(a.useCallback)((()=>c("Post")),[c]);return Object(a.useEffect)((()=>ue("posts/post"+e,(e=>{e?(n(e),o.current.setExpected(1)):(c(),n(null))}))),[o,c,e]),void 0===s?null:null===s?Object(y.jsx)(Te,{}):Object(y.jsx)("section",{className:"post-page",children:Object(y.jsxs)("div",{className:"page-width",style:t?{}:{justifyContent:"center"},children:[Object(y.jsx)(Re,{}),Object(y.jsx)("div",{className:"content-width",children:Object(y.jsx)(He,{fetchedItems:o,loadingCallback:r,post:s,renderComments:!0})})]})})}function rt({profileOwner:e,profilePhotos:t}){var s,a,n,r;const l=Object(o.b)(),{ownerID:d}=Object(I.useParams)(),m=g((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.friendRequests})),u=g((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id}));function j(){l(i("action-confirm",{actionConfirm:{text:"Are you sure you want to remove this friend?",callback:()=>{S.ref(`users/user${d}/friends/user${u}`).remove(),S.ref(`users/user${u}/friends/user${d}`).remove()}}}))}const b=Object.values({...e.friends});return Object(y.jsxs)("div",{className:"profile__left",children:[Object(y.jsx)(Q,{avatar:t.current.find((t=>t.src===e.info.avatar)),owner:e}),Object(y.jsx)("div",{className:"profile__left-online-status",children:Object(y.jsx)("p",{className:"profile__left-online-status-text",children:H(e)})}),e.info.deleted?(null===(r=e.friends)||void 0===r?void 0:r["user"+u])&&Object(y.jsx)("div",{className:"profile__left-buttons",children:Object(y.jsxs)("button",{className:"profile__left-button-cancel profile__left-button",onClick:j,children:[Object(y.jsx)("p",{className:"profile__left-button-text",children:"Remove friend"}),Object(y.jsx)("i",{className:"profile__left-button-icon fas fa-user-minus"})]})}):Object(y.jsxs)(y.Fragment,{children:[u&&(d!==u?Object(y.jsxs)("div",{className:"profile__left-buttons",children:[(null===(s=e.friends)||void 0===s?void 0:s["user"+u])?Object(y.jsx)(J,{afterIconClass:"fas fa-user-minus",preset:"remove",text:"Remove friend",onClick:j}):(null===m||void 0===m||null===(a=m.received)||void 0===a?void 0:a["user"+d])?Object(y.jsx)(J,{afterIconClass:"fas fa-user-plus",text:"Accept friend request",onClick:()=>F({reqUserID:d,userID:u})}):(null===m||void 0===m||null===(n=m.sent)||void 0===n?void 0:n["user"+d])?Object(y.jsx)(J,{afterIconClass:"fas fa-user-times",preset:"remove",text:"Cancel friend request",onClick:function(){S.ref(`users/user${d}/friendRequests/received/user${u}`).remove(),S.ref(`users/user${u}/friendRequests/sent/user${d}`).remove()}}):Object(y.jsx)(J,{afterIconClass:"fas fa-user-plus",text:"Add friend",onClick:function(){S.ref(`users/user${d}/friendRequests/received/user${u}`).set({date:$,userID:u}),S.ref(`users/user${u}/friendRequests/sent/user${d}`).set({date:$,userID:d})}}),Object(y.jsx)(J,{afterIconClass:"far fa-comment-alt",text:"Send message",to:"/conversation?interlocutor="+d})]}):Object(y.jsx)("div",{className:"profile__left-buttons",children:Object(y.jsx)(J,{afterIconClass:"fas fa-portrait",preset:"secondary",text:"Change avatar",onClick:()=>l(i("change-avatar"))})})),Object(y.jsxs)("div",{className:"profile__left-friends",children:[Object(y.jsx)("div",{className:"profile__left-friends-header",children:Object(y.jsx)(c.b,{className:"profile__left-friends-title",to:"/friends"+(d!==u?d:""),children:`Friends (${b.length})`})}),b.length>0&&Object(y.jsx)("div",{className:"profile__left-friends-items",children:Object(y.jsx)("div",{className:"profile__left-friends-items-wrapper",children:b.map((e=>Object(y.jsx)(it,{friendID:e.userID},e.userID)))})})]})]})]})}function it({friendID:e}){const[t,s]=Object(a.useState)();return Object(a.useEffect)((()=>je({userID:e,callback:e=>s(e.info)})),[e]),t?Object(y.jsxs)("div",{className:"profile__left-friends-item",children:[Object(y.jsx)(c.b,{className:"profile__left-friends-item-avatar",to:"/id"+e,children:Object(y.jsx)("img",{className:"profile__left-friends-item-avatar-img",src:t.avatar,alt:"Avatar"})}),Object(y.jsx)(c.b,{className:"profile__left-friends-item-name",to:"/id"+e,children:t.name})]}):null}function lt(){var e;const t=Object(o.b)(),s=Object(I.useHistory)(),{ownerID:n}=Object(I.useParams)(),r=g((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.admin})),l=g((e=>{var t,s;return null===(t=e.user)||void 0===t||null===(s=t.bookmarks)||void 0===s?void 0:s.users})),d=g((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),m=Object(a.useRef)(),u=Object(a.useRef)(),j=Object(a.useRef)(),[b,f]=Object(a.useState)(),[h,p]=Object(a.useState)(),{fetchedItems:v,finishLoading:O,loaded:_,setTitle:x}=Be(),N=Object(a.useCallback)((()=>{O((null===h||void 0===h?void 0:h.info.name)+" "+(null===h||void 0===h?void 0:h.info.lastName))}),[O,null===h||void 0===h?void 0:h.info.lastName,null===h||void 0===h?void 0:h.info.name]),w=Object(a.useCallback)((e=>{if(e){if(document.activeElement.blur(),j.current=[],e.profilePhotos){for(const s in e.profilePhotos){var t;(null===(t=e.photos)||void 0===t?void 0:t[s])&&j.current.push(e.photos[s])}j.current.sort(((e,t)=>t.date-e.date))}m.current=S.ref("posts/"),u.current=m.current.orderByChild("authorID").equalTo(n).on("value",(e=>{const t=Object.values({...e.val()});f(t.sort(((e,t)=>t.id-e.id))),v.current.setExpected(t.length)}))}else p(null)}),[v,n]);return Object(a.useEffect)((()=>{_.current?x((null===h||void 0===h?void 0:h.info.name)+" "+(null===h||void 0===h?void 0:h.info.lastName)):b?N():null!==b&&null!==h||O()}),[O,_,N,n,b,h,x,d]),Object(a.useEffect)((()=>{if(null===d)return;const e=je({fields:["connections","friends","info","photos","profilePhotos"],userID:n,callback:e=>{var t;null===(t=m.current)||void 0===t||t.off("value",u.current),w(e),p(e)}});return()=>{var t;e(),null===(t=m.current)||void 0===t||t.off("value",u.current)}}),[n,w,d]),void 0===h?null:h?Object(y.jsx)("section",{className:"profile",children:Object(y.jsxs)("div",{className:"page-width",style:d?{}:{justifyContent:"center"},children:[Object(y.jsx)(Re,{}),Object(y.jsx)("div",{className:"content-width",children:Object(y.jsxs)("div",{className:"profile__wrapper",children:[Object(y.jsx)(rt,{profileOwner:h,profilePhotos:j}),Object(y.jsxs)("div",{className:"profile__content",children:[Object(y.jsxs)("div",{className:"profile__content-info",children:[Object(y.jsxs)("div",{className:"profile__content-info-header",children:[Object(y.jsxs)("div",{className:"profile__content-info-header-container",children:[Object(y.jsx)("h1",{className:"profile__content-info-header-name",children:`${h.info.name} ${h.info.lastName}`}),n!==d&&!h.info.deleted&&Object(y.jsxs)(Z,{bookmarkedItems:l,bookmarkRef:"users",itemID:n,children:[Object(y.jsx)(J,{text:"Report",onClick:()=>!d&&s.push("/")}),r&&Object(y.jsx)(J,{text:"Delete user",onClick:function(){t(i("action-confirm",{actionConfirm:{text:"Are you sure you want to delete this account? This action is irreversible!",password:!0,callback:()=>{U({posts:b,userID:n})}}}))}})]})]}),Object(y.jsx)(K,{className:"user-status",databaseRef:`users/user${n}/info/status`,emptyButtonText:"Set status",field:h.info.status,ownerID:n,renderInputId:"status"})]}),(h.info.birthday||h.info.country||h.info.city)&&Object(y.jsxs)("div",{className:"profile__content-info-middle",children:[h.info.birthday&&Object(y.jsxs)("p",{className:"profile__content-info-middle-item",children:[Object(y.jsx)("span",{className:"profile__content-info-middle-item-title",children:"Birthday: "}),Object(y.jsx)("span",{className:"profile__content-info-middle-item-value",children:h.info.birthday})]}),h.info.country&&Object(y.jsxs)("p",{className:"profile__content-info-middle-item",children:[Object(y.jsx)("span",{className:"profile__content-info-middle-item-title",children:"Country: "}),Object(y.jsx)("span",{className:"profile__content-info-middle-item-value",children:h.info.country})]}),h.info.city&&Object(y.jsxs)("p",{className:"profile__content-info-middle-item",children:[Object(y.jsx)("span",{className:"profile__content-info-middle-item-title",children:"City: "}),Object(y.jsx)("span",{className:"profile__content-info-middle-item-value",children:h.info.city})]})]}),Object(y.jsxs)("div",{className:"profile__content-info-footer",children:[(null===(e=h.friendRequests)||void 0===e?void 0:e.received)&&Object(y.jsxs)("div",{className:"profile__content-info-footer-item",children:[Object(y.jsx)("p",{className:"profile__content-info-footer-item-number",children:Object.keys(h.friendRequests.received).length}),Object(y.jsx)("p",{className:"profile__content-info-footer-item-title",children:"followers"})]}),h.profilePhotos&&Object(y.jsxs)(c.b,{className:"profile__content-info-footer-button",to:"/photos"+(n!==d?n:""),children:[Object(y.jsx)("p",{className:"profile__content-info-footer-button-number",children:Object.keys(h.profilePhotos).length}),Object(y.jsx)("p",{className:"profile__content-info-footer-button-title",children:"photos"})]}),Object(y.jsxs)(c.b,{className:"profile__content-info-footer-button",to:"#todo",children:[Object(y.jsx)("p",{className:"profile__content-info-footer-button-number",children:(null===b||void 0===b?void 0:b.length)||0}),Object(y.jsx)("p",{className:"profile__content-info-footer-button-title",children:"posts"})]})]})]}),!h.info.deleted&&Object(y.jsxs)(y.Fragment,{children:[Object(y.jsxs)("div",{className:"profile__content-photos",children:[Object(y.jsx)(c.b,{className:"profile__content-photos-title",to:"/photos"+(n!==d?n:""),children:"Photos: "+Object.keys({...h.profilePhotos}).length}),Object(y.jsx)("div",{className:"profile__content-photos-container",children:j.current.map(((e,s)=>s<4&&Object(y.jsx)(c.b,{className:"profile__content-photos-img-container",to:"#javascript",onClick:e=>{t(i("gallery",{gallery:{author:h,content:j.current,initialSlide:s}})),e.preventDefault()},children:Object(y.jsx)("div",{className:"profile__content-photos-img-inner-container",children:Object(y.jsx)("img",{className:"profile__content-photos-img",src:e.src,alt:""})})},e.id)))})]}),Object(y.jsxs)("div",{className:"profile__content-posts",children:[Object(y.jsx)("div",{className:"profile__content-posts-header",children:Object(y.jsx)(c.b,{className:"profile__content-posts-title",to:"#todo",children:"Posts"})}),null===b||void 0===b?void 0:b.map(((e,t)=>Object(y.jsx)(He,{fetchedItems:v,index:t,loadingCallback:N,post:e},e.id)))]})]})]})]})})]})}):Object(y.jsx)(Te,{})}function dt(){const e=Object(I.useHistory)(),{finishLoading:t}=Be(),{search:s}=Object(I.useLocation)(),n=new URLSearchParams(s).get("query"),o=g((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),[c,r]=Object(a.useState)(),[i,l]=Object(a.useState)(""),d=Object(a.useCallback)((e=>!n||e.toLowerCase().includes(n.toLowerCase())),[n]);return Object(a.useEffect)((()=>{const e=[];let t=!1;return S.ref("contentData/nextUserID").once("value",(s=>{if(t)return;const a=parseInt(s.val(),10)-1;let n=0;const o=[];for(let t=1;t<=a;t++)e[t]=je({fields:["connections","info"],userID:`${t}`,callback:e=>{e.info.deleted||!d(e.info.name)&&!d(e.info.lastName)||o.push(e),n++,n===a&&r(o)}})})),()=>{t=!0,e.forEach((e=>e()))}}),[d]),Object(a.useEffect)((()=>{c&&t(n?"Search results for "+n:"Search")}),[t,c,n]),Object(a.useEffect)((()=>l(n||"")),[n]),Object(a.useEffect)((()=>{const t=setTimeout((()=>{e.push("?query="+(i||""))}),250);return()=>clearTimeout(t)}),[e,i]),null===o?null:Object(y.jsx)("section",{className:"search",children:Object(y.jsxs)("div",{className:"page-width",style:o?{}:{justifyContent:"center"},children:[Object(y.jsx)(Re,{}),Object(y.jsx)("div",{className:"content-width",children:Object(y.jsxs)("div",{className:"search__wrapper",children:[Object(y.jsxs)("div",{className:"search__header",children:[Object(y.jsx)("h1",{className:"search__title",children:`Search users (${null===c||void 0===c?void 0:c.length})`}),Object(y.jsx)(ee,{onChange:e=>l(e.target.value),onSubmit:e=>e.preventDefault(),value:i})]}),Object(y.jsx)("div",{className:"search__content",children:(null===c||void 0===c?void 0:c.length)?Object(y.jsx)(ze,{users:c}):Object(y.jsx)("p",{className:"search__no-results",children:"No results"})})]})})]})})}function mt(){const e=Object(I.useHistory)(),{search:t}=Object(I.useLocation)(),s=new URLSearchParams(t).get("tab"),n=g((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.account.id})),{finishLoading:o}=Be(),r=["account","security"].find((e=>e===s))||"information";return Object(a.useEffect)((()=>{void 0===n?e.push("/"):n&&o("Settings")}),[o,e,n]),n?Object(y.jsx)("section",{className:"settings",children:Object(y.jsxs)("div",{className:"page-width",children:[Object(y.jsx)(Re,{}),Object(y.jsx)("div",{className:"content-width",children:Object(y.jsxs)("div",{className:"settings__wrapper",children:[Object(y.jsx)("div",{className:"settings__header",children:Object(y.jsxs)("h1",{className:"settings__title",children:["information"===r&&"Main information","security"===r&&"Security","account"===r&&"Account"]})}),"information"===r&&Object(y.jsx)(ut,{}),"security"===r&&Object(y.jsx)(jt,{}),"account"===r&&Object(y.jsx)(bt,{})]})}),Object(y.jsx)("aside",{className:"sidebar",children:Object(y.jsxs)("div",{className:"sidebar__wrapper",children:[Object(y.jsx)(c.b,{className:"sidebar__button"+("information"===r?" sidebar__button--active":""),to:"/settings",children:"Information"}),Object(y.jsx)(c.b,{className:"sidebar__button"+("security"===r?" sidebar__button--active":""),to:"?tab=security",children:"Security"}),Object(y.jsx)(c.b,{className:"sidebar__button"+("account"===r?" sidebar__button--active":""),to:"?tab=account",children:"Account"})]})})]})}):null}function ut(){const e=g((e=>e.user.info)),{formState:{errors:t},handleSubmit:s,register:a,reset:n}=Object(k.a)();return Object(y.jsxs)("form",{className:"primary-form",action:"#",method:"post",onSubmit:s((function(t){t=q(t);for(const e in t)t[e]||(t[e]=null);S.ref(`users/user${e.id}/info`).update(t).then(n)})),children:[C.filter((e=>["name","lastName"].includes(e.id))).map((s=>Object(y.jsx)(R,{opts:{obj:s,defaultValue:e[s.id],errors:t,label:!0,register:a}},s.id))),Object(y.jsx)(P,{register:a,userGender:e.gender}),C.filter((e=>["country","city"].includes(e.id))).map((s=>Object(y.jsx)(R,{opts:{obj:s,defaultValue:e[s.id],errors:t,label:!0,register:a}},s.id))),Object(y.jsxs)("div",{className:"settings__buttons",children:[Object(y.jsx)(J,{text:"Save"}),Object(y.jsx)(J,{preset:"secondary",text:"Cancel",type:"button",onClick:()=>n()})]})]})}function jt(){const e=g((e=>e.user.account)),{formState:{errors:t},handleSubmit:s,register:a,reset:n}=Object(k.a)();return Object(y.jsxs)("form",{className:"primary-form",action:"#",method:"post",onSubmit:s((function(t){S.ref(`users/user${e.id}/account`).update(t)})),children:[C.filter((e=>["email","password"].includes(e.id))).map((s=>Object(y.jsx)(R,{opts:{obj:s,defaultValue:e[s.id],errors:t,label:!0,register:a}},s.id))),Object(y.jsxs)("div",{className:"settings__buttons",children:[Object(y.jsx)(J,{text:"Save"}),Object(y.jsx)(J,{preset:"secondary",text:"Cancel",type:"button",onClick:()=>n()})]})]})}function bt(){const e=Object(o.b)(),t=g((e=>e.user.account.id));return Object(y.jsxs)("form",{className:"primary-form",action:"#",method:"post",onSubmit:function(s){s.preventDefault(),e(i("action-confirm",{actionConfirm:{text:"Are you sure you want to delete your account? This action is irreversible!",password:!0,callback:()=>{e({type:"LOG_OUT"}),setTimeout((()=>{S.ref("posts").once("value",(e=>{const s=Object.values({...e.val()});U({posts:s.filter((e=>e.authorID===t)),userID:t})}))}),0)}}}))},children:[Object(y.jsx)("h3",{className:"primary-form__title",children:"Account removal"}),Object(y.jsx)(J,{preset:"remove",text:"Delete account"})]})}function ft(){const{pathname:e}=Object(I.useLocation)(),t=Object(o.b)(),s=g((e=>e.modal)),n=Object(a.useRef)(null);return n.current=s.currentModal,Object(a.useEffect)((()=>{t(l(n.current))}),[t,e]),null}r.topbar.config({barColors:{0:"rgba(128, 215, 255, 1)"},className:"loading-bar",shadowBlur:5,shadowColor:"rgba(0, 0, 0, 1)"});const ht=()=>document.documentElement.style.setProperty("--page-height",window.innerHeight+"px");function pt(){return window.history.scrollRestoration="manual",Object(y.jsx)(c.a,{children:Object(y.jsxs)(o.a,{store:N,children:[Object(y.jsx)(ft,{}),Object(y.jsx)(Pe,{}),Object(y.jsx)(Ee,{}),Object(y.jsx)("main",{className:"main",children:Object(y.jsxs)(r.Switch,{loadingScreen:()=>Object(y.jsxs)("div",{className:"loading-screen",children:[Object(y.jsx)("div",{}),Object(y.jsx)("div",{}),Object(y.jsx)("div",{}),Object(y.jsx)("div",{})]}),children:[Object(y.jsx)(r.Route,{path:"/",exact:!0,component:tt}),Object(y.jsx)(r.Route,{path:"/bookmarks",component:Ge,loading:!0}),Object(y.jsx)(r.Route,{path:"/communities",component:Ye,loading:!0}),Object(y.jsx)(r.Route,{path:"/community:communityID",component:Qe,loading:!0}),Object(y.jsx)(r.Route,{path:"/conversation",component:Je,loading:!0}),Object(y.jsx)(r.Route,{path:"/friends",component:We,loading:!0}),Object(y.jsx)(r.Route,{path:"/messages",component:st,loading:!0}),Object(y.jsx)(r.Route,{path:"/news",component:nt,loading:!0}),Object(y.jsx)(r.Route,{path:"/photos",component:ot,loading:!0}),Object(y.jsx)(r.Route,{path:"/search",component:dt,loading:!0}),Object(y.jsx)(r.Route,{path:"/settings",component:mt,loading:!0}),Object(y.jsx)(r.Route,{path:"/conversation:conversationID",component:Je,loading:!0}),Object(y.jsx)(r.Route,{path:"/friends:ownerID",component:We,loading:!0}),Object(y.jsx)(r.Route,{path:"/photos:ownerID",component:ot,loading:!0}),Object(y.jsx)(r.Route,{path:"/post:postID",component:ct,loading:!0}),Object(y.jsx)(r.Route,{path:"/id:ownerID",component:lt,loading:!0}),Object(y.jsx)(r.Route,{path:"/",component:Te})]})}),Object(y.jsx)(Ie,{})]})})}ht(),window.addEventListener("resize",ht);var vt=e=>{e&&e instanceof Function&&s.e(3).then(s.bind(null,61)).then((({getCLS:t,getFID:s,getFCP:a,getLCP:n,getTTFB:o})=>{t(e),s(e),a(e),n(e),o(e)}))};Object(n.render)(Object(y.jsx)(a.StrictMode,{children:Object(y.jsx)(pt,{})}),document.getElementById("app")),vt()}},[[53,1,2]]]);